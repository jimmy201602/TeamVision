webpackJsonp([4],{"/j3j":function(e,t){},"4i9v":function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=s("Dd8w"),a=s.n(i),o=s("DAYN"),r=s.n(o),l=s("NYxO"),n=s("78qB"),c=s("rihW"),u=s("ewDC"),d=s("WSP/"),p=s("ttFk"),h=(s("AH9D"),{name:"projectIssueBoard",props:{projectID:{type:[Number,String],default:0},issueID:{type:[Number,String],default:0}},data:function(){return{columnItemHeight:200,taskList:[],taskItemID:0}},computed:a()({},Object(l.c)("issue",["showIssueDetail","selectIssueID"]),Object(l.c)("projectglobal",["projectVersion"]),Object(l.c)(["appBodyHeight"]),{containerHeight:function(){return this.appBodyHeight-26},issueContainerWidth:function(){return 24-this.filterPanelWidth},filterPanelWidth:function(){return this.showIssueDetail?0:6},project:function(){if(this.projectID)return this.projectID}}),methods:a()({},Object(l.d)("issue",["setIssueChange","setShowIssueDetail","setSelectIssueID"]),Object(l.d)("projectglobal",["setViewDialogShow","setProject"]),{onCloseDetailPanel:function(){this.setShowIssueDetail(!1)}}),created:function(){"all"!==this.issueID&&0!==this.issueID&&(this.setSelectIssueID(parseInt(this.issueID)),this.setShowIssueDetail(!0))},mounted:function(){},watch:{projectID:function(e){},issueID:function(e){console.log(e),"all"!==e&&"0"!==e&&(this.setSelectIssueID(parseInt(e)),this.setShowIssueDetail(!0))}},components:{draggable:r.a,projectIssueFilter:n.a,ProjectIssueCreateDialog:u.a,ProjectIssueItem:d.a,projectIssueList:c.a,ProjectIssueDetail:p.a}}),m={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{},[s("Row",[s("Col",{attrs:{lg:e.filterPanelWidth,md:e.filterPanelWidth,sm:e.filterPanelWidth,xs:0}},[s("project-issue-filter",{attrs:{projectID:e.projectID}})],1),e._v(" "),s("Col",{attrs:{lg:e.issueContainerWidth,md:e.issueContainerWidth,sm:e.issueContainerWidth,xs:24}},[s("project-issue-list",{attrs:{projectID:e.projectID}})],1),e._v(" "),s("Drawer",{attrs:{value:e.showIssueDetail,"class-name":"fdsfds",inner:!0,transfer:!1,width:60,mask:!1},on:{"on-close":e.onCloseDetailPanel}},[s("div",{attrs:{slot:""},slot:"default"}),e._v(" "),s("project-issue-detail",{attrs:{issueID:e.selectIssueID}})],1)],1),e._v(" "),s("project-issue-create-dialog",{attrs:{projectID:e.projectID,versionID:e.projectVersion}})],1)},staticRenderFns:[]};var f=s("VU/8")(h,m,!1,function(e){s("DaTb")},"data-v-a938ab6c",null);t.default=f.exports},"78qB":function(e,t,s){"use strict";var i=s("Dd8w"),a=s.n(i),o=s("NYxO"),r={name:"projectIssueFilter",props:{projectID:{type:[Number,String]}},data:function(){return{columnItemHeight:200,myProjectList:[],projectVersions:{disable:!1,values:[]},projectMembers:{disable:!1,values:[]},projectTeams:[],issueStatus:[],issueSeverity:[],issueResolvedResult:[],issueProjectPhrase:[],issueCategories:[],IssuePriority:[],filterPanel:{projects:[],versions:[],teams:[],status:[],processors:[],reportors:[],createTimeRange:"",resolveResult:[],severity:[],projectPhrases:[],issueCategories:[],issuePriority:[]}}},computed:a()({},Object(o.c)("task",["taskChange"]),Object(o.c)("projectglobal",["projectVersion"]),Object(o.c)(["appBodyHeight","userInfo"]),{containerHeight:function(){return this.appBodyHeight-50},project:function(){var e=0;return this.projectID&&(e=this.projectID),e}}),methods:a()({},Object(o.d)("issue",["setIssueFilters"]),Object(o.d)("projectglobal",["setViewDialogShow"]),{onFiltersChange:function(e){this.setFilters(e)},setFilters:function(e){var t="";this.filterPanel.projects.length>0&&(t=t+"Project__in="+this.filterPanel.projects+",0&"),this.filterPanel.versions.length>0&&(t=t+"Version__in="+this.filterPanel.versions+",0&"),this.filterPanel.status.length>0&&(t=t+"Status__in="+this.filterPanel.status+",0&"),this.filterPanel.severity.length>0&&(t=t+"Severity__in="+this.filterPanel.severity+",0&"),this.filterPanel.issuePriority.length>0&&(t=t+"Priority__in="+this.filterPanel.issuePriority+",0&"),this.filterPanel.teams.length>0&&(t=t+"Team__in="+this.filterPanel.teams+",0&"),this.filterPanel.processors.length>0&&(console.log(this.filterPanel.processors),t=t+"Processor__in="+this.filterPanel.processors+",0&"),this.filterPanel.reportors.length>0&&(t=t+"Creator__in="+this.filterPanel.reportors+",0&"),this.filterPanel.createTimeRange.length>1&&""!==this.filterPanel.createTimeRange[0]&&(t=t+"CreationTime__range="+e+"&"),this.filterPanel.projectPhrases.length>0&&(t=t+"ProjectPhase__in="+this.filterPanel.projectPhrases+",0&"),this.filterPanel.issueCategories.length>0&&(t=t+"IssueCategory__in="+this.filterPanel.issueCategories+",0&"),this.filterPanel.resolveResult.length>0&&(t=t+"Solution__in="+this.filterPanel.resolveResult+",0&"),this.setIssueFilters(t)},loadMyProject:function(){var e=this;this.$axios.get("/api/project/list?extinfo=1&my=1").then(function(t){e.myProjectList=t.data.result},function(e){})},initFilterPanel:function(){if(this.loadMyProject(),this.filterPanel.projects=[],this.filterPanel.processors=[],0!==parseInt(this.project)&&this.filterPanel.projects.push(parseInt(this.project)),"homeIssue"===this.$route.name){this.filterPanel.processors.push(parseInt(this.userInfo.id)),this.filterPanel.status.push(2),this.filterPanel.status.push(4),this.filterPanel.status.push(5);var e="Status__in=2,4,5&Processor__in="+this.userInfo.id;this.setIssueFilters(e);var t={};t.PMMember=parseInt(this.userInfo.id),t.id=parseInt(this.userInfo.id),t.name=this.userInfo.last_name+this.userInfo.first_name,this.projectMembers.values.push(t)}},loadMyTeams:function(){var e=this;this.$axios.get("/api/common/teams/my").then(function(t){e.projectTeams=t.data.result},function(e){})},loadIssueStatus:function(){var e=this;this.$axios.get("/api/project/issue/status").then(function(t){e.issueStatus=t.data.result},function(e){})},loadIssueSeverity:function(){var e=this;this.$axios.get("/api/project/issue/severities").then(function(t){e.issueSeverity=t.data.result},function(e){})},loadIssueReslovedResult:function(){var e=this;this.$axios.get("/api/project/issue/resolve_results").then(function(t){e.issueResolvedResult=t.data.result},function(e){})},loadIssueCategories:function(){var e=this;this.$axios.get("/api/project/issue/categories").then(function(t){e.issueCategories=t.data.result},function(e){})},loadIssueProjectPhrase:function(){var e=this;this.$axios.get("/api/project/issue/project_phrase").then(function(t){e.issueProjectPhrase=t.data.result},function(e){})},loadIssueProjectPriority:function(){var e=this;this.$axios.get("/api/project/issue/priority").then(function(t){e.IssuePriority=t.data.result},function(e){})},onProjectChange:function(e){if(this.setFilters(e),e.length>1||0===e.length)this.projectVersions.disable=!0,this.projectMembers.disable=!0,this.filterPanel.versions=[],this.filterPanel.processors=[],this.filterPanel.reportors=[];else{this.projectVersions.disable=!1,this.projectMembers.disable=!1;for(var t=0;t<this.myProjectList.length;t++)this.myProjectList[t].id===parseInt(e[0])&&(this.projectVersions.values=this.myProjectList[t].Versions,this.projectMembers.values=this.myProjectList[t].Members)}}}),created:function(){this.initFilterPanel(),this.loadIssueStatus(),this.loadIssueSeverity(),this.loadMyTeams(),this.loadIssueProjectPhrase(),this.loadIssueCategories(),this.loadIssueReslovedResult(),this.loadIssueProjectPriority(),this.onProjectChange([].push(this.project))},mounted:function(){},watch:{"filterPanel.projects":function(e){e.length>1&&(this.projectVersions.disable=!0)},project:function(){this.initFilterPanel(),this.onProjectChange([].push(this.project))}},components:{}},l={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("Card",{staticStyle:{"border-left":"1px solid #e4e5e7","border-top":"1px solid #e4e5e7"},attrs:{shadow:!1,padding:0,bordered:!1,"dis-hover":""}},[s("div",{staticStyle:{height:"40px","border-bottom":"1px solid #e4e5e7",padding:"10px","padding-top":"10px"}},[s("span"),e._v(" "),s("span",{staticClass:"pull-right"})]),e._v(" "),s("div",{style:"overflow-y:auto;height:"+e.containerHeight+"px"},[s("Row",{staticClass:"filter-block"},[s("div",{staticClass:"filter-block-title"},[s("p",[s("i",{staticClass:"fa fa-file fw"}),e._v(" 项目")])]),e._v(" "),s("div",{staticClass:"filter-block-body"},[s("Select",{attrs:{filterable:"",multiple:""},on:{"on-change":e.onProjectChange},model:{value:e.filterPanel.projects,callback:function(t){e.$set(e.filterPanel,"projects",t)},expression:"filterPanel.projects"}},e._l(e.myProjectList,function(t){return s("Option",{key:t.id,attrs:{value:t.id}},[e._v(e._s(t.PBTitle))])}))],1)]),e._v(" "),s("Row",{staticClass:"filter-block"},[s("div",{staticClass:"filter-block-title"},[s("p",[s("i",{staticClass:"fa fa-road fa-fw"}),e._v(" 版本")])]),e._v(" "),s("div",{staticClass:"filter-block-body"},[s("Select",{attrs:{filterable:"",multiple:"",disabled:e.projectVersions.disable},on:{"on-change":e.onFiltersChange},model:{value:e.filterPanel.versions,callback:function(t){e.$set(e.filterPanel,"versions",t)},expression:"filterPanel.versions"}},e._l(e.projectVersions.values,function(t){return s("Option",{key:t.id,attrs:{value:t.id}},[e._v(e._s(t.VVersion)+"\n            ")])}))],1)]),e._v(" "),s("Row",{staticClass:"filter-block"},[s("div",{staticClass:"filter-block-title"},[s("p",[s("i",{staticClass:"fa fa-eye"}),e._v(" 状态")])]),e._v(" "),s("div",{staticClass:"filter-block-body"},[s("Row",[s("CheckboxGroup",{on:{"on-change":e.onFiltersChange},model:{value:e.filterPanel.status,callback:function(t){e.$set(e.filterPanel,"status",t)},expression:"filterPanel.status"}},e._l(e.issueStatus,function(t){return s("i-col",{key:t.id,attrs:{lg:8,sm:12}},[s("Checkbox",{attrs:{label:t.Value}},[s("i",{class:"fa "+t.Label+" "+t.LabelStyle}),e._v(" "),s("span",[e._v(e._s(t.Name))])])],1)}))],1)],1)]),e._v(" "),s("Row",{staticClass:"filter-block"},[s("div",{staticClass:"filter-block-title"},[s("p",[s("i",{staticClass:"fa fa-shield fa-fw"}),e._v(" 严重性")])]),e._v(" "),s("div",{staticClass:"filter-block-body"},[s("Row",[s("CheckboxGroup",{on:{"on-change":e.onFiltersChange},model:{value:e.filterPanel.severity,callback:function(t){e.$set(e.filterPanel,"severity",t)},expression:"filterPanel.severity"}},e._l(e.issueSeverity,function(t){return s("i-col",{key:t.id,attrs:{lg:8,sm:12}},[s("Checkbox",{attrs:{label:t.Value}},[s("i",{class:"fa "+t.Label+" "+t.LabelStyle}),e._v(" "),s("span",[e._v(e._s(t.Name))])])],1)}))],1)],1)]),e._v(" "),s("Row",{staticClass:"filter-block"},[s("div",{staticClass:"filter-block-title"},[s("p",[s("i",{staticClass:"fa fa-group fa-fw"}),e._v(" 优先级")])]),e._v(" "),s("div",{staticClass:"filter-block-body"},[s("Select",{attrs:{filterable:"",multiple:""},on:{"on-change":e.onFiltersChange},model:{value:e.filterPanel.issuePriority,callback:function(t){e.$set(e.filterPanel,"issuePriority",t)},expression:"filterPanel.issuePriority"}},e._l(e.IssuePriority,function(t){return s("Option",{key:t.Value,attrs:{value:t.Value}},[e._v(e._s(t.Name))])}))],1)]),e._v(" "),"homeIssue"!==e.$route.name?s("Row",{staticClass:"filter-block"},[s("div",{staticClass:"filter-block-title"},[s("p",[s("i",{staticClass:"fa fa-group fa-fw"}),e._v(" 团队")])]),e._v(" "),s("div",{staticClass:"filter-block-body"},[s("Select",{attrs:{filterable:"",multiple:""},on:{"on-change":e.onFiltersChange},model:{value:e.filterPanel.teams,callback:function(t){e.$set(e.filterPanel,"teams",t)},expression:"filterPanel.teams"}},e._l(e.projectTeams,function(t){return s("Option",{key:t.id,attrs:{value:t.id}},[e._v(e._s(t.Name))])}))],1)]):e._e(),e._v(" "),s("Row",{staticClass:"filter-block"},[s("div",{staticClass:"filter-block-title"},[s("p",[s("i",{staticClass:"fa fa-hand-o-right fa-fw"}),e._v(" 经办人")])]),e._v(" "),s("div",{staticClass:"filter-block-body"},[s("Select",{attrs:{filterable:"",multiple:"",disabled:e.projectMembers.disable},on:{"on-change":e.onFiltersChange},model:{value:e.filterPanel.processors,callback:function(t){e.$set(e.filterPanel,"processors",t)},expression:"filterPanel.processors"}},e._l(e.projectMembers.values,function(t){return s("Option",{key:t.id,attrs:{value:t.PMMember}},[e._v(e._s(t.name))])}))],1)]),e._v(" "),s("Row",{staticClass:"filter-block"},[s("div",{staticClass:"filter-block-title"},[s("p",[s("i",{staticClass:"fa fa-user fa-fw"}),e._v(" 报告人")])]),e._v(" "),s("div",{staticClass:"filter-block-body"},[s("Select",{attrs:{filterable:"",multiple:"",disabled:e.projectMembers.disable},on:{"on-change":e.onFiltersChange},model:{value:e.filterPanel.reportors,callback:function(t){e.$set(e.filterPanel,"reportors",t)},expression:"filterPanel.reportors"}},e._l(e.projectMembers.values,function(t){return s("Option",{key:t.id,attrs:{value:t.PMMember}},[e._v(e._s(t.name))])}))],1)]),e._v(" "),s("Row",{staticClass:"filter-block"},[s("div",{staticClass:"filter-block-title"},[s("p",[s("i",{staticClass:"fa fa-calendar-o fa-fw"}),e._v(" 创建时间")])]),e._v(" "),s("div",{staticClass:"filter-block-body"},[s("DatePicker",{staticStyle:{width:"100%"},attrs:{format:"yyyy-MM-dd",type:"daterange","show-week-numbers":"",placement:"bottom-end",transfer:"",placeholder:"请选择创建时间范围"},on:{"on-change":e.onFiltersChange},model:{value:e.filterPanel.createTimeRange,callback:function(t){e.$set(e.filterPanel,"createTimeRange",t)},expression:"filterPanel.createTimeRange"}})],1)]),e._v(" "),s("Row",{staticClass:"filter-block"},[s("div",{staticClass:"filter-block-title"},[s("p",[s("i",{staticClass:"fa fa-group fa-fw"}),e._v(" 项目阶段")])]),e._v(" "),s("div",{staticClass:"filter-block-body"},[s("Select",{attrs:{filterable:"",multiple:""},on:{"on-change":e.onFiltersChange},model:{value:e.filterPanel.projectPhrases,callback:function(t){e.$set(e.filterPanel,"projectPhrases",t)},expression:"filterPanel.projectPhrases"}},e._l(e.issueProjectPhrase,function(t){return s("Option",{key:t.Value,attrs:{value:t.Value}},[e._v(e._s(t.Name))])}))],1)]),e._v(" "),s("Row",{staticClass:"filter-block"},[s("div",{staticClass:"filter-block-title"},[s("p",[s("i",{staticClass:"fa fa-group fa-fw"}),e._v(" 问题分类")])]),e._v(" "),s("div",{staticClass:"filter-block-body"},[s("Select",{attrs:{filterable:"",multiple:""},on:{"on-change":e.onFiltersChange},model:{value:e.filterPanel.issueCategories,callback:function(t){e.$set(e.filterPanel,"issueCategories",t)},expression:"filterPanel.issueCategories"}},e._l(e.issueCategories,function(t){return s("Option",{key:t.Value,attrs:{value:t.Value}},[e._v(e._s(t.Name))])}))],1)]),e._v(" "),s("Row",{staticClass:"filter-block",staticStyle:{"min-height":"150px"}},[s("div",{staticClass:"filter-block-title"},[s("p",[s("i",{staticClass:"fa fa-braille fa-fw"}),e._v(" 解决结果")])]),e._v(" "),s("div",{staticClass:"filter-block-body"},[s("Row",[s("CheckboxGroup",{on:{"on-change":e.onFiltersChange},model:{value:e.filterPanel.resolveResult,callback:function(t){e.$set(e.filterPanel,"resolveResult",t)},expression:"filterPanel.resolveResult"}},e._l(e.issueResolvedResult,function(t){return s("i-col",{key:t.id,attrs:{lg:8,sm:12}},[s("Checkbox",{attrs:{label:t.Value}},[s("i",{class:"fa "+t.Label+" "+t.LabelStyle}),e._v(" "),s("span",[e._v(e._s(t.Name))])])],1)}))],1)],1)])],1)])],1)},staticRenderFns:[]};var n=s("VU/8")(r,l,!1,function(e){s("iQFv")},"data-v-0f9b09c0",null);t.a=n.exports},AH9D:function(e,t,s){"use strict";var i=s("//Fk"),a=(s.n(i),s("mtWM"));s.n(a)},DaTb:function(e,t){},J19a:function(e,t){},"WSP/":function(e,t,s){"use strict";var i=s("Dd8w"),a=s.n(i),o=s("NYxO"),r={name:"ProjectIssueItem",props:["issue"],data:function(){return{}},computed:a()({},Object(o.c)("issue",["selectIssueID"]),{issueActiveClass:function(){return this.issue.id===this.selectIssueID?"project_issue_selected_item":""}}),methods:{onIssueClick:function(e){this.$emit("view-issue",e)}}},l={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{class:"project_issue_listview_item cursor-hand "+e.issueActiveClass,on:{click:function(t){e.onIssueClick(e.issue.id)}}},[s("div",{staticClass:"row"},[s("i-col",{attrs:{span:24}},[s("div",{staticClass:"project_issue_listview_item_title"},[s("i-col",{attrs:{span:24}},[s("Tooltip",{attrs:{content:"严重性",transfer:""}},[s("i",{class:"fa fa-circle fa-fw "+e.issue.severity_name.LabelStyle})]),e._v(" "),s("Tooltip",{attrs:{content:"问题ID"}},[s("span",{staticClass:"issue-id"},[e._v("#"+e._s(e.issue.id)+" ")])]),e._v(" "),s("span",{staticClass:"issue-title"},[s("span",{attrs:{name:"issue_defalut_title"}},[e._v(" "+e._s(e.issue.default_title)+" ")]),e._v(" "),s("span",{attrs:{name:"issue_real_title"}},[e._v(" "+e._s(e.issue.Title)+" ")])])],1)],1),e._v(" "),s("div",{staticClass:"project_issue_listview_item_content row"},[s("div",{staticClass:"col-sm-12"},[s("span",{staticClass:"issue-content"},[s("Tooltip",{attrs:{content:"问题状态"}},[s("i",{staticClass:"fa fa-eye gray"}),e._v(" "),s("span",{class:e.issue.status_name.LabelStyle},[e._v(" "+e._s(e.issue.status_name.Name)+" ")])])],1),e._v(" "),s("span",{staticClass:"issue-content"},[s("Tooltip",{attrs:{content:"创建人"}},[s("span",[s("i",{staticClass:"fa fa-user"}),e._v("  "+e._s(e.issue.creator_name)+" ")])])],1),e._v(" "),s("span",{staticClass:"issue-content"},[s("Tooltip",{attrs:{content:"经办人"}},[s("span",{staticClass:"gray "},[s("i",{staticClass:"fa fa-hand-o-right"}),e._v("  "+e._s(e.issue.processor_name)+" ")])])],1),e._v(" "),s("span",{staticClass:"issue-content"},[s("Tooltip",{attrs:{content:"模块名称"}},[s("span",[s("i",{staticClass:"fa fa-cube"}),e._v("  "+e._s(e.issue.module_name)+" ")])])],1),e._v(" "),s("span",{staticClass:"issue-content"},[s("Tooltip",{attrs:{content:"版本"}},[s("span",[s("i",{staticClass:"fa fa-code-fork"}),e._v("  "+e._s(e.issue.version_name)+" ")])])],1),e._v(" "),s("span",{staticClass:"issue-content"},[s("Tooltip",{attrs:{content:"创建日期"}},[s("span",[s("i",{staticClass:"fa fa-clock-o"}),e._v("  "+e._s(e.issue.create_date)+" ")])])],1),e._v(" "),s("span",{staticClass:"issue-content"},[s("Tooltip",{attrs:{content:"解决结果"}},[s("span",[s("i",{class:"fa "+e.issue.solution_name.Label+" "+e.issue.solution_name.LabelStyle}),e._v(" "+e._s(e.issue.solution_name.Name))])])],1)])])])],1)])},staticRenderFns:[]};var n=s("VU/8")(r,l,!1,function(e){s("J19a")},"data-v-d675ce7a",null);t.a=n.exports},ewDC:function(e,t,s){"use strict";var i=s("Dd8w"),a=s.n(i),o=s("NYxO"),r=s("aYpo"),l=(s("mtWM"),{Project:[{type:"array",required:!0,len:2,message:"请选择版本或者创建版本后再创建任务！"}],Title:[{type:"string",required:!0,min:1,max:100,message:"问题标题长度在1-100个字符之间",trigger:"blur"}],Desc:[{type:"string",required:!1,min:0,max:1e4,message:"问题标题长度在0-2000个字符之间",trigger:"blur"}],Processor:[{type:"number",required:!0,min:1,message:"请指派问题处理人"}],Team:[{type:"number",required:!0,min:1,message:"请选择问题所属角色"}],Module:[{type:"number",required:!0,min:1,message:"请选择问题业务模块"}],Severity:[{type:"number",required:!0,min:1,message:"请选择问题严重性"}],IssueCategory:[{type:"number",required:!0,min:1,message:"请选择问题类别"}],ProjectPhase:[{type:"number",required:!0,min:1,message:"请选择问题发现阶段"}],Priority:[{type:"number",required:!0,min:1,message:"请选择问题优先级"}]}),n=s("h/Zt"),c={name:"ProjectIssueCreateDialog",props:{projectID:{type:[Number,String],default:0},versionID:{type:[Number,String],default:0}},data:function(){return{sourceProject:[],projectVersions:[],projectTeams:[],projectModules:[],issueStatus:[],issueSeverity:[],issueResolvedResult:[],issueProjectPhrase:[],issueCategories:[],DeviceOS:[],IssuePriority:[],editorToolBar:[["bold","italic","underline"],[{list:"ordered"},{list:"bullet"}],[{color:[]},{background:[]}]],formItem:{Title:"",Team:0,Processor:0,Severity:0,Module:0,Desc:"<p>步骤:</p></br><p>实际结果:</p></br><p>期望结果:</p>",Project:[],ProjectPhase:0,IssueCategory:0,DeviceOS:0,Priority:0,uploadList:[],defaultList:[]},ruleCustom:a()({},l)}},computed:a()({},Object(o.c)("projectglobal",["createDialogShow","viewDialogShow","projectVersion"]),Object(o.c)(["appBodyHeight"]),{containerHeight:function(){return this.appBodyHeight-100},project:function(){return parseInt(this.projectID)},projectVersion:function(){return parseInt(this.versionID)},dialogShow:function(){return this.createDialogShow||this.viewDialogShow},projectMembers:function(){for(var e=this.formItem.Project[0],t=[],s=0;s<this.sourceProject.length;s++)this.sourceProject[s].id===e&&(t=this.sourceProject[s].Members);return t}}),methods:a()({},Object(o.d)("projectglobal",["setCreateDialogShow","setViewDialogShow","setTaskChange"]),Object(o.d)("issue",["setIssueChange"]),{ok:function(e){var t=this;this.$refs[e].validate(function(s){s&&(t.setCreateDialogShow(!1),t.$axios.post("/api/project/"+t.formItem.Project[0]+"/version/"+t.formItem.Project[1]+"/issues",t.formItem).then(function(e){t.setIssueChange(!0),t.formItem.Title=" ",t.formItem.Desc="<p>步骤:</p></br><p>实际结果:</p></br><p>期望结果:</p>"},function(e){}),t.$refs[e].resetField())})},cancel:function(){this.setCreateDialogShow(!1)},handleSuccess:function(e,t,s){t.url=e.result.url,t.id=e.result.file_id,this.formItem.uploadList.push(t.id)},handleRemove:function(e,t){this.uploadList=t},handleFormatError:function(e){this.$Message.warning({content:"文件格式不正确,格式：'jpg','jpeg','png'",duration:10,closable:!0})},handleMaxSize:function(e){this.$Message.warning({content:"文件大小超过10M限制",duration:10,closable:!0})},onProjectChange:function(e,t){for(var s=e[0],i=0;i<this.sourceProject.length;i++)this.sourceProject[i].id===s&&(this.projectMember=this.sourceProject[i].Members,this.loadIssueProjectModules(s))},loadMyTeams:function(){var e=this;this.$axios.get("/api/common/teams/my").then(function(t){e.projectTeams=t.data.result},function(e){})},loadIssueStatus:function(){var e=this;this.$axios.get("/api/project/issue/status").then(function(t){e.issueStatus=t.data.result},function(e){})},loadIssueSeverity:function(){var e=this;this.$axios.get("/api/project/issue/severities").then(function(t){e.issueSeverity=t.data.result},function(e){})},loadIssueCategories:function(){var e=this;this.$axios.get("/api/project/issue/categories").then(function(t){e.issueCategories=t.data.result},function(e){})},loadIssueProjectPhrase:function(){var e=this;this.$axios.get("/api/project/issue/project_phrase").then(function(t){e.issueProjectPhrase=t.data.result},function(e){})},loadIssueProjectModules:function(e){var t=this;this.$axios.get("/api/project/"+e+"/project_modules").then(function(e){t.projectModules=e.data.result},function(e){})},loadIssueProjectPriority:function(){var e=this;this.$axios.get("/api/project/issue/priority").then(function(t){e.IssuePriority=t.data.result},function(e){})},loadIssueOS:function(){var e=this;this.$axios.get("/api/project/issue/os").then(function(t){e.DeviceOS=t.data.result},function(e){})},loadMyProject:function(){var e=this;this.$axios.get("/api/project/list?extinfo=1&home=1").then(function(t){var s=t.data.result;e.sourceProject=s,e.projectVersions=function(e){for(var t=[],s=0;s<e.length;s++){var i={};i.value=e[s].id,i.label=e[s].PBTitle,i.children=[];for(var a=0;a<e[s].Versions.length;a++){var o={};o.label=e[s].Versions[a].VVersion,o.value=e[s].Versions[a].id,i.children.push(o)}t.push(i)}return t}(s),console.log(e.sourceProject);for(var i=0;i<e.sourceProject.length;i++)if(e.sourceProject[i].id===e.project){e.formItem.Project[1]=e.sourceProject[i].LatestVersion;break}},function(e){})}}),created:function(){this.loadMyProject(),this.loadIssueSeverity(),this.loadMyTeams(),this.loadIssueProjectPriority(),this.loadIssueOS(),this.loadIssueProjectPhrase(),this.loadIssueCategories(),this.onProjectChange([].push(this.project)),this.formItem.Project.push(this.project),this.loadIssueProjectModules(this.project)},mounted:function(){},watch:{},components:{VueEditor:r.VueEditor,FormItem:n.a}},u={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("Modal",{attrs:{value:e.dialogShow,title:"添加新问题","mask-closable":!1,width:600,styles:{bottom:"20px",top:"50px"}},on:{"on-cancel":e.cancel}},[s("div",{style:"height:"+e.containerHeight+"px;overflow-y: scroll;overflow-x: hidden"},[s("Form",{ref:"createIssue",attrs:{model:e.formItem,"label-width":80,rules:e.ruleCustom}},[s("FormItem",{attrs:{label:"项目",prop:"Project"}},[s("Cascader",{attrs:{data:e.projectVersions,filterable:!0},on:{"on-change":e.onProjectChange},model:{value:e.formItem.Project,callback:function(t){e.$set(e.formItem,"Project",t)},expression:"formItem.Project"}})],1),e._v(" "),s("FormItem",{attrs:{label:"标题",prop:"Title"}},[s("Input",{attrs:{placeholder:"问题概述"},model:{value:e.formItem.Title,callback:function(t){e.$set(e.formItem,"Title",t)},expression:"formItem.Title"}})],1),e._v(" "),s("FormItem",{attrs:{label:"经办人",prop:"Processor"}},[s("Select",{attrs:{filterable:!0,placeholder:"默认为创建者"},model:{value:e.formItem.Processor,callback:function(t){e.$set(e.formItem,"Processor",t)},expression:"formItem.Processor"}},e._l(e.projectMembers,function(t){return s("Option",{key:t.PMMember,attrs:{value:t.PMMember}},[e._v(e._s(t.name)+"\n          ")])}))],1),e._v(" "),s("FormItem",{attrs:{label:"团队",prop:"Team"}},[s("Select",{attrs:{filterable:!0,placeholder:"选择项目角色"},model:{value:e.formItem.Team,callback:function(t){e.$set(e.formItem,"Team",t)},expression:"formItem.Team"}},e._l(e.projectTeams,function(t){return s("Option",{key:t.id,attrs:{value:t.id}},[e._v(e._s(t.Name)+"\n          ")])}))],1),e._v(" "),s("FormItem",{attrs:{label:"描述",prop:"Desc"}},[s("vue-editor",{attrs:{editorToolbar:e.editorToolBar,placeholder:"问题描述"},model:{value:e.formItem.Desc,callback:function(t){e.$set(e.formItem,"Desc",t)},expression:"formItem.Desc"}})],1),e._v(" "),s("Row",[s("i-col",{attrs:{span:12}},[s("FormItem",{attrs:{label:"模块",prop:"Module"}},[s("Select",{attrs:{filterable:!0,placeholder:"问题所属模块"},model:{value:e.formItem.Module,callback:function(t){e.$set(e.formItem,"Module",t)},expression:"formItem.Module"}},e._l(e.projectModules,function(t){return s("Option",{key:t.id,attrs:{value:t.id}},[e._v(e._s(t.Name)+"\n              ")])}))],1)],1),e._v(" "),s("i-col",{attrs:{span:12}},[s("FormItem",{attrs:{label:"分类",prop:"IssueCategory"}},[s("Select",{attrs:{filterable:!0,placeholder:"请选择分类"},model:{value:e.formItem.IssueCategory,callback:function(t){e.$set(e.formItem,"IssueCategory",t)},expression:"formItem.IssueCategory"}},e._l(e.issueCategories,function(t){return s("Option",{key:t.Value,attrs:{value:t.Value}},[e._v(e._s(t.Name)+"\n              ")])}))],1)],1)],1),e._v(" "),s("Row",[s("i-col",{attrs:{span:12}},[s("FormItem",{attrs:{label:"严重性",prop:"Severity"}},[s("Select",{attrs:{filterable:!0,placeholder:"问题严重性"},model:{value:e.formItem.Severity,callback:function(t){e.$set(e.formItem,"Severity",t)},expression:"formItem.Severity"}},e._l(e.issueSeverity,function(t){return s("Option",{key:t.Value,attrs:{value:t.Value}},[e._v(e._s(t.Name)+"\n              ")])}))],1)],1),e._v(" "),s("i-col",{attrs:{span:12}},[s("FormItem",{attrs:{label:"阶段",prop:"ProjectPhase"}},[s("Select",{attrs:{filterable:!0,placeholder:"问题发现阶段"},model:{value:e.formItem.ProjectPhase,callback:function(t){e.$set(e.formItem,"ProjectPhase",t)},expression:"formItem.ProjectPhase"}},e._l(e.issueProjectPhrase,function(t){return s("Option",{key:t.Value,attrs:{value:t.Value}},[e._v(e._s(t.Name)+"\n              ")])}))],1)],1)],1),e._v(" "),s("Row",[s("i-col",{attrs:{span:12}},[s("FormItem",{attrs:{label:"系统",prop:"DeviceOS"}},[s("Select",{attrs:{filterable:!0,placeholder:"问题系统"},model:{value:e.formItem.DeviceOS,callback:function(t){e.$set(e.formItem,"DeviceOS",t)},expression:"formItem.DeviceOS"}},e._l(e.DeviceOS,function(t){return s("Option",{key:t.Value,attrs:{value:t.Value}},[e._v(e._s(t.Name)+"\n              ")])}))],1)],1),e._v(" "),s("i-col",{attrs:{span:12}},[s("FormItem",{attrs:{label:"优先级",prop:"Priority"}},[s("Select",{attrs:{filterable:!0,placeholder:"问题优先级"},model:{value:e.formItem.Priority,callback:function(t){e.$set(e.formItem,"Priority",t)},expression:"formItem.Priority"}},e._l(e.IssuePriority,function(t){return s("Option",{key:t.Value,attrs:{value:t.Value}},[e._v(e._s(t.Name)+"\n              ")])}))],1)],1)],1),e._v(" "),s("FormItem",[s("Upload",{ref:"upload",attrs:{multiple:"",type:"drag",paste:"",action:"/api/project/issue/attachments","on-success":e.handleSuccess,"on-remove":e.handleRemove,format:[],"max-size":10240,"default-file-list":e.formItem.defaultList,"on-format-error":e.handleFormatError,"on-exceeded-size":e.handleMaxSize}},[s("div",{staticStyle:{padding:"20px 0"}},[s("Icon",{staticStyle:{color:"#3399ff"},attrs:{type:"ios-cloud-upload",size:"52"}}),e._v(" "),s("p",[e._v("点击，拖拽，粘贴上传附件")])],1)])],1)],1)],1),e._v(" "),s("div",{attrs:{slot:"footer"},slot:"footer"},[e.createDialogShow?s("Button",{staticStyle:{width:"80px",height:"30px"},attrs:{type:"success",shape:"circle"},on:{click:function(t){e.ok("createIssue")}}},[e._v("添加\n    ")]):e._e()],1)])},staticRenderFns:[]};var d=s("VU/8")(c,u,!1,function(e){s("wflP")},"data-v-4e76ac81",null);t.a=d.exports},hsEO:function(e,t){},iQFv:function(e,t){},jYkc:function(e,t){},rihW:function(e,t,s){"use strict";var i=s("Gu7T"),a=s.n(i),o=s("//Fk"),r=s.n(o),l=s("Dd8w"),n=s.n(l),c=s("NYxO"),u=s("WSP/"),d={name:"projectIssueList",props:{projectID:{type:[Number,String]},issueID:{type:[Number,String]}},data:function(){return{columnItemHeight:200,issueListObject:{next:null,issueData:[],count:0},issueSearchKey:"",showLoading:!0}},computed:n()({},Object(c.c)("issue",["issueChange","issueFilters","searchKeyword"]),Object(c.c)("projectglobal",["projectVersion"]),Object(c.c)(["appBodyHeight"]),{containerHeight:function(){return this.appBodyHeight-70},project:function(){var e=0;return this.projectID&&(e=this.projectID),e}}),methods:n()({},Object(c.d)("issue",["setIssueChange","setShowIssueDetail","setSelectIssueID","setSearchKeyword"]),Object(c.d)("projectglobal",["setViewDialogShow"]),{onIssueItemClick:function(e){this.setShowIssueDetail(!0),this.setSelectIssueID(e)},onSearchIssue:function(e){this.setSearchKeyword(e),this.loadIssueList(this.project,0)},handleReachBottom:function(){var e=this;if(null!=this.issueListObject.next)return new r.a(function(t){e.$axios.get(e.issueListObject.next).then(function(t){var s;(s=e.issueListObject.issueData).push.apply(s,a()(t.data.result.results)),e.issueListObject.next=t.data.result.next,e.issueListObject.count=t.data.result.count},function(e){})});this.$Message.warning({content:"没有更多问题了",duration:10,closable:!0})},loadIssueList:function(e,t){var s=this,i="";""!==this.issueSearchKey.trim()&&(i="Title__icontains="+this.issueSearchKey+"&"),this.showLoading=!0,this.$axios.get("/api/project/0/version/"+t+"/issues?"+i+this.issueFilters).then(function(e){var t;s.showLoading=!1,s.issueListObject.issueData=[],(t=s.issueListObject.issueData).push.apply(t,a()(e.data.result.results)),s.issueListObject.next=e.data.result.next,s.issueListObject.count=e.data.result.count},function(e){})}}),created:function(){this.loadIssueList(this.project,0)},mounted:function(){},watch:{issueChange:function(e){e&&(this.loadIssueList(this.project,0),this.setIssueChange(!1))},issueFilters:function(e){this.loadIssueList(this.project,0),this.setIssueChange(!1)}},components:{ProjectIssueItem:u.a}},p={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("Card",{staticStyle:{"border-left":"1px solid #e4e5e7","border-top":"1px solid #e4e5e7"},attrs:{padding:0,bordered:!1,shadow:!1,"dis-hover":""}},[s("div",{staticStyle:{height:"40px","border-bottom":"1px solid #e4e5e7"}},[s("div",{staticStyle:{width:"350px","padding-left":"20px","padding-top":"10px"}},[s("Input",{staticStyle:{"padding-right":"20px"},attrs:{size:"small",search:"",placeholder:"输入关键字，回车搜索"},on:{"on-search":e.onSearchIssue},model:{value:e.issueSearchKey,callback:function(t){e.issueSearchKey=t},expression:"issueSearchKey"}}),e._v(" "),s("span",{staticStyle:{"padding-right":"20px"}},[e._v(e._s(e.issueListObject.count)+" 个相关问题")])],1)]),e._v(" "),s("div",{staticStyle:{padding:"20px 20px 20px 0px"}},[e.showLoading?s("Spin",{attrs:{fix:"",size:"large"}}):e._e(),e._v(" "),s("Scroll",{attrs:{"on-reach-bottom":e.handleReachBottom,"loading-text":"拼命加载中",height:e.containerHeight}},e._l(e.issueListObject.issueData,function(t){return s("project-issue-item",{key:t.id,attrs:{issue:t},on:{"view-issue":e.onIssueItemClick}})}))],1)])],1)},staticRenderFns:[]};var h=s("VU/8")(d,p,!1,function(e){s("/j3j")},"data-v-2fd00c09",null);t.a=h.exports},ttFk:function(e,t,s){"use strict";var i=s("Dd8w"),a=s.n(i),o=s("5MND"),r=s("8H5h"),l=s("aYpo"),n={name:"labelEditorVueEditor",props:["placeHolder","displayText"],data:function(){return{editorToolBar:[["bold","italic","underline"],[{list:"ordered"},{list:"bullet"}],[{color:[]},{background:[]}]],editValue:"",displayValue:"",mouseHover:!1,edited:!1,show:!0}},computed:{},methods:{onMouseOver:function(){this.mouseHover=!0},onMouseOut:function(){this.mouseHover=!1},onClickEdit:function(){this.mouseHover=!1,this.show=!1,this.edited=!0},onCancel:function(){this.mouseHover=!1,this.show=!0,this.edited=!1},onOk:function(){this.displayValue=this.editValue,this.$emit("updateValue",this.editValue),this.mouseHover=!1,this.show=!0,this.edited=!1}},created:function(){this.displayValue=this.displayText,this.editValue=this.displayText,this.edited=!1},watch:{displayText:function(){this.displayValue=this.displayText,this.editValue=this.displayText,this.show=!0,this.mouseHover=!1,this.edited=!1}},components:{VueEditor:l.VueEditor}},c={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("Tooltip",{attrs:{content:"点击开始编辑",transfer:""}},[e.show?s("div",{staticClass:"cursor-hand",on:{mouseout:e.onMouseOut,click:e.onClickEdit,mouseover:e.onMouseOver}},[s("span",{domProps:{innerHTML:e._s(e.displayValue)}},[e._v(e._s(e.displayValue))]),e._v(" "),s("span",{staticStyle:{"margin-top":"-10px"}},[s("Icon",{staticClass:"cursor-hand",attrs:{type:"ios-create-outline",size:18}})],1)]):e._e()]),e._v(" "),e.edited?s("vue-editor",{attrs:{editorToolbar:e.editorToolBar,placeholder:e.placeHolder},model:{value:e.editValue,callback:function(t){e.editValue=t},expression:"editValue"}}):e._e(),e._v(" "),e.edited?s("ButtonGroup",{staticStyle:{width:"100px","margin-left":"0px","padding-top":"13px"},attrs:{slot:"suffix",shape:"circle",size:"small"},slot:"suffix"},[s("Icon",{staticClass:"cursor-hand",attrs:{size:20,color:"black",type:"md-checkmark"},on:{click:e.onOk}}),e._v(" "),s("Icon",{staticClass:"cursor-hand",attrs:{size:20,color:"black",type:"md-close"},on:{click:e.onCancel}})],1):e._e()],1)},staticRenderFns:[]};var u=s("VU/8")(n,c,!1,function(e){s("hsEO")},"data-v-73dd147e",null).exports,d=s("YRzF"),p=s("NYxO"),h={name:"ProjectIssueDetail",props:["issueID"],data:function(){return{fullScreenStyle:{top:"100px",bottom:"100px",left:"5%",right:"5%",width:"90% !important"},issueDetail:{},projectVersions:[],projectMembers:[],projectTeams:[],projectModules:[],issueSeverity:[],issueProjectPhrase:[],issueCategories:[],DeviceOS:[],issuePriority:[],issueResolvedResult:[],issueActivities:[],viewAttachment:{isPicture:!1,showDialog:!1,fileName:"",fileID:0},issueFieldValue:{Processor:0},editorToolBar:[["bold","italic","underline"],[{list:"ordered"},{list:"bullet"}],[{color:[]},{background:[]}]],showUploadAttachmentDialog:!1,uploadList:[],defaultList:[],resloveIssueDialog:{isShow:!1,title:"",dialogType:0},issueComments:{Message:"",ActionFlag:1,ActionType:2,Issue:0,OldValue:"",NewValue:"",FieldName:""},formItem:{ResloveResult:1,Desc:""}}},computed:a()({},Object(p.c)(["appBodyHeight","userInfo","appBodyWidth"]),{qrcodeContent:function(){return"http://"+window.location.host+"/project/issue/"+this.issueID+"/mobile/upload"},issueTitleMaxWidth:function(){return console.log(.6*this.appBodyWidth),.6*this.appBodyWidth-200}}),methods:a()({},Object(p.d)("issue",["setIssueChange"]),{loadIssueDetail:function(e){var t=this;this.$axios.get("/api/project/issue/"+e).then(function(e){t.issueDetail=e.data.result,t.loadIssueProjectModules(t.issueDetail.Project),t.loadProject(t.issueDetail.Project)},function(e){})},handleSuccess:function(e,t,s){t.url=e.result.url,t.id=e.result.file_id,this.uploadList.push(t.id)},handleRemove:function(e,t){this.uploadList=t,console.log(this.uploadList)},handleFormatError:function(e){this.$Message.warning({content:"文件格式不正确,格式：'jpg','jpeg','png'",duration:10,closable:!0})},handleMaxSize:function(e){this.$Message.warning({content:"文件大小超过20M限制",duration:10,closable:!0})},uploadIssueAttachment:function(){this.showUploadAttachmentDialog=!0},delectAttachment:function(e,t){var s=this;this.$Modal.confirm({title:"附件删除确认",content:"即将删除附件"+t,onOk:function(){s.$axios.delete("/api/project/issue/"+s.issueDetail.id+"/attachment/"+e).then(function(e){s.loadIssueDetail(s.issueDetail.id)},function(e){})},onCancel:function(){}})},onPatchIssueAttachment:function(){var e=this,t={};t.uploadList=this.uploadList,this.$axios.patch("/api/project/issue/"+this.issueDetail.id+"/attachment/0",t).then(function(t){e.$Message.success({content:"文件上传成功",duration:10,closable:!0}),e.uploadList=[],e.loadIssueDetail(e.issueDetail.id)},function(t){e.uploadList=[]})},onResloveIssue:function(){this.resloveIssueDialog.isShow=!0,this.resloveIssueDialog.title="解决问题",this.resloveIssueDialog.dialogType=1},onCloseIssue:function(){this.resloveIssueDialog.isShow=!0,this.resloveIssueDialog.title="关闭问题",this.resloveIssueDialog.dialogType=2},onReOpenIssue:function(){this.resloveIssueDialog.isShow=!0,this.resloveIssueDialog.title="重新打开问题",this.resloveIssueDialog.dialogType=3},resloveIssueResult:function(){var e=this;this.formItem.operation=this.resloveIssueDialog.dialogType,this.$axios.post("/api/project/issue/"+this.issueDetail.id,this.formItem).then(function(t){e.setIssueChange(!0),e.loadIssueDetail(e.issueID),e.loadIssueActivities(e.issueID)},function(e){})},loadProject:function(e){var t=this;e&&this.$axios.get("/api/project/"+e+"/detail?extinfo=1").then(function(e){t.projectVersions=e.data.result.Versions,t.projectMembers=e.data.result.Members},function(e){})},updateIssueTitle:function(e){e.trim()!==this.issueDetail.Title.trim()&&this.updateIssueInputField(this.issueDetail.Title.trim(),e.trim(),"Title")},updateIssueDesc:function(e){e.trim()!==this.issueDetail.Desc.trim()&&this.updateIssueInputField(this.issueDetail.Desc.trim(),e.trim(),"Desc")},updateIssueInputField:function(e,t,s){this.issueComments.OldValue=e,this.issueDetail[s]=t,this.issueComments.Message="属性",this.issueComments.Issue=this.issueID,this.issueComments.Creator=this.userInfo.id,this.issueComments.NewValue=t,this.issueComments.FieldName=s,this.issueComments.ActionFlag=2,this.issueComments.ActionType=1,this.updateIssueProperty(s,t)},loadMyTeams:function(){var e=this;this.$axios.get("/api/common/teams/my").then(function(t){e.projectTeams=t.data.result},function(e){})},loadIssueSeverity:function(){var e=this;this.$axios.get("/api/project/issue/severities").then(function(t){e.issueSeverity=t.data.result},function(e){})},loadIssueCategories:function(){var e=this;this.$axios.get("/api/project/issue/categories").then(function(t){e.issueCategories=t.data.result},function(e){})},loadIssueReslovedResult:function(){var e=this;this.$axios.get("/api/project/issue/resolve_results").then(function(t){e.issueResolvedResult=t.data.result},function(e){})},loadIssueProjectPhrase:function(){var e=this;this.$axios.get("/api/project/issue/project_phrase").then(function(t){e.issueProjectPhrase=t.data.result},function(e){})},loadIssueProjectModules:function(e){var t=this;e&&this.$axios.get("/api/project/"+e+"/project_modules").then(function(e){t.projectModules=e.data.result},function(e){})},loadIssueProjectPriority:function(){var e=this;this.$axios.get("/api/project/issue/priority").then(function(t){e.issuePriority=t.data.result},function(e){})},loadIssueOS:function(){var e=this;this.$axios.get("/api/project/issue/os").then(function(t){e.DeviceOS=t.data.result},function(e){})},loadIssueActivities:function(e){var t=this;this.$axios.get("/api/project/issue/"+e+"/activities").then(function(e){t.issueActivities=e.data.result},function(e){})},onProcessorChange:function(e){this.issueComments.OldValue="",this.issueDetail.Processor=parseInt(e.value),this.issueComments.Message="属性",this.issueComments.Issue=this.issueID,this.issueComments.Creator=this.userInfo.id,this.issueComments.NewValue=e.label,this.issueComments.FieldName="Processor",this.issueComments.ActionFlag=2,this.issueComments.ActionType=1,this.updateIssueProperty("Processor",parseInt(e.value))},onFieldItemClick:function(e){var t=e.split(",");3===t.length&&(this.issueComments.OldValue=this.$refs[t[2]].innerHTML,this.$refs[t[2]].innerHTML=t[1],this.issueDetail[t[2]]=parseInt(t[0]),this.issueComments.Message="属性",this.issueComments.Issue=this.issueID,this.issueComments.Creator=this.userInfo.id,this.issueComments.NewValue=t[1],this.issueComments.FieldName=t[2],this.issueComments.ActionFlag=2,this.issueComments.ActionType=1,this.updateIssueProperty(t[2],parseInt(t[0])))},updateIssueProperty:function(e,t){var s=this,i={};i[e]=t,this.$axios.patch("/api/project/issue/"+this.issueID,i).then(function(e){s.$axios.post("/api/project/issue/"+s.issueID+"/activities",s.issueComments).then(function(e){s.$Message.success({content:"问题成功更新。",duration:10,closable:!0}),s.setIssueChange(!0),s.loadIssueActivities(s.issueID)},function(e){})},function(e){})},onAddComments:function(e){var t=this;""!==e.trim()&&(this.issueComments.Message=e,this.issueComments.Issue=this.issueID,this.issueComments.Creator=this.userInfo.id,this.issueComments.NewValue="",this.issueComments.OldValue="",this.issueComments.FieldName="",this.issueComments.ActionType=2,this.issueComments.ActionFlag=1,this.$axios.post("/api/project/issue/"+this.issueID+"/activities",this.issueComments).then(function(e){t.loadIssueActivities(t.issueID)},function(e){}))},onViewAttachment:function(e,t,s){this.viewAttachment.showDialog=!0,this.viewAttachment.fileName=e,this.viewAttachment.fileID=t,this.viewAttachment.isPicture="jpg"===s||"jpeg"===s||"png"===s}}),created:function(){this.loadIssueDetail(this.issueID),this.loadIssueSeverity(),this.loadMyTeams(),this.loadIssueProjectPriority(),this.loadIssueOS(),this.loadIssueProjectPhrase(),this.loadIssueCategories(),this.loadIssueReslovedResult()},watch:{issueID:function(e){this.loadIssueDetail(e),this.loadIssueActivities(e)}},components:{ICol:d.a,labelEditorInput:o.a,labelEditorSelect:r.a,labelEditorVueEditor:u,VueEditor:l.VueEditor}},m={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"issue-detail",staticStyle:{margin:"-16px"}},[s("div",{staticClass:"issue-title"},[5===e.issueDetail.Status?s("Button",{staticStyle:{"margin-right":"10px"},attrs:{size:"small",type:"success",shape:"circle",icon:"ios-construct",ghost:""},on:{click:e.onResloveIssue}},[e._v("解决")]):e._e(),e._v(" "),2===e.issueDetail.Status?s("Button",{staticStyle:{"margin-right":"10px"},attrs:{size:"small",type:"success",shape:"circle",icon:"ios-construct",ghost:""},on:{click:e.onResloveIssue}},[e._v("解决")]):e._e(),e._v(" "),3!==e.issueDetail.Status?s("Button",{staticStyle:{"margin-right":"10px"},attrs:{size:"small",type:"warning",shape:"circle",icon:"md-checkmark-circle-outline",ghost:""},on:{click:e.onCloseIssue}},[e._v("关闭")]):e._e(),e._v(" "),3===e.issueDetail.Status?s("Button",{staticStyle:{"margin-right":"10px"},attrs:{size:"small",type:"error",shape:"circle",icon:"md-redo",ghost:""},on:{click:e.onReOpenIssue}},[e._v("重新打开")]):e._e(),e._v(" "),4===e.issueDetail.Status?s("Button",{staticStyle:{"margin-right":"10px"},attrs:{size:"small",type:"error",shape:"circle",icon:"md-redo",ghost:""},on:{click:e.onReOpenIssue}},[e._v("重新打开")]):e._e()],1),e._v(" "),s("Divider",{staticStyle:{margin:"0px"}}),e._v(" "),s("div",{staticClass:"issue-detail-body"},[s("div",{staticClass:"issue-detail-summary"},[s("div",{staticStyle:{height:"80px"}},[s("div",[s("span",{staticClass:"issue-detail-id"},[e._v("#"+e._s(e.issueDetail.id))]),e._v(" "),s("span",{staticClass:"issue-detail-title"},[s("label-editor-input",{attrs:{placeHolder:"问题标题",displayWidth:e.issueTitleMaxWidth,displayText:e.issueDetail.Title},on:{updateValue:e.updateIssueTitle}})],1)]),e._v(" "),s("div",{staticClass:"issue-detail-creation"},[s("span",{staticClass:"issue-detail-creator"},[e._v(e._s(e.issueDetail.creator_name)+" 创建于")]),e._v(" "),s("span",{staticClass:"issue-detail-createdate"},[e._v(e._s(e.issueDetail.create_date))]),e._v(" "),s("span",{staticClass:"issue-detail-createdate"},[e._v(e._s(e.issueDetail.update_date)+" 更新")])])]),e._v(" "),s("div",{staticClass:"issue-detail-topic"},[s("Row",[s("i-col",{attrs:{span:6}},[s("span",{staticClass:"issue-detail-topic-content"},[s("span",{staticClass:"issue-detail-topic-field-name"},[e._v("状态")]),e._v(" "),s("i",{class:"fa "+e.issueDetail.status_name.Label+" "+e.issueDetail.status_name.LabelStyle}),e._v(" "),s("span",[e._v(e._s(e.issueDetail.status_name.Name))])])]),e._v(" "),s("i-col",{attrs:{span:6}},[s("span",{staticClass:"issue-detail-topic-content"},[s("span",{staticClass:"issue-detail-topic-field-name"},[e._v("解决结果")]),e._v(" "),s("i",{class:"fa "+e.issueDetail.solution_name.Label+" "+e.issueDetail.solution_name.LabelStyle}),e._v(" "),s("span",[e._v(e._s(e.issueDetail.solution_name.Name))])])]),e._v(" "),s("i-col",{attrs:{span:6}},[s("span",{staticClass:"issue-detail-topic-content"},[s("span",{staticClass:"issue-detail-topic-field-name"},[e._v("严重性")]),e._v(" "),s("i",{class:"fa "+e.issueDetail.severity_name.Label+" "+e.issueDetail.severity_name.LabelStyle}),e._v(" "),s("span",[s("Dropdown",{on:{"on-click":e.onFieldItemClick}},[s("a",{attrs:{href:"javascript:void(0)"}},[s("span",{ref:"Severity"},[e._v(e._s(e.issueDetail.severity_name.Name))]),e._v(" "),s("Icon",{attrs:{type:"ios-arrow-down"}})],1),e._v(" "),s("DropdownMenu",{attrs:{slot:"list"},slot:"list"},e._l(e.issueSeverity,function(t){return s("DropdownItem",{key:t.Value,attrs:{selected:t.id===e.issueDetail.Severity,name:t.Value+","+t.Name+",Severity"}},[e._v(e._s(t.Name))])}))],1)],1)])]),e._v(" "),s("i-col",{attrs:{span:6}},[s("span",{staticClass:"issue-detail-topic-content"},[s("span",{staticClass:"issue-detail-topic-field-name"},[e._v("优先级")]),e._v(" "),s("i",{staticClass:"fa fa-fire issue-status-reopen"}),e._v(" "),s("span",[s("Dropdown",{on:{"on-click":e.onFieldItemClick}},[s("a",{attrs:{href:"javascript:void(0)"}},[s("span",{ref:"Priority"},[e._v(e._s(e.issueDetail.priority_name))]),e._v(" "),s("Icon",{attrs:{type:"ios-arrow-down"}})],1),e._v(" "),s("DropdownMenu",{attrs:{slot:"list"},slot:"list"},e._l(e.issuePriority,function(t){return s("DropdownItem",{key:t.Value,attrs:{selected:t.id===e.issueDetail.Priority,name:t.Value+","+t.Name+",Priority"}},[e._v(e._s(t.Name))])}))],1)],1)])])],1)],1)]),e._v(" "),s("Divider",{staticStyle:{margin:"0px"}}),e._v(" "),s("div",{staticClass:"issue-detail-editor"},[s("div",{staticClass:"issue-detail-desc"},[e._m(0),e._v(" "),s("div",{staticClass:"issue-detail-desc-content-veiw"},[s("label-editor-vue-editor",{attrs:{placeHolder:"问题描述",displayText:e.issueDetail.Desc},on:{updateValue:e.updateIssueDesc}})],1)]),e._v(" "),s("Divider",{staticStyle:{margin:"0px"}}),e._v(" "),s("div",{staticClass:"issue-detail-option"},[s("Row",{staticStyle:{height:"50px"}},[s("i-col",{staticClass:"issue-detail-field-content",attrs:{span:8}},[s("span",[s("i",{staticClass:"fa fa-hand-o-right"}),e._v(" 经办人：\n             ")]),e._v(" "),s("Select",{staticStyle:{width:"100px"},attrs:{"label-in-value":"",size:"small",filterable:""},on:{"on-change":e.onProcessorChange},model:{value:e.issueDetail.Processor,callback:function(t){e.$set(e.issueDetail,"Processor",t)},expression:"issueDetail.Processor"}},e._l(e.projectMembers,function(t){return s("Option",{key:t.id,attrs:{value:t.PMMember}},[e._v(e._s(t.name))])}))],1),e._v(" "),s("i-col",{staticClass:"issue-detail-field-content",attrs:{span:8}},[s("Dropdown",{on:{"on-click":e.onFieldItemClick}},[s("span",{ref:"Team"},[s("i",{staticClass:"fa fa-hand-o-right"}),e._v(" 团队：\n              ")]),e._v(" "),s("a",{attrs:{href:"javascript:void(0)"}},[s("span",{ref:"Team"},[e._v(e._s(e.issueDetail.team_name))]),e._v(" "),s("Icon",{attrs:{type:"ios-arrow-down"}})],1),e._v(" "),s("DropdownMenu",{attrs:{slot:"list"},slot:"list"},e._l(e.projectTeams,function(t){return s("DropdownItem",{key:t.Value,attrs:{selected:t.id===e.issueDetail.Team,name:t.id+","+t.Name+",Team"}},[e._v(e._s(t.Name))])}))],1)],1),e._v(" "),s("i-col",{staticClass:"issue-detail-field-content",attrs:{span:8}},[s("Dropdown",{on:{"on-click":e.onFieldItemClick}},[s("span",[s("i",{staticClass:"fa fa-cube"}),e._v(" 模块：\n              ")]),e._v(" "),s("a",{attrs:{href:"javascript:void(0)"}},[s("span",{ref:"Module"},[e._v(" "+e._s(e.issueDetail.module_name))]),e._v(" "),s("Icon",{attrs:{type:"ios-arrow-down"}})],1),e._v(" "),s("DropdownMenu",{attrs:{slot:"list"},slot:"list"},e._l(e.projectModules,function(t){return s("DropdownItem",{key:t.id,attrs:{selected:t.id===e.issueDetail.Module,name:t.id+","+t.Name+",Module"}},[e._v(e._s(t.Name))])}))],1)],1)],1),e._v(" "),s("Row",{staticStyle:{height:"50px"}},[s("i-col",{staticClass:"issue-detail-field-content",attrs:{span:8}},[s("Dropdown",{on:{"on-click":e.onFieldItemClick}},[s("span",[s("i",{staticClass:"fa fa-code-fork"}),e._v(" 版本：\n              ")]),e._v(" "),s("a",{attrs:{href:"javascript:void(0)"}},[s("span",{ref:"Version"},[e._v(e._s(e.issueDetail.version_name))]),e._v(" "),s("Icon",{attrs:{type:"ios-arrow-down"}})],1),e._v(" "),s("DropdownMenu",{attrs:{slot:"list"},slot:"list"},e._l(e.projectVersions,function(t){return s("DropdownItem",{key:t.id,attrs:{selected:t.id===e.issueDetail.Version,name:t.id+","+t.VVersion+",Version"}},[e._v(e._s(t.VVersion))])}))],1)],1),e._v(" "),s("i-col",{staticClass:"issue-detail-field-content",attrs:{span:8}},[s("Dropdown",{on:{"on-click":e.onFieldItemClick}},[s("span",[s("i",{staticClass:"fa fa-chain"}),e._v(" 问题分类：\n              ")]),e._v(" "),s("a",{attrs:{href:"javascript:void(0)"}},[s("span",{ref:"IssueCategory"},[e._v(e._s(e.issueDetail.category_name))]),e._v(" "),s("Icon",{attrs:{type:"ios-arrow-down"}})],1),e._v(" "),s("DropdownMenu",{attrs:{slot:"list"},slot:"list"},e._l(e.issueCategories,function(t){return s("DropdownItem",{key:t.Value,attrs:{selected:t.id===e.issueDetail.IssueCategory,name:t.Value+","+t.Name+",IssueCategory"}},[e._v(e._s(t.Name))])}))],1)],1),e._v(" "),s("i-col",{staticClass:"issue-detail-field-content",attrs:{span:8}},[s("Dropdown",{on:{"on-click":e.onFieldItemClick}},[s("span",[s("i",{staticClass:"fa fa-leaf"}),e._v(" 项目阶段：\n              ")]),e._v(" "),s("a",{attrs:{href:"javascript:void(0)"}},[s("span",{ref:"ProjectPhase"},[e._v(" "+e._s(e.issueDetail.project_phrase_name))]),e._v(" "),s("Icon",{attrs:{type:"ios-arrow-down"}})],1),e._v(" "),s("DropdownMenu",{attrs:{slot:"list"},slot:"list"},e._l(e.issueProjectPhrase,function(t){return s("DropdownItem",{key:t.Value,attrs:{selected:t.id===e.issueDetail.ProjectPhase,name:t.Value+","+t.Name+",ProjectPhase"}},[e._v(e._s(t.Name))])}))],1)],1)],1),e._v(" "),s("Row",[s("i-col",{staticClass:"issue-detail-field-content",attrs:{span:8}},[s("Dropdown",{on:{"on-click":e.onFieldItemClick}},[s("span",[s("i",{staticClass:"fa fa-sticky-note"}),e._v(" 系统：\n              ")]),e._v(" "),s("a",{attrs:{href:"javascript:void(0)"}},[s("span",{ref:"DeviceOS"},[e._v(" "+e._s(e.issueDetail.os_name))]),e._v(" "),s("Icon",{attrs:{type:"ios-arrow-down"}})],1),e._v(" "),s("DropdownMenu",{attrs:{slot:"list"},slot:"list"},e._l(e.DeviceOS,function(t){return s("DropdownItem",{key:t.Value,attrs:{selected:t.id===e.issueDetail.DeviceOS,name:t.Value+","+t.Name+",DeviceOS"}},[e._v(e._s(t.Name))])}))],1)],1)],1)],1),e._v(" "),s("Divider",{staticStyle:{margin:"0px"}}),e._v(" "),s("div",{staticClass:"issue-detail-attachment"},[s("Row",[s("i-col",{attrs:{span:18}},[s("span",{staticStyle:{color:"#b2b2b2","font-size":"14px"}},[s("Icon",{attrs:{type:"ios-attach",size:20}}),e._v("附件：")],1)]),e._v(" "),s("i-col",{attrs:{span:6}},[s("span",{on:{click:e.uploadIssueAttachment}},[s("Button",{attrs:{icon:"md-cloud-upload",shape:"circle",size:"small"}},[e._v("上传")])],1)])],1),e._v(" "),s("div",{staticStyle:{"padding-top":"20px"}},e._l(e.issueDetail.attachments_detail,function(t){return s("Row",{key:t.id,staticClass:"attachment-item"},[s("i-col",{attrs:{span:18}},[s("span",{staticClass:"cursor-hand",on:{click:function(s){e.onViewAttachment(t.FileName,t.id,t.FileSuffixes)}}},[s("Icon",{attrs:{type:"ios-attach",size:15}}),e._v(e._s(t.FileName))],1)]),e._v(" "),s("i-col",{attrs:{span:6}},[s("a",{attrs:{href:"/api/project/issue/"+e.issueID+"/attachment/"+t.id}},[s("Icon",{attrs:{type:"ios-cloud-download",size:20}})],1),e._v(" "),s("span",{staticClass:"cursor-hand",on:{click:function(s){e.delectAttachment(t.id,t.FileName)}}},[s("Icon",{attrs:{type:"ios-trash",size:20}})],1),e._v(" "),s("span",{staticStyle:{"padding-left":"30px",color:"#b2b2b2"}},[s("Time",{attrs:{time:t.CreationTimeFormat}})],1)])],1)}))],1),e._v(" "),s("Divider",{staticStyle:{margin:"0px"}}),e._v(" "),s("div",{staticClass:"issue-detail-comments"},[s("div",{staticStyle:{"font-size":"15px","margin-bottom":"15px"}},[s("Icon",{attrs:{type:"ios-megaphone",size:15}}),e._v(" 问题动态")],1),e._v(" "),s("div",{staticStyle:{"padding-left":"20px","padding-bottom":"40px"}},[s("Timeline",e._l(e.issueActivities,function(t){return s("TimelineItem",{key:t.id,attrs:{color:"#3b73af"}},[s("Icon",{attrs:{slot:"dot",size:20,type:"md-add-circle"},slot:"dot"}),e._v(" "),s("span",{staticStyle:{"font-size":"15px","white-space":"normal"}},[e._v("\n                "+e._s(t.creator_name)+"  "+e._s(t.action_flag_name)+" "+e._s(t.action_type_name)+" "+e._s(t.Message)+" "+e._s(t.FieldDesc)+"\n                "),s("span",{staticStyle:{"text-decoration":"line-through"},domProps:{innerHTML:e._s(t.OldValue)}},[e._v(e._s(t.OldValue))]),e._v(" "),s("span",{domProps:{innerHTML:e._s(t.NewValue)}})]),e._v(" "),s("span",{staticStyle:{float:"right","padding-right":"20px"}},[e._v(e._s(t.create_date))])],1)}))],1)])],1),e._v(" "),s("div",{staticClass:"issue-comments-input"},[s("Input",{attrs:{search:"","enter-button":"发布",size:"large",placeholder:"输入内容，回车发布备注信息"},on:{"on-search":e.onAddComments}})],1)],1),e._v(" "),s("div",[s("Modal",{attrs:{"class-name":"attachment-view",fullscreen:"",styles:e.fullScreenStyle,"footer-hide":"",title:e.viewAttachment.fileName},model:{value:e.viewAttachment.showDialog,callback:function(t){e.$set(e.viewAttachment,"showDialog",t)},expression:"viewAttachment.showDialog"}},[!0!==e.viewAttachment.isPicture?s("div",[s("Alert",{attrs:{type:"error","show-icon":""}},[s("span",{attrs:{slot:"desc"},slot:"desc"},[e._v("\n          不支持非图片类文件的预览，请下载这个文件！\n      ")])])],1):e._e(),e._v(" "),e.viewAttachment.isPicture?s("div",[s("img",{staticStyle:{"max-width":"1920px","max-height":"1080px"},attrs:{src:"/api/project/issue/"+e.issueID+"/attachment/"+e.viewAttachment.fileID}})]):e._e()])],1),e._v(" "),s("Modal",{attrs:{title:"附件上传"},on:{"on-ok":e.onPatchIssueAttachment},model:{value:e.showUploadAttachmentDialog,callback:function(t){e.showUploadAttachmentDialog=t},expression:"showUploadAttachmentDialog"}},[s("Tabs",[s("TabPane",{attrs:{label:"本地上传"}},[s("Upload",{ref:"upload",attrs:{multiple:"",type:"drag",paste:"",action:"/api/project/issue/attachments","on-success":e.handleSuccess,"on-remove":e.handleRemove,format:[],"max-size":20480,"default-file-list":e.defaultList,"on-format-error":e.handleFormatError,"on-exceeded-size":e.handleMaxSize}},[s("div",{staticStyle:{padding:"20px 0"}},[s("Icon",{staticStyle:{color:"#3399ff"},attrs:{type:"ios-cloud-upload",size:"52"}}),e._v(" "),s("p",[e._v("点击，拖拽，粘贴上传附件")])],1)])],1),e._v(" "),s("TabPane",{staticStyle:{"padding-left":"35%"},attrs:{label:"扫码上传"}},[s("img",{staticStyle:{height:"100px",width:"100px"},attrs:{src:"/api/common/toolkit/qrcode?content="+e.qrcodeContent}})])],1)],1),e._v(" "),s("Modal",{attrs:{title:e.resloveIssueDialog.title},on:{"on-ok":e.resloveIssueResult},model:{value:e.resloveIssueDialog.isShow,callback:function(t){e.$set(e.resloveIssueDialog,"isShow",t)},expression:"resloveIssueDialog.isShow"}},[s("Form",{ref:"resloveIssue",attrs:{model:e.formItem,"label-width":80}},[1===e.resloveIssueDialog.dialogType?s("FormItem",{attrs:{label:"解决结果",prop:"ResloveResult"}},[s("Select",{model:{value:e.formItem.ResloveResult,callback:function(t){e.$set(e.formItem,"ResloveResult",t)},expression:"formItem.ResloveResult"}},e._l(e.issueResolvedResult,function(t){return s("Option",{key:t.Value,attrs:{value:t.Value}},[e._v(e._s(t.Name)+"\n          ")])}))],1):e._e(),e._v(" "),s("FormItem",{attrs:{label:"描述",prop:"Desc"}},[s("vue-editor",{attrs:{editorToolbar:e.editorToolBar,placeholder:"问题描述"},model:{value:e.formItem.Desc,callback:function(t){e.$set(e.formItem,"Desc",t)},expression:"formItem.Desc"}})],1)],1)],1)],1)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"issue-detail-desc-title"},[t("i",{staticClass:"fa fa-sticky-note"}),this._v("\n          描述：\n        ")])}]};var f=s("VU/8")(h,m,!1,function(e){s("jYkc")},"data-v-0b9f74df",null);t.a=f.exports},wflP:function(e,t){}});
//# sourceMappingURL=4.55067e3a8d39d8349d2a.js.map
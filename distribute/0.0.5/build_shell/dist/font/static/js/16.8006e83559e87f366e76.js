webpackJsonp([16],{"7oIw":function(e,t){},F5JC:function(e,t){},IpAL:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=o("Dd8w"),r=o.n(s),a=o("NYxO"),n=o("5MND"),i=o("cpf5"),c={name:"ProjectInfo",props:["project"],data:function(){return{projectInfo:{},userList:[],products:[],ruleCustom:r()({},i.a)}},computed:r()({},Object(a.c)(["appBodyHeight","userInfo"]),Object(a.c)("projectglobal",["createDocumentType"]),Object(a.c)("document",["breadNav"]),{containerHeight:function(){return this.appBodyHeight}}),methods:r()({},Object(a.d)("projectglobal",["setCreateDocumentType","setCreateDialogShow"]),{updateProject:function(e){var t=this;this.$refs[e].validate(function(e){e&&t.$axios.put("/api/project/"+t.projectInfo.id+"/detail",t.projectInfo).then(function(e){t.$Message.success({content:"项目信息更新成功！",duration:10})},function(e){t.$Message.error({content:"项目信息更新失败，请联系管理员或者重试",duration:10})})})},deleteProject:function(){var e=this;this.$Modal.confirm({title:"删除确认",content:"您即将删除项目["+this.projectInfo.PBTitle+"]",onOk:function(){e.$axios.delete("/api/project/"+e.projectInfo.id+"/detail").then(function(t){e.$Message.success({content:"项目删除成功",duration:10,closable:!0}),e.$router.replace("/project")},function(t){e.$Message.success({content:"项目删除失败",duration:10,closable:!0})})},onCancel:function(){}})}}),created:function(){var e=this;this.$axios.get("/api/common/users/list").then(function(t){e.userList=t.data.result},function(e){}),this.$axios.get("/api/project/products").then(function(t){e.products=t.data.result},function(e){}),this.projectInfo=this.project},mounted:function(){},watch:{project:function(){this.projectInfo=this.project}},components:{labelEditorInput:n.a}},l={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"info-body"},[o("Form",{ref:"projectCreate",attrs:{model:e.projectInfo,"label-width":80,rules:e.ruleCustom}},[o("FormItem",{attrs:{label:"项目名称",prop:"PBTitle"}},[o("Input",{attrs:{placeholder:"项目名称1-50个字符"},model:{value:e.projectInfo.PBTitle,callback:function(t){e.$set(e.projectInfo,"PBTitle",t)},expression:"projectInfo.PBTitle"}})],1),e._v(" "),o("FormItem",{attrs:{label:"项目Key",prop:"PBKey"}},[o("Input",{attrs:{readonly:"",placeholder:"项目唯一标示，1-10英文字符"},model:{value:e.projectInfo.PBKey,callback:function(t){e.$set(e.projectInfo,"PBKey",t)},expression:"projectInfo.PBKey"}})],1),e._v(" "),o("FormItem",{attrs:{label:"负责人",prop:"PBLead"}},[o("Select",{attrs:{filterable:!0,placeholder:"项目负责人"},model:{value:e.projectInfo.PBLead,callback:function(t){e.$set(e.projectInfo,"PBLead",t)},expression:"projectInfo.PBLead"}},e._l(e.userList,function(t){return o("Option",{key:t.id,attrs:{value:t.id}},[e._v(e._s(t.last_name)+e._s(t.first_name)+" ("+e._s(t.email)+")")])}))],1),e._v(" "),o("FormItem",{attrs:{label:"产品线",prop:"Product"}},[o("Select",{attrs:{filterable:!0,placeholder:"任务类型"},model:{value:e.projectInfo.Product,callback:function(t){e.$set(e.projectInfo,"Product",t)},expression:"projectInfo.Product"}},e._l(e.products,function(t){return o("Option",{key:t.id,attrs:{value:t.id}},[e._v(e._s(t.PTitle))])}))],1),e._v(" "),o("FormItem",{attrs:{label:"可见性",prop:"PBVisiableLevel"}},[o("Row",[o("Col",{attrs:{span:"8",offset:"0"}},[o("RadioGroup",{attrs:{vertical:""},model:{value:e.projectInfo.PBVisiableLevel,callback:function(t){e.$set(e.projectInfo,"PBVisiableLevel",t)},expression:"projectInfo.PBVisiableLevel"}},[o("Radio",{attrs:{label:1}},[o("Icon",{attrs:{type:"locked",size:20}}),e._v(" "),o("span",[e._v("私有")]),e._v(" "),o("span",{staticStyle:{color:"#737373","padding-left":"20px"}},[e._v("项目仅自己可见")])],1),e._v(" "),o("Radio",{attrs:{label:2}},[o("Icon",{attrs:{type:"contrast",size:20}}),e._v(" "),o("span",[e._v("内部")]),e._v(" "),o("span",{staticStyle:{color:"#737373","padding-left":"20px"}},[e._v("项目可以被同组成员看到")])],1),e._v(" "),o("Radio",{attrs:{label:3}},[o("Icon",{attrs:{type:"ios-world",size:20}}),e._v(" "),o("span",[e._v("公开")]),e._v(" "),o("span",{staticStyle:{color:"#737373","padding-left":"20px"}},[e._v("项目对所有人员可见")])],1)],1)],1)],1)],1)],1),e._v(" "),o("Button",{staticStyle:{width:"80px",height:"30px"},attrs:{type:"success",shape:"circle"},on:{click:function(t){e.updateProject("projectCreate")}}},[e._v("保存")]),e._v(" "),e.userInfo.id===e.project.PBCreator?o("div",[o("Alert",{staticStyle:{"margin-top":"50px"},attrs:{type:"error","show-icon":""}},[e._v("删除项目将会删除所有与项目相关的内容，版本，提测等都会被删除.\n      删除项目是不可恢复操作，请谨慎操作。")]),e._v(" "),o("Button",{staticStyle:{width:"80px",height:"30px"},attrs:{type:"error",shape:"circle"},on:{click:e.deleteProject}},[e._v("删除")])],1):e._e()],1)},staticRenderFns:[]};var p=o("VU/8")(c,l,!1,function(e){o("7oIw")},"data-v-a9654940",null).exports,d=o("Gu7T"),u=o.n(d),m={name:"ProjectMember",props:["memberList","projectID"],data:function(){return{projectRoleList:[],members:[],userKeys:[],importProject:0,targetUserKeys:[],allMyProject:[]}},computed:r()({},Object(a.c)(["appBodyHeight","userInfo"]),Object(a.c)("projectglobal",["createDialogShow"]),{containerHeight:function(){return this.appBodyHeight-110},projectPermision:function(){for(var e=0,t=0;t<this.members.length;t++)if(this.members[t].PMMember===parseInt(this.userInfo.id)){e=this.members[t].PMRoleID;break}return e}}),methods:r()({},Object(a.d)("projectglobal",["setCreateDocumentType","setCreateDialogShow","setProjectRole"]),{getProjectRoles:function(){var e=this;this.$axios.get("/api/project/0/project_roles").then(function(t){e.projectRoleList=t.data.result},function(e){})},setMemberRole:function(e){for(var t=this,o=e.split(":"),s=parseInt(o[3]),r=0;r<this.members.length;r++)this.members[r].id===s&&(this.members[r].PMRoldID=parseInt(o[0]),this.members[r].role_name=o[1],this.members[r].role_color=o[2]);var a={PMRoleID:parseInt(o[0])};this.$axios.patch("/api/project/project_member/"+s+"/",a).then(function(e){t.$Message.success({content:"成员角色设置成功",duration:10,closable:!0})},function(e){t.$Message.error({content:"成员角色设置失败",duration:10,closable:!0})})},deleteMember:function(e){var t=this,o=e.split(":");this.$Modal.confirm({title:"删除确认",content:"您即将删除项目成员["+o[1]+"]",onOk:function(){for(var e=0;e<t.members.length;e++)if(t.members[e].id===parseInt(o[0])){t.members.splice(e,1);break}for(var s=0;s<t.targetUserKeys.length;s++)if(t.targetUserKeys[s]===parseInt(o[0])){t.targetUserKeys.splice(s,1);break}t.$axios.delete("/api/project/project_member/"+o[0]+"/").then(function(e){t.$Message.success({content:"成员已经成功移除",duration:10,closable:!0})},function(e){t.$Message.error({content:"移除成员失败",duration:10,closable:!0})})},onCancel:function(){}})},onModalStatusChange:function(e){this.initTargetKeys()},cancel:function(){this.setCreateDialogShow(!1)},onSelectSourceProject:function(e){for(var t=0;t<this.allMyProject.length;t++)if(this.allMyProject[t].id===e)for(var o=0;o<this.allMyProject[t].Members.length;o++)this.targetUserKeys.push(this.allMyProject[t].Members[o].PMMember)},switchTab:function(){this.targetUserKeys=[]},addMember:function(){var e=this,t={userID:this.targetUserKeys};this.$axios.post("/api/project/"+this.projectID+"/project_members",t).then(function(t){var o;(o=e.members).push.apply(o,u()(t.data.result)),e.$Message.success({content:"成员添加成功",duration:10,closable:!0})},function(t){e.$Message.error({content:"成员添加失败",duration:10,closable:!0})}),this.setCreateDialogShow(!1)},moveMember:function(e){this.targetUserKeys=e},filterMethod:function(e,t){return e.label.indexOf(t)>-1},getUserList:function(){var e=this;this.$axios.get("/api/common/users/list").then(function(t){for(var o=t.data.result,s=0;s<o.length;s++)e.userKeys.push({key:o[s].id,label:o[s].last_name+o[s].first_name,description:o[s].email})},function(e){})},initTargetKeys:function(){try{for(var e=0;e<this.members.length;e++)this.targetUserKeys.push(this.members[e].PMMember)}catch(e){console.log("init targetUserKey fail")}},loadProjectInfo:function(){var e=this;this.$axios.get("/api/project/list?extinfo=1&home=1").then(function(t){var o=t.data.result;e.allMyProject=o},function(e){})}}),created:function(){this.members=this.memberList,this.getProjectRoles(),this.getUserList(),this.loadProjectInfo()},mounted:function(){},watch:{memberList:function(){this.members=this.memberList}},components:{labelEditorInput:n.a}},h={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticStyle:{"padding-top":"16px"}},[e._l(e.members,function(t){return o("Card",{key:t.id,staticClass:"member-card cursor-hand",attrs:{bordered:!1,"dis-hover":""}},[o("Row",[o("i-col",{attrs:{xl:16,lg:16,md:16,sm:16}},[o("span",{staticStyle:{"font-weight":"bold"}},[o("img",{staticClass:"member-avatar",attrs:{src:t.avatar}}),e._v(" "),o("span",[e._v(e._s(t.name))]),e._v(" "),e.userInfo.id===t.PMMember?o("span",{staticStyle:{"margin-left":"15px"}},[o("Tag",{staticClass:"member-tag",attrs:{color:"success"}},[e._v("It's you!")])],1):e._e()])]),e._v(" "),o("i-col",{attrs:{xl:4,lg:4,md:4,sm:4}},[o("span",{staticStyle:{"margin-left":"15px"}},[o("span",{staticStyle:{width:"60px",display:"inline-block"}},[o("Tag",{staticClass:"member-tag",attrs:{color:t.role_color}},[e._v(e._s(t.role_name))])],1),e._v(" "),e.projectPermision>3?o("Dropdown",{attrs:{transfer:""},on:{"on-click":e.setMemberRole}},[o("a",{staticStyle:{color:"inherit"},attrs:{href:"javascript:void(0)"}},[o("span",[o("Icon",{attrs:{type:"ios-settings-outline"}})],1)]),e._v(" "),o("DropdownMenu",{attrs:{slot:"list"},slot:"list"},e._l(e.projectRoleList,function(s){return o("DropdownItem",{key:s.id,attrs:{name:s.id+":"+s.PRName+":"+s.PRColor+":"+t.id}},[o("span",[o("Tag",{staticClass:"member-tag",attrs:{color:s.PRColor}},[e._v(e._s(s.PRName))])],1)])}))],1):e._e()],1)]),e._v(" "),o("i-col",{attrs:{xl:4,lg:4,md:4,sm:4}},[e.projectPermision>3?o("span",[o("Dropdown",{attrs:{transfer:""},on:{"on-click":e.deleteMember}},[o("a",{staticStyle:{color:"inherit"},attrs:{href:"javascript:void(0)"}},[o("span",[o("Icon",{attrs:{size:24,type:"ios-more"}})],1)]),e._v(" "),o("DropdownMenu",{attrs:{slot:"list"},slot:"list"},[o("DropdownItem",{attrs:{name:t.id+":"+t.name}},[o("Icon",{attrs:{type:"ios-trash-outline"}}),e._v(" "),o("span",[e._v("删除")])],1)],1)],1)],1):e._e()])],1)],1)}),e._v(" "),o("Modal",{attrs:{value:e.createDialogShow,title:"添加成员",width:600,styles:{bottom:"20px",top:"50px"}},on:{"on-visible-change":e.onModalStatusChange,"on-cancel":e.cancel}},[o("Tabs",{attrs:{value:"name1"},on:{"on-click":e.switchTab}},[o("TabPane",{attrs:{label:"添加",name:"name1"}},[o("Transfer",{attrs:{data:e.userKeys,"target-keys":e.targetUserKeys,filterable:"","filter-method":e.filterMethod},on:{"on-change":e.moveMember}})],1),e._v(" "),o("TabPane",{attrs:{label:"导入",name:"name2"}},[o("span",[e._v("源项目: ")]),e._v(" "),o("Select",{staticStyle:{width:"200px"},on:{"on-change":e.onSelectSourceProject},model:{value:e.importProject,callback:function(t){e.importProject=t},expression:"importProject"}},e._l(e.allMyProject,function(t){return o("Option",{key:t.id,attrs:{value:t.id}},[e._v(e._s(t.PBTitle))])}))],1)],1),e._v(" "),o("div",{attrs:{slot:"footer"},slot:"footer"},[o("Button",{staticStyle:{width:"80px",height:"30px"},attrs:{type:"success",shape:"circle"},on:{click:e.addMember}},[e._v("添加\n      ")]),e._v(" "),o("Button",{staticStyle:{width:"80px",height:"30px"},attrs:{type:"default",shape:"circle"},on:{click:e.cancel}},[e._v("取消")])],1)],1)],2)},staticRenderFns:[]};var f=o("VU/8")(m,h,!1,function(e){o("Zyx8")},"data-v-7539df0a",null).exports,v=o("YRzF"),g={VVersion:[{type:"string",required:!0,min:1,max:20,message:"标题长度必须在1-20个字符之间！",trigger:"blur"}],VStartDate:[{type:"date",required:!0,message:"请输入里程碑开始日期"}],VReleaseDate:[{type:"date",required:!0,message:"请输入里程碑结束日期"}]},b={name:"ProjectMileStone",props:["versionList","projectID"],data:function(){return{versions:[],sopen:!1,ropen:!1,selectVersion:0,startDate:"",releaseDate:"",formItem:{VProjectID:0,VVersion:"",VStartDate:"",VReleaseDate:""},ruleCustom:r()({},g)}},computed:r()({},Object(a.c)(["appBodyHeight","userInfo"]),Object(a.c)("projectglobal",["rightSidePanelShow","createDialogShow"]),{containerHeight:function(){return this.appBodyHeight},versionStatusColor:function(){return"#19be6b"}}),methods:r()({},Object(a.d)("projectglobal",["setCreateDialogShow"]),{addVersion:function(e){var t=this;this.$refs[e].validate(function(e){e&&(t.formItem.VProjectID=t.projectID,t.formItem.VStartDate=t.formatDate(t.formItem.VStartDate),t.formItem.VReleaseDate=t.formatDate(t.formItem.VReleaseDate),t.$axios.post("/api/project/"+t.projectID+"/versions/",t.formItem).then(function(e){t.versions.push(e.data.result.all_versions),t.$Message.success({content:"版本添加成功",duration:10,closable:!0}),t.setCreateDialogShow(!1)},function(e){t.$Message.success({content:"版本添加失败",duration:10,closable:!0})}))})},formatDate:function(e){var t=new Date(e);return t.getFullYear()+"-"+(t.getMonth()+1)+"-"+t.getDate()},updateVersionTitle:function(e,t){var o=this,s={VVersion:e};""!==e&&this.$axios.patch("/api/project/project_version/"+t+"/",s).then(function(e){for(var t=0;t<o.versions.length;t++)if(o.versions[t].id===parseInt(o.selectVersion)){o.versions.splice(t,1,e.data.result);break}o.$Message.success({content:"版本标题更新成功",duration:10,closable:!0})},function(e){o.$Message.success({content:"版本标题更新失败",duration:10,closable:!0})})},cancel:function(){this.setCreateDialogShow(!1)},versionOperation:function(e){var t=e.split(":");"3"===t[0]&&this.deleteVersion(e),"2"===t[0]&&this.filedVersion(e,!0),"4"===t[0]&&this.filedVersion(e,!1)},deleteVersion:function(e){var t=this,o=e.split(":");this.$Modal.confirm({title:"删除确认",content:"您即将删除项目版本["+o[2]+"]",onOk:function(){t.$axios.delete("/api/project/project_version/"+o[1]+"/").then(function(e){for(var s=0;s<t.versions.length;s++)if(t.versions[s].id===parseInt(o[1])){t.versions.splice(s,1);break}t.$Message.success({content:"版本删除成功",duration:10,closable:!0})},function(e){t.$Message.error({content:"版本删除失败",duration:10,closable:!0})})},onCancel:function(){}})},filedVersion:function(e,t){var o=this,s={VersionFiled:t},r=e.split(":");this.$axios.patch("/api/project/project_version/"+r[1]+"/",s).then(function(e){for(var s=0;s<o.versions.length;s++)if(o.versions[s].id===parseInt(r[1])){o.versions[s].VersionFiled=t;break}o.$Message.success({content:"版本"+r[2]+"归档成功",duration:10,closable:!0})},function(e){o.$Message.error({content:"版本"+r[2]+"归档失败",duration:10,closable:!0})})},handleSClick:function(e){this.selectVersion=e,this.sopen=!this.sopen},handleSChange:function(e){this.startDate=e},handleSOk:function(){var e=this,t={VStartDate:this.startDate};""!==this.startDate&&this.$axios.patch("/api/project/project_version/"+this.selectVersion+"/",t).then(function(t){for(var o=0;o<e.versions.length;o++)if(e.versions[o].id===parseInt(e.selectVersion)){e.versions.splice(o,1,t.data.result);break}e.$Message.success({content:"开始日期更新成功",duration:10,closable:!0})},function(t){e.$Message.success({content:"开始日期更新失败",duration:10,closable:!0})}),this.sopen=!1},handleRClick:function(e){this.selectVersion=e,this.ropen=!this.ropen},handleRChange:function(e){this.releaseDate=e},handleROk:function(){var e=this,t={VReleaseDate:this.releaseDate};""!==this.releaseDate&&this.$axios.patch("/api/project/project_version/"+this.selectVersion+"/",t).then(function(t){for(var o=0;o<e.versions.length;o++)if(e.versions[o].id===parseInt(e.selectVersion)){e.versions.splice(o,1,t.data.result);break}e.$Message.success({content:"发布日期更新成功",duration:10,closable:!0})},function(t){e.$Message.success({content:"发布日期更新失败",duration:10,closable:!0})}),this.ropen=!1}}),created:function(){this.versions=this.versionList},mounted:function(){},watch:{versionList:function(){this.versions=this.versionList}},components:{ICol:v.a,labelEditorInput:n.a}},j={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticStyle:{"padding-top":"16px"}},[e._l(e.versions,function(t){return t.VersionFiled?e._e():o("Card",{key:t.id,staticClass:"version-card cursor-hand",attrs:{bordered:!1,"dis-hover":""}},[o("Row",[o("i-col",{attrs:{xl:10,lg:10,md:12,sm:12}},[o("div",{staticStyle:{"font-weight":"bold"}},[o("label-editor-input",{attrs:{placeHolder:"版本标题",id:t.id,displayText:t.VVersion},on:{updateValue:e.updateVersionTitle}})],1)]),e._v(" "),o("i-col",{attrs:{xl:10,lg:10,md:8,sm:8}},[o("span",{staticStyle:{color:"#757575","padding-right":"50px"}},[o("DatePicker",{attrs:{open:e.sopen&&t.id===e.selectVersion,value:e.startDate,confirm:"",type:"date"},on:{"on-change":e.handleSChange,"on-ok":e.handleSOk}},[o("a",{attrs:{href:"javascript:void(0)"},on:{click:function(o){e.handleSClick(t.id)}}},[e._v("\n              开始日期:\n            "),o("Icon",{attrs:{type:"ios-calendar-outline"}}),e._v(" "),[e._v(" "+e._s(t.VStartDate))]],2)])],1),e._v(" "),o("span",{staticStyle:{color:"#757575"}},[o("DatePicker",{attrs:{open:e.ropen&&t.id===e.selectVersion,value:e.releaseDate,confirm:"",type:"date"},on:{"on-change":e.handleRChange,"on-ok":e.handleROk}},[o("a",{attrs:{href:"javascript:void(0)"},on:{click:function(o){e.handleRClick(t.id)}}},[e._v("\n              结束日期:\n            "),o("Icon",{attrs:{type:"ios-calendar-outline"}}),e._v(" "),[e._v(" "+e._s(t.VReleaseDate))]],2)])],1)]),e._v(" "),o("i-col",{attrs:{xl:4,lg:4,md:4,sm:4}},[o("span",[o("Dropdown",{attrs:{transfer:""},on:{"on-click":e.versionOperation}},[o("a",{staticStyle:{color:"inherit"},attrs:{href:"javascript:void(0)"}},[o("span",[o("Icon",{attrs:{size:24,type:"ios-more"}})],1)]),e._v(" "),o("DropdownMenu",{attrs:{slot:"list"},slot:"list"},[o("DropdownItem",{attrs:{name:"2:"+t.id+":"+t.VVersion}},[o("Icon",{attrs:{type:"ios-paw"}}),e._v(" "),o("span",[e._v("归档")])],1),e._v(" "),o("DropdownItem",{attrs:{name:"3:"+t.id+":"+t.VVersion}},[o("Icon",{attrs:{type:"ios-trash-outline"}}),e._v(" "),o("span",[e._v("删除")])],1)],1)],1)],1)])],1)],1)}),e._v(" "),e._l(e.versions,function(t){return t.VersionFiled?o("Card",{key:t.id,staticClass:"version-filed-card cursor-hand",attrs:{bordered:!1,"dis-hover":""}},[o("Row",[o("i-col",{staticStyle:{width:"30px"},attrs:{xl:1,lg:1,md:2,sm:2}},[o("div",[o("Tooltip",{attrs:{content:"已归档",transfer:""}},[o("Icon",{attrs:{type:"ios-folder-outline"}})],1)],1)]),e._v(" "),o("i-col",{attrs:{xl:9,lg:9,md:10,sm:10}},[o("div",{staticStyle:{"font-weight":"bold"}},[o("label-editor-input",{attrs:{placeHolder:"版本标题",id:t.id,displayText:t.VVersion},on:{updateValue:e.updateVersionTitle}})],1)]),e._v(" "),o("i-col",{attrs:{xl:10,lg:10,md:8,sm:8}},[o("span",{staticStyle:{color:"#757575","padding-right":"50px"}},[o("DatePicker",{attrs:{open:e.sopen&&t.id===e.selectVersion,value:e.startDate,confirm:"",type:"date"},on:{"on-change":e.handleSChange,"on-ok":e.handleSOk}},[o("a",{attrs:{href:"javascript:void(0)"},on:{click:function(o){e.handleSClick(t.id)}}},[e._v("\n              开始日期:\n            "),o("Icon",{attrs:{type:"ios-calendar-outline"}}),e._v(" "),[e._v(" "+e._s(t.VStartDate))]],2)])],1),e._v(" "),o("span",{staticStyle:{color:"#757575"}},[o("DatePicker",{attrs:{open:e.ropen&&t.id===e.selectVersion,value:e.releaseDate,confirm:"",type:"date"},on:{"on-change":e.handleRChange,"on-ok":e.handleROk}},[o("a",{attrs:{href:"javascript:void(0)"},on:{click:function(o){e.handleRClick(t.id)}}},[e._v("\n              结束日期:\n            "),o("Icon",{attrs:{type:"ios-calendar-outline"}}),e._v(" "),[e._v(" "+e._s(t.VReleaseDate))]],2)])],1)]),e._v(" "),o("i-col",{attrs:{xl:4,lg:4,md:4,sm:4}},[o("span",[o("Dropdown",{attrs:{transfer:""},on:{"on-click":e.versionOperation}},[o("a",{staticStyle:{color:"inherit"},attrs:{href:"javascript:void(0)"}},[o("span",[o("Icon",{attrs:{size:24,type:"ios-more"}})],1)]),e._v(" "),o("DropdownMenu",{attrs:{slot:"list"},slot:"list"},[o("DropdownItem",{attrs:{name:"4:"+t.id+":"+t.VVersion}},[o("Icon",{attrs:{type:"ios-paw"}}),e._v(" "),o("span",[e._v("恢复版本")])],1),e._v(" "),o("DropdownItem",{attrs:{name:"3:"+t.id+":"+t.VVersion}},[o("Icon",{attrs:{type:"ios-trash-outline"}}),e._v(" "),o("span",[e._v("删除")])],1)],1)],1)],1)])],1)],1):e._e()}),e._v(" "),o("Modal",{attrs:{value:e.createDialogShow,title:"添加版本",width:600,styles:{bottom:"20px",top:"50px"}},on:{"on-cancel":e.cancel}},[o("div",[o("Form",{ref:"createVersion",attrs:{model:e.formItem,"label-width":80,rules:e.ruleCustom}},[o("FormItem",{attrs:{label:"标题",prop:"VVersion"}},[o("Input",{attrs:{placeholder:"版本规划标题"},model:{value:e.formItem.VVersion,callback:function(t){e.$set(e.formItem,"VVersion",t)},expression:"formItem.VVersion"}})],1),e._v(" "),o("FormItem",{attrs:{label:"开始时间",prop:"VStartDate"}},[o("DatePicker",{attrs:{type:"date",placeholder:"默认T+1完成",format:"yyyy-MM-dd"},model:{value:e.formItem.VStartDate,callback:function(t){e.$set(e.formItem,"VStartDate",t)},expression:"formItem.VStartDate"}})],1),e._v(" "),o("FormItem",{attrs:{label:"发布时间",prop:"VReleaseDate"}},[o("DatePicker",{attrs:{type:"date",placeholder:"默认T+1完成",format:"yyyy-MM-dd"},model:{value:e.formItem.VReleaseDate,callback:function(t){e.$set(e.formItem,"VReleaseDate",t)},expression:"formItem.VReleaseDate"}})],1)],1)],1),e._v(" "),o("div",{attrs:{slot:"footer"},slot:"footer"},[o("Button",{staticStyle:{width:"80px",height:"30px"},attrs:{type:"success",shape:"circle"},on:{click:function(t){e.addVersion("createVersion")}}},[e._v("添加\n      ")]),e._v(" "),o("Button",{staticStyle:{width:"80px",height:"30px"},attrs:{type:"default",shape:"circle"},on:{click:e.cancel}},[e._v("取消")])],1)])],2)},staticRenderFns:[]};var _=o("VU/8")(b,j,!1,function(e){o("l5uE")},"data-v-db78ba40",null).exports,y={name:"ProjectModule",props:["moduleList","projectID"],data:function(){return{modules:[],formData:{ProjectID:0,Name:""}}},computed:r()({},Object(a.c)(["appBodyHeight","userInfo"]),Object(a.c)("projectglobal",["createDocumentType"]),Object(a.c)("document",["breadNav"]),{containerHeight:function(){return this.appBodyHeight}}),methods:r()({},Object(a.d)("projectglobal",["setCreateDocumentType","setCreateDialogShow"]),{updateModuleTitle:function(e,t){var o=this,s={Name:e};""!==e&&this.$axios.patch("/api/project/project_module/"+t+"/",s).then(function(e){for(var s=0;s<o.modules.length;s++)if(o.modules[s].id===parseInt(t)){o.modules.splice(s,1,e.data.result);break}o.$Message.success({content:"模块标题更新成功",duration:10,closable:!0})},function(e){o.$Message.success({content:"模块标题更新失败",duration:10,closable:!0})})},createModule:function(){var e=this;this.formData.ProjectID=this.projectID,""!==this.formData.Name.trim()&&this.$axios.post("/api/project/"+this.projectID+"/modules",this.formData).then(function(t){e.modules.push(t.data.result),e.$Message.success({content:"模块添加成功",duration:10,closable:!0}),e.formData.Name="",e.setCreateDialogShow(!1)},function(t){e.$Message.error({content:"模块添加失败",duration:10,closable:!0})})},deleteModule:function(e){var t=this,o=e.split(":");this.$Modal.confirm({title:"删除确认",content:"您即将删除项目模块["+o[1]+"]",onOk:function(){t.$axios.delete("/api/project/project_module/"+o[0]+"/").then(function(e){for(var s=0;s<t.modules.length;s++)if(t.modules[s].id===parseInt(o[0])){t.modules.splice(s,1);break}t.$Message.success({content:"模块删除成功",duration:10,closable:!0})},function(e){t.$Message.error({content:"模块删除失败",duration:10,closable:!0})})},onCancel:function(){}})}}),created:function(){this.modules=this.moduleList},mounted:function(){},watch:{moduleList:function(){this.modules=this.moduleList}},components:{labelEditorInput:n.a}},I={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticStyle:{"padding-top":"16px"}},[o("div",{staticStyle:{width:"60%","margin-left":"auto","margin-right":"auto","margin-bottom":"16px"}},[o("Input",{staticStyle:{width:"100%"},attrs:{search:"","enter-button":"添加",icon:"ios-clock-outline",maxlength:50,placeholder:"输入模块名称，回车创建模块"},on:{"on-search":e.createModule},model:{value:e.formData.Name,callback:function(t){e.$set(e.formData,"Name",t)},expression:"formData.Name"}})],1),e._v(" "),e._l(e.moduleList,function(t){return o("Card",{key:t.id,staticClass:"member-card cursor-hand",attrs:{padding:10,bordered:!1,"dis-hover":""}},[o("Row",[o("i-col",{attrs:{xl:20,lg:20,md:18,sm:18}},[o("span",{staticStyle:{"font-weight":"bold"}},[o("label-editor-input",{staticStyle:{"max-width":"400px"},attrs:{placeHolder:"模块名称",id:t.id,displayText:t.Name},on:{updateValue:e.updateModuleTitle}})],1)]),e._v(" "),o("i-col",{attrs:{xl:4,lg:4,md:6,sm:6}},[o("span",[o("Dropdown",{attrs:{transfer:""},on:{"on-click":e.deleteModule}},[o("a",{staticStyle:{color:"inherit"},attrs:{href:"javascript:void(0)"}},[o("span",[o("Icon",{attrs:{size:24,type:"ios-more"}})],1)]),e._v(" "),o("DropdownMenu",{attrs:{slot:"list"},slot:"list"},[o("DropdownItem",{attrs:{name:t.id+":"+t.Name}},[o("Icon",{attrs:{type:"ios-trash-outline"}}),e._v(" "),o("span",[e._v("删除")])],1)],1)],1)],1)])],1)],1)})],2)},staticRenderFns:[]};var D=o("VU/8")(y,I,!1,function(e){o("F5JC")},"data-v-69a2b201",null).exports,V={name:"ProjectSettings",props:["projectID","page"],data:function(){return{projectInfo:{}}},computed:r()({},Object(a.c)(["appBodyHeight","userInfo"]),Object(a.c)("projectglobal",["createDocumentType"]),{containerHeight:function(){return this.appBodyHeight},pageView:function(){return this.page.trim().toLowerCase()}}),methods:r()({},Object(a.d)("projectglobal",["setCreateDocumentType","setCreateDialogShow","setHeadMenu"]),{loadProject:function(){var e=this;this.$axios.get("/api/project/"+this.projectID+"/detail?extinfo=1").then(function(t){e.projectInfo=t.data.result,console.log(e.projectInfo)},function(e){})}}),created:function(){this.loadProject()},mounted:function(){},watch:{projectID:function(e){this.loadProject()}},components:{labelEditorInput:n.a,ProjectInfo:p,ProjectMember:f,ProjectModule:D,ProjectMileStone:_}},x={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{style:"overflow-y:auto;height:"+e.containerHeight+"px"},["info"===e.pageView?o("project-info",{attrs:{project:e.projectInfo}}):e._e(),e._v(" "),"member"===e.pageView?o("project-member",{attrs:{projectID:e.projectID,memberList:e.projectInfo.Members}}):e._e(),e._v(" "),"version"===e.pageView?o("project-mile-stone",{attrs:{projectID:e.projectID,versionList:e.projectInfo.Versions}}):e._e(),e._v(" "),"module"===e.pageView?o("project-module",{attrs:{projectID:e.projectID,moduleList:e.projectInfo.Modules}}):e._e()],1)},staticRenderFns:[]};var M=o("VU/8")(V,x,!1,function(e){o("bUJg")},"data-v-42ef6c12",null);t.default=M.exports},Zyx8:function(e,t){},bUJg:function(e,t){},cpf5:function(e,t,o){"use strict";o.d(t,"a",function(){return s});var s={PBTitle:[{type:"string",min:1,max:50,required:!0,message:"标题长度必须在1-50个字符！！"}],PBKey:[{type:"string",required:!0,min:1,max:10,pattern:/^[A-Z]+$/,message:"Key必须是10个以内的大写英文字符！",trigger:"blur"}],PBPlatform:[{type:"integer",required:!0,message:"请选择项目平台"}],PBLead:[{type:"integer",required:!0,message:"请选择项目负责人"}],Product:[{type:"integer",required:!0,message:"请选择产品线"}]}},l5uE:function(e,t){}});
//# sourceMappingURL=16.8006e83559e87f366e76.js.map
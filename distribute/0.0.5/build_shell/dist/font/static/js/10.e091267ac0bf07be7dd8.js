webpackJsonp([10],{"2qUE":function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,a=o("LJth"),r=(n=a)&&n.__esModule?n:{default:n};t.default={name:"kendo-spreadsheet",mixins:[r.default]}},BiHh:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=o("Dd8w"),a=o.n(n),r=o("NYxO"),i=o("aRfI"),s={name:"projectTaskList",props:["documentID","viewMode"],data:function(){return{excelDocument:null,lockByMe:!1,rowCount:500,rowHeight:35,columnCount:100,rows:[],columns:[],selectedRows:[],selectedRange:{},datasource:{transport:{read:function(e){},submit:function(e){console.log(e)}}}}},computed:a()({},Object(r.c)("document",["editDocument"]),Object(r.c)(["appBodyHeight","userInfo"]),{containerHeight:function(){return this.appBodyHeight},toolbar:function(){var e=this,t={type:"button",text:"保存",showText:"both",icon:"k-icon k-i-save",click:function(){var t=e.$refs.spreadsheet.kendoWidget().toJSON();e.saveDocument(e.excelDocument.id,kendo.stringify(t))}};return this.viewMode||(t={}),[t,"open","exportAs",["cut","copy","paste"],["bold","italic","underline"],"backgroundColor","textColor","borders","fontSize","fontFamily","alignment","textWrap",["formatDecreaseDecimal","formatIncreaseDecimal"],"format","merge","freeze","filter"]},rowCounts:function(){return this.rows.length+1}}),methods:a()({},Object(r.d)(["setAppHeadShow","setAppBodyTop","setAppBodyHeight"]),Object(r.d)("task",["setViewDialogShow","setTaskChange"]),{onChange:function(e){var t=this.$refs.spreadsheet.kendoWidget().toJSON();console.log(kendo.stringify(t))},onSelect:function(e){var t=this;console.log(e.range),this.selectedRange=e.range,e.range.forEachCell(function(e,o,n){t.selectedRows.push(e),t.$refs.spreadsheet.kendoWidget().activeSheet().rowHeight(200)})},saveDocument:function(e,t){var o=this,n={ExcelContent:t};this.$axios.patch("/api/project/document/"+e+"/",n).then(function(e){o.$Message.success({content:"文档内容已经成功保存",duration:30,closable:!0})},function(e){o.$Message.error({content:"文档内容保存失败，请注意备份文档",duration:30,closable:!0})})}}),created:function(){this.setAppHeadShow(!1),this.setAppBodyTop(0);var e=window.innerHeight;this.setAppBodyHeight(e)},mounted:function(){var e=this,t=this.$refs.spreadsheet.kendoWidget(),o=window.innerHeight;t.element.css("height",o+"px"),t.element.css("width","100%"),t.element.css("padding-left","2px"),t.resize(),this.$axios.get("/api/project/document/"+this.documentID).then(function(t){e.excelDocument=t.data.result;var o=e.$refs.spreadsheet.kendoWidget(),n=JSON.parse(e.excelDocument.ExcelContent);o.fromJSON(n)},function(e){})},destroyed:function(){},watch:{},components:{Spreadsheet:i.Spreadsheet,SpreadsheetSheet:i.SpreadsheetSheet,SpreadsheetInstaller:i.SpreadsheetInstaller}},d={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"vue-app",attrs:{id:"vueapp"}},[o("spreadsheet",{ref:"spreadsheet",attrs:{columns:100,rows:e.rowCount,"toolbar-home":e.toolbar,rowHeight:e.rowHeight,sheetsbar:!0},on:{changeFormat:e.onChange,change:e.onChange,select:e.onSelect}},[o("spreadsheet-sheet",{attrs:{name:"Sheet1","sheets-rows-cells-enable":!1,"data-source":e.datasource,rows:e.rows,columns:e.columns}})],1)],1)},staticRenderFns:[]};var l=o("VU/8")(s,d,!1,function(e){o("ZkUl"),o("G0fO")},null,null);t.default=l.exports},G0fO:function(e,t){},LJth:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=o("pweh"),a=u(o("t8LL")),r=u(o("tCTY")),i=u(o("u088")),s=u(o("f6ue")),d=u(o("POZh")),l=u(o("c30/"));function u(e){return e&&e.__esModule?e:{default:e}}t.default={template:"<div><slot></slot></div>",props:a.default,mixins:[n.KendoBaseComponent,n.KendoBaseDatasourceComponent,i.default,s.default,d.default,l.default],mounted:function(){this._resolveChildren(),kendo.jQuery(this.$el).kendoSpreadsheet(this.widgetOptions),this.$emit("kendowidgetready",this.kendoWidget())},methods:{kendoWidget:function(){return kendo.jQuery(this.$el).getKendoSpreadsheet()},_resolveChildren:function(){this.resolveChildren("sheets",r.default.name)}}}},POZh:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={props:{pdfArea:{type:String,kComposite:"pdf.area"},pdfAuthor:{type:String,kComposite:"pdf.author"},pdfCreator:{type:String,kComposite:"pdf.creator"},pdfDate:{type:Date,kComposite:"pdf.date"},pdfFileName:{type:String,kComposite:"pdf.fileName"},pdfFitWidth:{type:Boolean,kComposite:"pdf.fitWidth"},pdfForceProxy:{type:Boolean,kComposite:"pdf.forceProxy"},pdfGuidelines:{type:Boolean,kComposite:"pdf.guidelines"},pdfHCenter:{type:Boolean,kComposite:"pdf.hCenter"},pdfKeywords:{type:String,kComposite:"pdf.keywords"},pdfLandscape:{type:Boolean,kComposite:"pdf.landscape"},pdfMarginBottom:{type:Number|String,kComposite:"pdf.margin.bottom"},pdfMarginLeft:{type:Number|String,kComposite:"pdf.margin.left"},pdfMarginRight:{type:Number|String,kComposite:"pdf.margin.right"},pdfMarginTop:{type:Number|String,kComposite:"pdf.margin.top"},pdfPaperSize:{type:String|Array,kComposite:"pdf.paperSize"},pdfProxyURL:{type:String,kComposite:"pdf.proxyURL"},pdfProxyTarget:{type:String,kComposite:"pdf.proxyTarget"},pdfSubject:{type:String,kComposite:"pdf.subject"},pdfTitle:{type:String,kComposite:"pdf.title"},pdfVCenter:{type:Boolean,kComposite:"pdf.vCenter"}}}},ZkUl:function(e,t){},aRfI:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SpreadsheetInstaller=t.KendoSpreadsheetInstaller=t.SpreadsheetSheet=t.KendoSpreadsheetSheet=t.Spreadsheet=t.KendoSpreadsheet=void 0;var n=i(o("2qUE")),a=i(o("tCTY")),r=i(o("sp+x"));function i(e){return e&&e.__esModule?e:{default:e}}t.KendoSpreadsheet=n.default,t.Spreadsheet=n.default,t.KendoSpreadsheetSheet=a.default,t.SpreadsheetSheet=a.default,t.KendoSpreadsheetInstaller=r.default,t.SpreadsheetInstaller=r.default},"c30/":function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={props:{toolbarHome:{type:Boolean|Array,kComposite:"toolbar.home"},toolbarInsert:{type:Boolean|Array,kComposite:"toolbar.insert"},toolbarData:{type:Boolean|Array,kComposite:"toolbar.data"}}}},f6ue:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={props:{excelFileName:{type:String,kComposite:"excel.fileName"},excelForceProxy:{type:Boolean,kComposite:"excel.forceProxy"},excelProxyURL:{type:String,kComposite:"excel.proxyURL"}}}},jDDO:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={methods:{resolveInnerTags:function(e){var t=[],o=!0,n=!1,a=void 0;try{for(var r,i=this.$slots.default[Symbol.iterator]();!(o=(r=i.next()).done);o=!0){var s=r.value;if(s.tag&&-1!==s.tag.indexOf(e)){var d=s.componentOptions,l=d.propsData;d.propsData.items||(l.items=s.componentInstance.subitems),t.push(l),this.handleWatcher(s.componentInstance)}}}catch(e){n=!0,a=e}finally{try{!o&&i.return&&i.return()}finally{if(n)throw a}}return t},handleWatcher:function(e){var t=this;e._isWatchAttached||(e.$watch("$props",function(){t.updateWidget?t.updateWidget():t._resolveInnerChildren&&t._resolveInnerChildren()},{deep:!0}),e._isWatchAttached=!0)}}}},mvJJ:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={template:"<div></div>",props:{dataSourceRef:String},methods:{findDataSource:function(){var e,t=!0,o=!1,n=void 0;try{for(var a,r=this.$children[Symbol.iterator]();!(t=(a=r.next()).done);t=!0){var i=a.value;if(this.$children.length&&i.kendoDataSource){e=i.kendoDataSource;break}}}catch(e){o=!0,n=e}finally{try{!t&&r.return&&r.return()}finally{if(o)throw n}}return e},setInnerDataSource:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"dataSourceRef",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"dataSource",o=arguments[2],n=this.findDataSource();if(n)o?o[t]=n:this.widgetOptions[t]=n;else{var a=o?o[e]:this[e],r=this.getParentsRef(a);r&&(this.attachEvents(r),o?o[t]=r.kendoDataSource:this.widgetOptions[t]=r.kendoDataSource)}},getParentsRef:function(e){for(var t=this.$parent;t&&!t.$refs[e];)t=t.$parent;return t?t.$refs[e]:void 0},setDataSource:function(e){var t=this.getParentsRef(e),o=this.kendoWidget();o.setDataSource&&t?o.setDataSource(t.kendoDataSource):o.setDataSource&&o.setDataSource(e)},attachEvents:function(e){e.kendoDataSource&&(e.kendoDataSource.bind("change",function(t){e.$emit("change",t)}),e.kendoDataSource.bind("error",function(t){e.$emit("error",t)}),e.kendoDataSource.bind("push",function(t){e.$emit("push",t)}),e.kendoDataSource.bind("requestEnd",function(t){e.$emit("requestend",t)}),e.kendoDataSource.bind("requestStart",function(t){e.$emit("requeststart",t)}),e.kendoDataSource.bind("sync",function(t){e.$emit("sync",t)}))}},mounted:function(){var e=this;e.$watch("dataSourceRef",function(t){e.setDataSource(t)}),e.$watch("dataSource",function(t){e.setDataSource(t)}),e.setInnerDataSource()}}},nP45:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={props:{activeCell:{type:String,kComposite:"activeCell"},name:{type:String,kComposite:"name"},columns:{type:Array,kComposite:"columns"},dataSource:{type:Object|Array,kComposite:"dataSource"},dataSourceRef:{type:String,kComposite:"dataSourceRef"},filterColumns:{type:Array,kComposite:"filter.columns"},filterRef:{type:String,kComposite:"filter.ref"},frozenColumns:{type:Number,kComposite:"frozenColumns"},frozenRows:{type:Number,kComposite:"frozenRows"},mergedCells:{type:Array,kComposite:"mergedCells"},rows:{type:Array,kComposite:"rows"},selection:{type:String,kComposite:"selection"},showGridLines:{type:Boolean,kComposite:"showGridLines"},sortColumns:{type:Array,kComposite:"sort.columns"},sortRef:{type:String,kComposite:"sort.ref"}}}},pweh:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.KendoSharedMethods=t.KendoBaseInputComponent=t.KendoBaseDatasourceComponent=t.KendoBaseComponent=void 0;var n=s(o("wO4K")),a=s(o("mvJJ")),r=s(o("wmkZ")),i=s(o("jDDO"));function s(e){return e&&e.__esModule?e:{default:e}}t.KendoBaseComponent=n.default,t.KendoBaseDatasourceComponent=a.default,t.KendoBaseInputComponent=r.default,t.KendoSharedMethods=i.default},"sp+x":function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),a=i(o("2qUE")),r=i(o("tCTY"));function i(e){return e&&e.__esModule?e:{default:e}}var s=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return n(e,null,[{key:"install",value:function(e){e.component(a.default.name,a.default),e.component(r.default.name,r.default)}}]),e}();t.default=s,"undefined"!=typeof window&&window.Vue&&window.Vue.use(s)},t8LL:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={activeSheet:String,columnWidth:Number,columns:Number,defaultCellStyle:Object,headerHeight:Number,headerWidth:Number,excel:Object,pdf:Object,rowHeight:Number,rows:Number,sheets:Array,sheetsbar:Boolean,toolbar:Boolean|Object,insertSheet:Function,removeSheet:Function,renameSheet:Function,selectSheet:Function,unhideColumn:Function,unhideRow:Function,hideColumn:Function,hideRow:Function,deleteColumn:Function,deleteRow:Function,insertColumn:Function,insertRow:Function,select:Function,changeFormat:Function,change:Function,render:Function,excelExport:Function,excelImport:Function,pdfExport:Function}},tCTY:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(o("nP45")),a=r(o("7+uW"));function r(e){return e&&e.__esModule?e:{default:e}}t.default={name:"kendo-spreadsheet-sheet",render:function(){return a.default.prototype._e},mixins:[n.default]}},u088:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={props:{defaultCellStyleBackground:{type:String,kComposite:"defaultCellStyle.background"},defaultCellStyleColor:{type:String,kComposite:"defaultCellStyle.color"},defaultCellStyleFontFamily:{type:String,kComposite:"defaultCellStyle.fontFamily"},defaultCellStyleFontSize:{type:String,kComposite:"defaultCellStyle.fontSize"},defaultCellStyleItalic:{type:Boolean,kComposite:"defaultCellStyle.Italic"},defaultCellStyleBold:{type:Boolean,kComposite:"defaultCellStyle.bold"},defaultCellStyleUnderline:{type:Boolean,kComposite:"defaultCellStyle.underline"},defaultCellStyleWrap:{type:Boolean,kComposite:"defaultCellStyle.wrap"}}}},wO4K:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r=o("7+uW"),i=(n=r)&&n.__esModule?n:{default:n};function s(e){if(Array.isArray(e)){for(var t=0,o=Array(e.length);t<e.length;t++)o[t]=e[t];return o}return Array.from(e)}t.default={template:"<div></div>",props:{disabled:Boolean,readonly:Boolean},created:function(){this.resolveWidgetOptions(),this.$_nativeTemplates=[],this.$on("kendowidgetready",this.ready)},beforeDestroy:function(){if(this.kendoWidget()&&this.kendoWidget().destroy&&(this.kendoWidget().destroy(),this.$_nativeTemplates.length))for(var e=0;e<this.$_nativeTemplates.length;e++)this.$_nativeTemplates[e].$destroy()},mounted:function(){for(var e in this.$el.classList.length>0?this.nativeClasses=[].concat(s(this.$el.classList)):this.nativeClasses=[],this.$options.propsData){var t=this;if(-1!==e.toLowerCase().indexOf("template"))this.widgetOptions[e]instanceof Function&&(this.widgetOptions[e]=this.transformTemplate(e));"value"===e?t.$watch(e,function(e){t.changeValue(e)}):"disabled"===e?t.$watch(e,function(e){t.makeDisabled(e)}):"readonly"===e?t.$watch(e,function(e){t.makeReadonly(e)}):t.$watch(e,function(e,o){JSON.stringify(o)!==JSON.stringify(e)&&t.updateWidget()})}},watch:{$attrs:function(){this.toggleClasses()}},methods:{toggleClasses:function(){var e=kendo.jQuery(this.$el),t=this.kendoWidget().wrapper;t&&t[0]!==e[0]&&(this.nativeClasses.forEach(function(e){t.removeClass(e)}),this.nativeClasses=[].concat(s(this.$el.classList)),this.nativeClasses.forEach(function(e){t.addClass(e)})),this.kendoClasses&&this.kendoClasses.forEach(function(t){e.addClass(t)})},updateWidget:function(){this.resolveWidgetOptions(),this._resolveChildren&&this._resolveChildren(),this.kendoWidget().setOptions&&this.kendoWidget().setOptions(this.widgetOptions)},transformTemplate:function(e,t){var o,n=this,a=t||n.$options.propsData[e];try{o=a.call(n,{})}catch(e){return a}return o.template?function(){o=a.apply(this,arguments);var e=new i.default(o.template);e.$data.templateArgs=o.templateArgs;var t="kendo"+kendo.guid();return n.$nextTick(function(){e.$mount("#"+t),n.$_nativeTemplates.push(e)}),'<div id="'+t+'"></div>'}:a},resolveChildren:function(e,t){if(!this.widgetOptions[e]&&this.$slots.default){var o=[],n=!0,a=!1,r=void 0;try{for(var i,s=this.$slots.default[Symbol.iterator]();!(n=(i=s.next()).done);n=!0){var d=i.value;if(d.tag&&-1!==d.tag.indexOf(t)){var l=this.parseOptions(d.componentInstance);l.dataSourceRef&&this.setInnerDataSource("dataSourceRef","dataSource",l),o.push(l),this.handleWatcher(d.componentInstance)}}}catch(e){a=!0,r=e}finally{try{!n&&s.return&&s.return()}finally{if(a)throw r}}o.length&&(this.widgetOptions[e]=o)}},handleWatcher:function(e){var t=this;e.stashedPropsData=JSON.stringify(e.$options.propsData),e._isWatchAttached||(e.$watch("$props",function(){var o=JSON.stringify(e.$options.propsData),n=e.stashedPropsData!==o;t.updateWidget&&n?t.updateWidget():t._resolveInnerChildren&&t._resolveInnerChildren(),e.stashedPropsData=o},{deep:!0}),e._isWatchAttached=!0)},makeDisabled:function(e){this.kendoWidget().enable&&this.kendoWidget().enable(!e)},makeReadonly:function(e){this.kendoWidget().readonly&&this.kendoWidget().readonly(e)},changeValue:function(e){this.kendoWidget().value&&this.kendoWidget().value(e)},resolveWidgetOptions:function(){this.widgetOptions=this.parseOptions()},parseOptions:function(e){var t=e||this,o={};for(var n in t.$options.propsData){var a=t.$options.props[n],r=t.$options.propsData[n],i=a.kComposite;i?this.addCompositeProperty(o,i.split("."),t.$props[n]):-1!==n.toLowerCase().indexOf("template")&&r instanceof Function?o[n]=this.transformTemplate(n,r):o[n]=r}return Object.keys(t.$props).forEach(function(e){var n;t.$listeners&&t.$listeners[e.toLowerCase()]&&(-1!==e.lastIndexOf("kendo")&&(n=e.replace("kendo","").toLowerCase()),o[n||e]=t.$listeners[e.toLowerCase()])}),o},addCompositeProperty:function(e,t,o){var n=t.pop(),r=t.reduce(function(e,t){return e[t]="object"===a(e[t])&&e[t]||{},e[t]},e);-1!==n.toLowerCase().indexOf("template")&&o instanceof Function?r[n]=this.transformTemplate(n,o):r[n]=o},ready:function(){var e=this;this.$el.classList.length>0&&(e.kendoClasses=[].concat(s(e.$el.classList)).filter(function(t){return e.nativeClasses.indexOf(t)<0})),e.$options.propsData.disabled&&e.makeDisabled(!0),e.$options.propsData.readonly&&e.makeReadonly(!0)}}}},wmkZ:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={template:'<input ref="valueInput" :value="value" />',model:{event:"changemodel"}}}});
//# sourceMappingURL=10.e091267ac0bf07be7dd8.js.map
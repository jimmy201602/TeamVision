webpackJsonp([17],{"/E0Z":function(t,e){},"7YkJ":function(t,e){},XCoK:function(t,e){},pIw3:function(t,e){},yfik:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=a("Dd8w"),o=a.n(r),i=a("YRzF"),s=a("aYpo"),n=(a("IcnI"),a("NYxO")),l=a("bOdI"),c=a.n(l),p={components:{VueEditor:s.VueEditor,ICol:i.a},name:"bvtReport",props:["projectID","fortestingID"],data:function(){var t;return t={projectMembers:[],newReport:!0,fortestingContent:[],defaultBTAttachments:[],editorToolBar:[["bold","italic","underline"],[{list:"ordered"},{list:"bullet"}],[{color:[]},{background:[]}]]},c()(t,"projectMembers",[]),c()(t,"reportData",{}),t},computed:o()({},Object(n.c)(["appBodyHeight","userInfo"]),{reportContainerHeight:function(){return this.appBodyHeight-33}}),methods:{loadProjectMembers:function(){var t=this;this.$axios.get("/api/project/"+this.projectID+"/project_members").then(function(e){t.projectMembers=e.data.result},function(t){})},sendReport:function(){var t=this;this.$Message.success({content:"报告发送中!",duration:10,closable:!0}),this.$axios.post("/api/project/report/bvt",this.reportData).then(function(e){t.$Message.success({content:"BVT报告已经发送!",duration:10,closable:!0})},function(e){t.$Message.warning({content:"除重点提示，抄送字段，其他字段均需要填写！",duration:10,closable:!0})})},loadForTesting:function(){var t=this;this.$axios.get("/api/project/fortesting/"+this.fortestingID).then(function(e){var a=e.data.result;if(t.newReport){t.reportData.ProjectInfo.Version=a.VersionName,t.reportData.ProjectInfo.Project=a.ProjectName,t.reportData.id=t.fortestingID,t.reportData.Topic=a.ProjectName+"--"+a.VersionName+"BVT通报--"+(new Date).toLocaleDateString(),t.reportData.FeatureProgress.BugSummary="见详情",t.reportData.FeatureProgress.Progress="100%";for(var r=0;r<a.FortestingFeature.length;r++){var o={};o.id=(new Date).getTime()+Math.random(),o.Content=a.FortestingFeature[r],o.Passed1=!1,o.Passed2=!1,o.Passed3=!1,t.reportData.FeatureProgress.Feature.push(o)}}else for(var i=0;i<t.reportData.FeatureProgress.Feature.length;i++)t.reportData.FeatureProgress.Feature[i].id=(new Date).getTime()+Math.random()},function(t){})},addNewFeature:function(){var t={};t.id=(new Date).getTime()+Math.random(),t.Content="",t.Passed1=!1,t.Passed2=!1,t.Passed3=!1,this.reportData.FeatureProgress.Feature.push(t)},handleSuccess:function(t,e,a){e.url=t.result.url,e.id=t.result.file_id;var r={};r.name=e.name,r.url=e.url,this.reportData.BugTrendAttachments.push(r)},handleRemove:function(t,e){for(var a=0;a<this.reportData.BugTrendAttachments.length;a++)this.reportData.BugTrendAttachments[a].url===t.url&&this.reportData.BugTrendAttachments.pop(this.reportData.BugTrendAttachments[a])},handleFormatError:function(t){this.$Message.warning({content:"文件格式不正确,格式：'jpg','jpeg','png'",duration:10,closable:!0})},handleMaxSize:function(t){this.$Message.warning({content:"文件大小超过10M限制",duration:10,closable:!0})},removeFeature:function(t){if(0!==t)for(var e=0;e<this.reportData.FeatureProgress.Feature.length;e++){if(this.reportData.FeatureProgress.Feature[e].id===t){this.reportData.FeatureProgress.Feature.splice(e,1);break}}},initReport:function(){null===this.reportData.FortestingID?(this.newReport=!0,this.reportData.FortestingID=this.fortestingID,this.reportData.ReportType=2,this.reportData.ProjectInfo.StartDate=(new Date).toLocaleDateString(),this.reportData.Recipients.push(this.userInfo.id),this.reportData.ProjectInfo.Tester=this.userInfo.last_name+this.userInfo.first_name):this.newReport=!1},loadReport:function(){var t=this;this.$axios.get("/api/project/fortesting/"+this.fortestingID+"/1").then(function(e){t.reportData=e.data.result,t.loadForTesting(),t.initReport()},function(t){})}},created:function(){this.loadProjectMembers(),this.loadReport()},watch:{}},d={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("Card",{staticStyle:{width:"100%","margin-left":"5px","background-color":"inherit"},attrs:{"dis-hover":!0}},[a("Row",[a("i-col",{staticStyle:{width:"80px","padding-top":"15px"},attrs:{span:4}},[a("div",{staticClass:"cursor-hand",staticStyle:{display:"inline-block"}},[a("span",{on:{click:t.sendReport}},[a("Avatar",{staticStyle:{height:"60px",width:"60px","background-color":"#fff",color:"#777777"},attrs:{shape:"square",size:"large"}},[a("Icon",{attrs:{type:"ios-send-outline"}}),t._v("\n      发送")],1)],1)]),t._v(" "),a("Divider",{staticStyle:{height:"100px"},attrs:{type:"vertical"}})],1),t._v(" "),a("i-col",{attrs:{span:20}},[a("div",{staticStyle:{display:"inline-block"}},[a("Row",{staticStyle:{padding:"5px"}},[a("i-col",{staticStyle:{"min-width":"700px"}},[a("span",{staticStyle:{width:"60px","padding-right":"10px",display:"inline-block"}},[t._v("收件人:")]),t._v(" "),a("Select",{attrs:{filterable:"",multiple:""},model:{value:t.reportData.Recipients,callback:function(e){t.$set(t.reportData,"Recipients",e)},expression:"reportData.Recipients"}},t._l(t.projectMembers,function(e){return a("Option",{key:e.id,attrs:{value:e.PMMember}},[t._v(t._s(e.name)+" ("+t._s(e.email)+")")])}))],1)],1),t._v(" "),a("Row",{staticStyle:{padding:"5px"}},[a("i-col",{staticStyle:{"min-width":"700px"}},[a("span",{staticStyle:{width:"60px","padding-right":"10px",display:"inline-block"}},[t._v("抄送:")]),t._v(" "),a("Input",{staticStyle:{width:"100%"},attrs:{placeholder:"输入邮箱，多人用逗号分隔"},model:{value:t.reportData.CCList,callback:function(e){t.$set(t.reportData,"CCList",e)},expression:"reportData.CCList"}})],1)],1),t._v(" "),a("Row",{staticStyle:{padding:"5px"}},[a("i-col",{attrs:{stype:"min-width: 700px;"}},[a("span",{staticStyle:{width:"60px","padding-right":"10px",display:"inline-block"}},[t._v("主题:")]),t._v(" "),a("Input",{staticStyle:{width:"100%"},attrs:{placeholder:"报告主题"},model:{value:t.reportData.Topic,callback:function(e){t.$set(t.reportData,"Topic",e)},expression:"reportData.Topic"}})],1)],1)],1)])],1)],1),t._v(" "),a("div",{staticStyle:{padding:"10px","padding-left":"100px"}},[a("div",[a("table",[a("tr",[a("td",{staticStyle:{width:"160px"}},[t._v("项目名称")]),t._v(" "),a("td",{staticStyle:{padding:"0px"}},[a("Input",{staticStyle:{width:"600px"},attrs:{placeholder:"提测项目信息"},model:{value:t.reportData.ProjectInfo.Project,callback:function(e){t.$set(t.reportData.ProjectInfo,"Project",e)},expression:"reportData.ProjectInfo.Project"}})],1)]),t._v(" "),a("tr",[a("td",[t._v("版本")]),t._v(" "),a("td",{staticStyle:{padding:"0px"}},[a("Input",{staticStyle:{width:"600px"},attrs:{placeholder:"提测版本"},model:{value:t.reportData.ProjectInfo.Version,callback:function(e){t.$set(t.reportData.ProjectInfo,"Version",e)},expression:"reportData.ProjectInfo.Version"}})],1)]),t._v(" "),a("tr",[a("td",[t._v("测试人员")]),t._v(" "),a("td",{staticStyle:{padding:"0px"}},[a("Input",{staticStyle:{width:"600px"},attrs:{placeholder:"测试人员，可多个"},model:{value:t.reportData.ProjectInfo.Tester,callback:function(e){t.$set(t.reportData.ProjectInfo,"Tester",e)},expression:"reportData.ProjectInfo.Tester"}})],1)]),t._v(" "),a("tr",[a("td",[t._v("开发人员")]),t._v(" "),a("td",{staticStyle:{padding:"0px"}},[a("Input",{staticStyle:{width:"600px"},attrs:{placeholder:"项目所有开发人员，前端，服务端，数据，客户端"},model:{value:t.reportData.ProjectInfo.Dev,callback:function(e){t.$set(t.reportData.ProjectInfo,"Dev",e)},expression:"reportData.ProjectInfo.Dev"}})],1)]),t._v(" "),a("tr",[a("td",[t._v("PM")]),t._v(" "),a("td",{staticStyle:{padding:"0px"}},[a("Input",{staticStyle:{width:"600px"},attrs:{placeholder:"产品，项目相关人员"},model:{value:t.reportData.ProjectInfo.PM,callback:function(e){t.$set(t.reportData.ProjectInfo,"PM",e)},expression:"reportData.ProjectInfo.PM"}})],1)]),t._v(" "),a("tr",[a("td",[t._v("测试开始日期")]),t._v(" "),a("td",{staticStyle:{padding:"0px"}},[a("Input",{staticStyle:{width:"600px"},attrs:{placeholder:"测试开始日期"},model:{value:t.reportData.ProjectInfo.StartDate,callback:function(e){t.$set(t.reportData.ProjectInfo,"StartDate",e)},expression:"reportData.ProjectInfo.StartDate"}})],1)])]),t._v(" "),a("div",{staticStyle:{width:"760px"}},[a("Divider",{attrs:{orientation:"center"}},[t._v("检查点")])],1),t._v(" "),a("table",[a("tr",[a("th",[t._v("检查点\n             "),a("span",{on:{click:t.addNewFeature}},[a("Icon",{staticClass:"cursor-hand",attrs:{type:"md-add-circle",size:16,color:"#32be77"}})],1)]),t._v(" "),a("th",[t._v("未通过")])]),t._l(t.reportData.FeatureProgress.Feature,function(e){return a("tr",{key:e.id},[a("td",{staticStyle:{padding:"0px"}},[a("Input",{staticStyle:{width:"600px"},attrs:{placeholder:"feature.Content"},model:{value:e.Content,callback:function(a){t.$set(e,"Content",a)},expression:"feature.Content"}})],1),t._v(" "),a("td",{staticStyle:{width:"160px"}},[a("Checkbox",{model:{value:e.Passed1,callback:function(a){t.$set(e,"Passed1",a)},expression:"feature.Passed1"}}),t._v(" "),a("span",{on:{click:function(a){t.removeFeature(e.id)}}},[a("Icon",{staticClass:"cursor-hand",attrs:{type:"md-close-circle",size:16,color:""}})],1)],1)])})],2),t._v(" "),a("div",{staticStyle:{width:"760px"}},[a("Divider",{staticStyle:{width:"760px"},attrs:{orientation:"center"}},[t._v("未通过情况描述")])],1),t._v(" "),a("div",[a("vue-editor",{staticStyle:{width:"760px"},attrs:{editorToolbar:t.editorToolBar,placeholder:"BVT未通过用例详细情况"},model:{value:t.reportData.BVTDetailResult,callback:function(e){t.$set(t.reportData,"BVTDetailResult",e)},expression:"reportData.BVTDetailResult"}})],1),t._v(" "),a("div",{staticStyle:{width:"760px"}},[a("Divider",{staticStyle:{width:"760px"},attrs:{orientation:"center"}},[t._v("结论")])],1),t._v(" "),a("div",[a("vue-editor",{staticStyle:{width:"760px"},attrs:{editorToolbar:t.editorToolBar,placeholder:"BVT测试结论，是否可继续测试"},model:{value:t.reportData.BVTVerdict,callback:function(e){t.$set(t.reportData,"BVTVerdict",e)},expression:"reportData.BVTVerdict"}})],1)])])],1)},staticRenderFns:[]};var u=a("VU/8")(p,d,!1,function(t){a("7YkJ")},"data-v-6d34f176",null).exports,h={components:{VueEditor:s.VueEditor,ICol:i.a},name:"progressReport",props:["projectID","fortestingID"],data:function(){return{projectMembers:[],newReport:!0,fortestingContent:[],defaultBTAttachments:[],editorToolBar:[["bold","italic","underline"],[{list:"ordered"},{list:"bullet"}],[{color:[]},{background:[]}]],reportData:{}}},computed:o()({},Object(n.c)(["appBodyHeight","userInfo"]),{reportContainerHeight:function(){return this.appBodyHeight-33}}),methods:{loadProjectMembers:function(){var t=this;this.$axios.get("/api/project/"+this.projectID+"/project_members").then(function(e){t.projectMembers=e.data.result},function(t){})},sendReport:function(){var t=this;console.log(this.reportData),this.$Message.success({content:"报告发送中!",duration:10,closable:!0}),this.$axios.post("/api/project/report/testprogress",this.reportData).then(function(e){t.$Message.success({content:"测试进度报告已经发送!",duration:10,closable:!0})},function(e){t.$Message.warning({content:"除重点提示，抄送字段，其他字段均需要填写！",duration:10,closable:!0})})},loadForTesting:function(){var t=this;this.$axios.get("/api/project/fortesting/"+this.fortestingID).then(function(e){var a=e.data.result;if(t.newReport){t.reportData.ProjectInfo.Version=a.VersionName,t.reportData.ProjectInfo.Project=a.ProjectName,t.reportData.id=t.fortestingID,t.reportData.Topic=a.ProjectName+"--"+a.VersionName+"测试进度通报--"+(new Date).toLocaleDateString();for(var r=0;r<a.FortestingFeature.length;r++){var o={};o.id=(new Date).getTime()+Math.random(),o.Content=a.FortestingFeature[r],o.Passed1=!1,o.Passed2=!1,o.Passed3=!1,t.reportData.FeatureProgress.Feature.push(o)}}else for(var i=0;i<t.reportData.FeatureProgress.Feature.length;i++)t.reportData.FeatureProgress.Feature[i].id=(new Date).getTime()+Math.random()},function(t){})},addNewFeature:function(){var t={};t.id=(new Date).getTime()+Math.random(),t.Content="",t.Passed1=!1,t.Passed2=!1,t.Passed3=!1,this.reportData.FeatureProgress.Feature.push(t)},handleSuccess:function(t,e,a){e.url=t.result.url,e.id=t.result.file_id;var r={};r.name=e.name,r.url=e.url,this.reportData.BugTrendAttachments.push(r)},handleRemove:function(t,e){for(var a=0;a<this.reportData.BugTrendAttachments.length;a++)this.reportData.BugTrendAttachments[a].url===t.url&&this.reportData.BugTrendAttachments.pop(this.reportData.BugTrendAttachments[a])},handleFormatError:function(t){this.$Message.warning({content:"文件格式不正确,格式：'jpg','jpeg','png'",duration:10,closable:!0})},handleMaxSize:function(t){this.$Message.warning({content:"文件大小超过10M限制",duration:10,closable:!0})},removeFeature:function(t){if(0!==t){console.log(t),console.log(this.reportData.FeatureProgress.Feature);for(var e=0;e<this.reportData.FeatureProgress.Feature.length;e++){if(this.reportData.FeatureProgress.Feature[e].id===t){this.reportData.FeatureProgress.Feature.splice(e,1);break}}}},initReport:function(){null===this.reportData.FortestingID?(this.newReport=!0,this.reportData.FortestingID=this.fortestingID,this.reportData.ReportType=2,this.reportData.ProjectInfo.StartDate=(new Date).toLocaleDateString(),this.reportData.Recipients.push(this.userInfo.id),this.reportData.ProjectInfo.Tester=this.userInfo.last_name+this.userInfo.first_name):this.newReport=!1},loadReport:function(){var t=this;this.$axios.get("/api/project/fortesting/"+this.fortestingID+"/2").then(function(e){t.reportData=e.data.result,t.loadForTesting(),t.initReport()},function(t){})}},created:function(){this.loadProjectMembers(),this.loadReport()},watch:{}},v={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{style:"overflow:scroll;height:"+t.reportContainerHeight+"px"},[a("Card",{staticStyle:{width:"100%","margin-left":"5px","background-color":"inherit"},attrs:{"dis-hover":!0}},[a("Row",[a("i-col",{staticStyle:{width:"80px","padding-top":"15px"},attrs:{span:4}},[a("div",{staticClass:"cursor-hand",staticStyle:{display:"inline-block"}},[a("span",{on:{click:t.sendReport}},[a("Avatar",{staticStyle:{height:"60px",width:"60px","background-color":"#fff",color:"#777777"},attrs:{shape:"square",size:"large"}},[a("Icon",{attrs:{type:"ios-send-outline"}}),t._v("\n             发送")],1)],1)]),t._v(" "),a("Divider",{staticStyle:{height:"100px"},attrs:{type:"vertical"}})],1),t._v(" "),a("i-col",{attrs:{span:20}},[a("div",{staticStyle:{display:"inline-block"}},[a("Row",{staticStyle:{padding:"5px"}},[a("i-col",{staticStyle:{"min-width":"700px"}},[a("span",{staticStyle:{width:"60px","padding-right":"10px",display:"inline-block"}},[t._v("收件人:")]),t._v(" "),a("Select",{attrs:{multiple:"",filterable:""},model:{value:t.reportData.Recipients,callback:function(e){t.$set(t.reportData,"Recipients",e)},expression:"reportData.Recipients"}},t._l(t.projectMembers,function(e){return a("Option",{key:e.PMMember,attrs:{value:e.PMMember}},[t._v(t._s(e.name)+" ("+t._s(e.email)+")\n                ")])}))],1)],1),t._v(" "),a("Row",{staticStyle:{padding:"5px"}},[a("i-col",{staticStyle:{"min-width":"700px"}},[a("span",{staticStyle:{width:"60px","padding-right":"10px",display:"inline-block"}},[t._v("抄送:")]),t._v(" "),a("Input",{staticStyle:{width:"100%"},attrs:{placeholder:"输入邮箱，多人用逗号分隔"},model:{value:t.reportData.CCList,callback:function(e){t.$set(t.reportData,"CCList",e)},expression:"reportData.CCList"}})],1)],1),t._v(" "),a("Row",{staticStyle:{padding:"5px"}},[a("i-col",{attrs:{stype:"min-width: 700px;"}},[a("span",{staticStyle:{width:"60px","padding-right":"10px",display:"inline-block"}},[t._v("主题:")]),t._v(" "),a("Input",{staticStyle:{width:"100%"},attrs:{placeholder:"报告主题"},model:{value:t.reportData.Topic,callback:function(e){t.$set(t.reportData,"Topic",e)},expression:"reportData.Topic"}})],1)],1)],1)])],1)],1),t._v(" "),a("div",{staticStyle:{padding:"10px","padding-left":"100px"}},[a("div",[a("table",[a("tr",[a("td",{staticStyle:{width:"160px"}},[t._v("项目名称")]),t._v(" "),a("td",{staticStyle:{padding:"0px"}},[a("Input",{staticStyle:{width:"600px"},attrs:{placeholder:"提测项目信息"},model:{value:t.reportData.ProjectInfo.Project,callback:function(e){t.$set(t.reportData.ProjectInfo,"Project",e)},expression:"reportData.ProjectInfo.Project"}})],1)]),t._v(" "),a("tr",[a("td",[t._v("版本")]),t._v(" "),a("td",{staticStyle:{padding:"0px"}},[a("Input",{staticStyle:{width:"600px"},attrs:{placeholder:"提测版本"},model:{value:t.reportData.ProjectInfo.Version,callback:function(e){t.$set(t.reportData.ProjectInfo,"Version",e)},expression:"reportData.ProjectInfo.Version"}})],1)]),t._v(" "),a("tr",[a("td",[t._v("测试人员")]),t._v(" "),a("td",{staticStyle:{padding:"0px"}},[a("Input",{staticStyle:{width:"600px"},attrs:{placeholder:"测试人员，可多个"},model:{value:t.reportData.ProjectInfo.Tester,callback:function(e){t.$set(t.reportData.ProjectInfo,"Tester",e)},expression:"reportData.ProjectInfo.Tester"}})],1)]),t._v(" "),a("tr",[a("td",[t._v("开发人员")]),t._v(" "),a("td",{staticStyle:{padding:"0px"}},[a("Input",{staticStyle:{width:"600px"},attrs:{placeholder:"项目所有开发人员，前端，服务端，数据，客户端"},model:{value:t.reportData.ProjectInfo.Dev,callback:function(e){t.$set(t.reportData.ProjectInfo,"Dev",e)},expression:"reportData.ProjectInfo.Dev"}})],1)]),t._v(" "),a("tr",[a("td",[t._v("PM")]),t._v(" "),a("td",{staticStyle:{padding:"0px"}},[a("Input",{staticStyle:{width:"600px"},attrs:{placeholder:"产品，项目相关人员"},model:{value:t.reportData.ProjectInfo.PM,callback:function(e){t.$set(t.reportData.ProjectInfo,"PM",e)},expression:"reportData.ProjectInfo.PM"}})],1)]),t._v(" "),a("tr",[a("td",[t._v("测试开始日期")]),t._v(" "),a("td",{staticStyle:{padding:"0px"}},[a("Input",{staticStyle:{width:"600px"},attrs:{placeholder:"测试开始日期"},model:{value:t.reportData.ProjectInfo.StartDate,callback:function(e){t.$set(t.reportData.ProjectInfo,"StartDate",e)},expression:"reportData.ProjectInfo.StartDate"}})],1)])]),t._v(" "),a("div",{staticStyle:{width:"760px"}},[a("Divider",{attrs:{orientation:"center"}},[t._v("重点提示")])],1),t._v(" "),a("div",[a("vue-editor",{staticStyle:{width:"760px"},attrs:{editorToolbar:t.editorToolBar,placeholder:"报告开头内容，需要收件人重点关注的信息例如@张三"},model:{value:t.reportData.Comments,callback:function(e){t.$set(t.reportData,"Comments",e)},expression:"reportData.Comments"}})],1),t._v(" "),a("div",{staticStyle:{width:"760px"}},[a("Divider",{attrs:{orientation:"center"}},[t._v("功能点")])],1),t._v(" "),a("table",[t._m(0),a("tr",[a("td",{staticStyle:{width:"100px"}},[t._v("\n            完成度\n          ")]),t._v(" "),a("td",{staticStyle:{padding:"0px"}},[a("Input",{staticStyle:{width:"660px"},attrs:{placeholder:"测试整体进度  "},model:{value:t.reportData.FeatureProgress.Progress,callback:function(e){t.$set(t.reportData.FeatureProgress,"Progress",e)},expression:"reportData.FeatureProgress.Progress"}})],1)]),t._v(" "),a("tr",[a("td",{staticStyle:{width:"100px"}},[t._v("\n            功能点\n            "),a("span",{on:{click:t.addNewFeature}},[a("Icon",{staticClass:"cursor-hand",attrs:{type:"md-add-circle",size:16,color:"#32be77"}})],1)]),t._v(" "),a("td",t._l(t.reportData.FeatureProgress.Feature,function(e){return a("tr",{key:e.timestamp},[a("td",{staticStyle:{padding:"0px"}},[a("Input",{staticStyle:{width:"560px"},attrs:{placeholder:"提测测试点"},model:{value:e.Content,callback:function(a){t.$set(e,"Content",a)},expression:"feature.Content"}})],1),t._v(" "),a("td",{staticStyle:{width:"100px"}},[a("Checkbox",{model:{value:e.Passed1,callback:function(a){t.$set(e,"Passed1",a)},expression:"feature.Passed1"}},[t._v("完成")]),t._v(" "),a("span",{on:{click:function(a){t.removeFeature(e.id)}}},[a("Icon",{staticClass:"cursor-hand",attrs:{type:"md-close-circle",size:16,color:""}})],1)],1)])}))]),t._v(" "),a("tr",[a("td",{staticStyle:{width:"100px"}},[t._v("\n            Bug情况\n          ")]),t._v(" "),a("td",{staticStyle:{padding:"0px"}},[a("Input",{staticStyle:{width:"660px"},attrs:{placeholder:"测试过程中bug情况汇总"},model:{value:t.reportData.FeatureProgress.BugSummary,callback:function(e){t.$set(t.reportData.FeatureProgress,"BugSummary",e)},expression:"reportData.FeatureProgress.BugSummary"}})],1)])]),t._v(" "),a("div",{staticStyle:{width:"760px"}},[a("Divider",{staticStyle:{width:"760px"},attrs:{orientation:"center"}},[t._v("Bug趋势图")])],1),t._v(" "),a("div",{staticStyle:{width:"760px"}},[t._l(t.reportData.BugTrendAttachments,function(t){return a("div",{staticStyle:{"padding-bottom":"10px"}},[a("img",{key:t.url,staticStyle:{width:"760px"},attrs:{src:t.url}})])}),t._v(" "),a("Upload",{ref:"upload",attrs:{multiple:"",type:"drag",paste:"",action:"/api/project/fortesting/upload_files","on-success":t.handleSuccess,"on-remove":t.handleRemove,format:["jpg","jpeg","png"],"max-size":10240,"default-file-list":t.reportData.BugTrendAttachments,"on-format-error":t.handleFormatError,"on-exceeded-size":t.handleMaxSize}},[a("div",{staticStyle:{padding:"20px 0"}},[a("Icon",{staticStyle:{color:"#3399ff"},attrs:{type:"ios-cloud-upload",size:"52"}}),t._v(" "),a("p",[t._v("点击，拖拽，粘贴上传图片")])],1)])],2)])])],1)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("tr",[e("th"),this._v(" "),e("th",[this._v("\n            功能点测试进度\n          ")])])}]};var f=a("VU/8")(h,v,!1,function(t){a("XCoK")},"data-v-4e2ae2c4",null).exports,g={components:{VueEditor:s.VueEditor,ICol:i.a},name:"testingCompleteReport",props:["projectID","fortestingID"],data:function(){return{projectMembers:[],newReport:!0,fortestingContent:[],defaultBTAttachments:[],editorToolBar:[["bold","italic","underline"],[{list:"ordered"},{list:"bullet"}],[{color:[]},{background:[]}]],reportData:{}}},computed:o()({},Object(n.c)(["appBodyHeight","userInfo"]),{reportContainerHeight:function(){return this.appBodyHeight-33}}),methods:{loadProjectMembers:function(){var t=this;this.$axios.get("/api/project/"+this.projectID+"/project_members").then(function(e){t.projectMembers=e.data.result},function(t){})},sendReport:function(){var t=this;this.$Message.success({content:"报告发送中!",duration:10,closable:!0}),this.$axios.post("/api/project/report/testcomplete",this.reportData).then(function(e){t.$Message.success({content:"测试完成报告已经发送!",duration:10,closable:!0})},function(e){t.$Message.warning({content:"除重点提示，抄送字段，其他字段均需要填写！",duration:10,closable:!0})})},loadForTesting:function(){var t=this;this.$axios.get("/api/project/fortesting/"+this.fortestingID).then(function(e){var a=e.data.result;if(t.newReport){t.reportData.id=t.fortestingID,t.reportData.Topic=a.ProjectName+"--"+a.VersionName+"测试完成通报--"+(new Date).toLocaleDateString(),t.reportData.ReleaseNotification.Title=a.ProjectName+"--"+a.VersionName+"上线准备通报",t.reportData.ReleaseNotification.Project=a.ProjectName+"--"+a.VersionName;for(var r=0;r<a.FortestingFeature.length;r++){var o={};o.id=(new Date).getTime()+10*Math.random(),o.Content=a.FortestingFeature[r],o.Passed1=!1,o.Passed2=!1,o.Passed3=!1,t.reportData.FeatureProgress.Feature.push(o)}}else for(var i=0;i<t.reportData.FeatureProgress.Feature.length;i++)t.reportData.FeatureProgress.Feature[i].id=(new Date).getTime()+Math.random()},function(t){})},addNewFeature:function(){var t={};t.id=(new Date).getTime()+10*Math.random(),t.Content="",t.Passed1=!1,t.Passed2=!1,t.Passed3=!1,this.reportData.FeatureProgress.Feature.push(t)},handleSuccess:function(t,e,a){e.url=t.result.url,e.id=t.result.file_id;var r={};r.name=e.name,r.url=e.url,this.reportData.BugTrendAttachments.push(r)},handleRemove:function(t,e){for(var a=0;a<this.reportData.BugTrendAttachments.length;a++)this.reportData.BugTrendAttachments[a].url===t.url&&this.reportData.BugTrendAttachments.pop(this.reportData.BugTrendAttachments[a])},handleFormatError:function(t){this.$Message.warning({content:"文件格式不正确,格式：'jpg','jpeg','png'",duration:10,closable:!0})},handleMaxSize:function(t){this.$Message.warning({content:"文件大小超过10M限制",duration:10,closable:!0})},removeFeature:function(t){if(0!==t)for(var e=0;e<this.reportData.FeatureProgress.Feature.length;e++){if(this.reportData.FeatureProgress.Feature[e].id===t){this.reportData.FeatureProgress.Feature.splice(e,1);break}}},initReport:function(){null===this.reportData.FortestingID?(this.newReport=!0,this.reportData.FortestingID=this.fortestingID,this.reportData.ReportType=3,this.reportData.ReleaseNotification.ReleaseDate=(new Date).toLocaleDateString(),this.reportData.ReleaseNotification.Tester=this.userInfo.last_name+this.userInfo.first_name,this.reportData.ReleaseNotification.QA=this.reportData.ReleaseNotification.Tester,this.reportData.Recipients.push(this.userInfo.id)):this.newReport=!1},loadReport:function(){var t=this;this.$axios.get("/api/project/fortesting/"+this.fortestingID+"/3").then(function(e){t.reportData=e.data.result,t.loadForTesting(),t.initReport()},function(t){})}},created:function(){this.loadProjectMembers(),this.loadReport()},watch:{}},D={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{style:"overflow:scroll;height:"+t.reportContainerHeight+"px"},[a("Card",{staticStyle:{width:"100%","margin-left":"5px","background-color":"inherit"},attrs:{"dis-hover":!0}},[a("Row",[a("i-col",{staticStyle:{width:"80px","padding-top":"15px"},attrs:{span:4}},[a("div",{staticClass:"cursor-hand",staticStyle:{display:"inline-block"}},[a("span",{on:{click:t.sendReport}},[a("Avatar",{staticStyle:{height:"60px",width:"60px","background-color":"#fff",color:"#777777"},attrs:{shape:"square",size:"large"}},[a("Icon",{attrs:{type:"ios-send-outline"}}),t._v("\n             发送")],1)],1)]),t._v(" "),a("Divider",{staticStyle:{height:"100px"},attrs:{type:"vertical"}})],1),t._v(" "),a("i-col",{attrs:{span:20}},[a("div",{staticStyle:{display:"inline-block"}},[a("Row",{staticStyle:{padding:"5px"}},[a("i-col",{staticStyle:{"min-width":"700px"}},[a("span",{staticStyle:{width:"60px","padding-right":"10px",display:"inline-block"}},[t._v("收件人:")]),t._v(" "),a("Select",{attrs:{filterable:"",multiple:""},model:{value:t.reportData.Recipients,callback:function(e){t.$set(t.reportData,"Recipients",e)},expression:"reportData.Recipients"}},t._l(t.projectMembers,function(e){return a("Option",{key:e.id,attrs:{value:e.PMMember}},[t._v(t._s(e.name)+" ("+t._s(e.email)+")\n                ")])}))],1)],1),t._v(" "),a("Row",{staticStyle:{padding:"5px"}},[a("i-col",{staticStyle:{"min-width":"700px"}},[a("span",{staticStyle:{width:"60px","padding-right":"10px",display:"inline-block"}},[t._v("抄送:")]),t._v(" "),a("Input",{staticStyle:{width:"100%"},attrs:{placeholder:"输入邮箱，多人用逗号分隔"},model:{value:t.reportData.CCList,callback:function(e){t.$set(t.reportData,"CCList",e)},expression:"reportData.CCList"}})],1)],1),t._v(" "),a("Row",{staticStyle:{padding:"5px"}},[a("i-col",{attrs:{stype:"min-width: 700px;"}},[a("span",{staticStyle:{width:"60px","padding-right":"10px",display:"inline-block"}},[t._v("主题:")]),t._v(" "),a("Input",{staticStyle:{width:"100%"},attrs:{placeholder:"报告主题"},model:{value:t.reportData.Topic,callback:function(e){t.$set(t.reportData,"Topic",e)},expression:"reportData.Topic"}})],1)],1)],1)])],1)],1),t._v(" "),a("div",{staticStyle:{padding:"10px","padding-left":"100px"}},[a("div",[a("div",{staticStyle:{width:"760px"}},[a("Divider",{staticStyle:{width:"760px"},attrs:{orientation:"center"}},[t._v("重点提示")])],1),t._v(" "),a("div",{staticStyle:{"margin-bottom":"20px"}},[a("vue-editor",{staticStyle:{width:"760px"},attrs:{editorToolbar:t.editorToolBar,placeholder:"报告开头内容，需要收件人重点关注的信息例如@张三"},model:{value:t.reportData.Comments,callback:function(e){t.$set(t.reportData,"Comments",e)},expression:"reportData.Comments"}})],1),t._v(" "),a("table",[a("tr",[a("td",[a("Input",{staticStyle:{width:"760px"},attrs:{placeholder:"【XXX项目】上线准备通报"},model:{value:t.reportData.ReleaseNotification.Title,callback:function(e){t.$set(t.reportData.ReleaseNotification,"Title",e)},expression:"reportData.ReleaseNotification.Title"}})],1)]),t._v(" "),a("tr",[a("td",[a("tr",[a("td",{staticStyle:{width:"100px"}},[t._v("测试人员")]),t._v(" "),a("td",[a("Input",{staticStyle:{width:"280px"},attrs:{placeholder:"测试人员"},model:{value:t.reportData.ReleaseNotification.Tester,callback:function(e){t.$set(t.reportData.ReleaseNotification,"Tester",e)},expression:"reportData.ReleaseNotification.Tester"}})],1),t._v(" "),a("td",{staticStyle:{width:"100px"}},[t._v("完成度")]),t._v(" "),a("td",[a("Input",{staticStyle:{width:"280px"},attrs:{placeholder:"完成度"},model:{value:t.reportData.ReleaseNotification.Progress,callback:function(e){t.$set(t.reportData.ReleaseNotification,"Progress",e)},expression:"reportData.ReleaseNotification.Progress"}})],1)])])]),t._v(" "),a("tr",[a("td",[a("tr",[a("td",{staticStyle:{width:"100px"}},[t._v("预计上线时间")]),t._v(" "),a("td",[a("Input",{staticStyle:{width:"280px"},attrs:{placeholder:"预计上线时间"},model:{value:t.reportData.ReleaseNotification.ReleaseDate,callback:function(e){t.$set(t.reportData.ReleaseNotification,"ReleaseDate",e)},expression:"reportData.ReleaseNotification.ReleaseDate"}})],1),t._v(" "),a("td",{staticStyle:{width:"100px"}},[t._v("上线项目")]),t._v(" "),a("td",[a("Input",{staticStyle:{width:"280px"},attrs:{placeholder:"上线项目名称"},model:{value:t.reportData.ReleaseNotification.Project,callback:function(e){t.$set(t.reportData.ReleaseNotification,"Project",e)},expression:"reportData.ReleaseNotification.Project"}})],1)])])]),t._v(" "),a("tr",[a("td",[a("tr",[a("td",{staticStyle:{width:"100px"}},[t._v("上线责任人")]),t._v(" "),a("td",[a("tr",[a("td",{staticStyle:{width:"100px"}},[t._v("QA")]),t._v(" "),a("td",[a("Input",{staticStyle:{width:"560px"},attrs:{placeholder:"QA本次上线负责人"},model:{value:t.reportData.ReleaseNotification.QA,callback:function(e){t.$set(t.reportData.ReleaseNotification,"QA",e)},expression:"reportData.ReleaseNotification.QA"}})],1)]),t._v(" "),a("tr",[a("td",{staticStyle:{width:"100px"}},[t._v("服务端")]),t._v(" "),a("td",[a("Input",{staticStyle:{width:"560px"},attrs:{placeholder:"服务端本次上线开发负责人"},model:{value:t.reportData.ReleaseNotification.Service,callback:function(e){t.$set(t.reportData.ReleaseNotification,"Service",e)},expression:"reportData.ReleaseNotification.Service"}})],1)]),t._v(" "),a("tr",[a("td",{staticStyle:{width:"100px"}},[t._v("前端")]),t._v(" "),a("td",[a("Input",{staticStyle:{width:"560px"},attrs:{placeholder:"前端本次上线负责人"},model:{value:t.reportData.ReleaseNotification.FE,callback:function(e){t.$set(t.reportData.ReleaseNotification,"FE",e)},expression:"reportData.ReleaseNotification.FE"}})],1)]),t._v(" "),a("tr",[a("td",{staticStyle:{width:"100px"}},[t._v("客户端")]),t._v(" "),a("td",[a("Input",{staticStyle:{width:"560px"},attrs:{placeholder:"上线项目名称"},model:{value:t.reportData.ReleaseNotification.Client,callback:function(e){t.$set(t.reportData.ReleaseNotification,"Client",e)},expression:"reportData.ReleaseNotification.Client"}})],1)]),t._v(" "),a("tr",[a("td",{staticStyle:{width:"100px"}},[t._v("数据")]),t._v(" "),a("td",[a("Input",{staticStyle:{width:"560px"},attrs:{placeholder:"客户端本次上线负责人"},model:{value:t.reportData.ReleaseNotification.Data,callback:function(e){t.$set(t.reportData.ReleaseNotification,"Data",e)},expression:"reportData.ReleaseNotification.Data"}})],1)]),t._v(" "),a("tr",[a("td",{staticStyle:{width:"100px"}},[t._v("PM")]),t._v(" "),a("td",[a("Input",{staticStyle:{width:"560px"},attrs:{placeholder:"PM本次上线负责人"},model:{value:t.reportData.ReleaseNotification.PM,callback:function(e){t.$set(t.reportData.ReleaseNotification,"PM",e)},expression:"reportData.ReleaseNotification.PM"}})],1)])])])])])]),t._v(" "),a("div",{staticStyle:{width:"760px"}},[a("Divider",{staticStyle:{width:"760px"},attrs:{orientation:"center"}},[t._v("功能点")])],1),t._v(" "),a("table",[t._m(0),a("tr",[a("td",{staticStyle:{width:"100px"}},[t._v("\n            完成度\n          ")]),t._v(" "),a("td",{staticStyle:{padding:"0px"}},[a("Input",{staticStyle:{width:"660px"},attrs:{placeholder:"测试整体进度"},model:{value:t.reportData.FeatureProgress.Progress,callback:function(e){t.$set(t.reportData.FeatureProgress,"Progress",e)},expression:"reportData.FeatureProgress.Progress"}})],1)]),t._v(" "),a("tr",[a("td",{staticStyle:{width:"100px"}},[t._v("\n            功能点\n            "),a("span",{on:{click:t.addNewFeature}},[a("Icon",{staticClass:"cursor-hand",attrs:{type:"md-add-circle",size:16,color:"#32be77"}})],1)]),t._v(" "),a("td",t._l(t.reportData.FeatureProgress.Feature,function(e){return a("tr",{key:e.id},[a("td",{staticStyle:{padding:"0px"}},[a("Input",{staticStyle:{width:"560px"},attrs:{placeholder:"提测功能点"},model:{value:e.Content,callback:function(a){t.$set(e,"Content",a)},expression:"feature.Content"}})],1),t._v(" "),a("td",{staticStyle:{width:"100px"}},[a("Checkbox",{model:{value:e.Passed1,callback:function(a){t.$set(e,"Passed1",a)},expression:"feature.Passed1"}},[t._v("完成")]),t._v(" "),a("span",{on:{click:function(a){t.removeFeature(e.id)}}},[a("Icon",{staticClass:"cursor-hand",attrs:{type:"md-close-circle",size:16,color:""}})],1)],1)])}))]),t._v(" "),a("tr",[a("td",{staticStyle:{width:"100px"}},[t._v("\n            Bug情况\n          ")]),t._v(" "),a("td",{staticStyle:{padding:"0px"}},[a("Input",{staticStyle:{width:"660px"},attrs:{placeholder:"提测相关bug情况汇总描述"},model:{value:t.reportData.FeatureProgress.BugSummary,callback:function(e){t.$set(t.reportData.FeatureProgress,"BugSummary",e)},expression:"reportData.FeatureProgress.BugSummary"}})],1)])]),t._v(" "),a("div",{staticStyle:{width:"760px"}},[a("Divider",{staticStyle:{width:"760px"},attrs:{orientation:"center"}},[t._v("Bug趋势图")])],1),t._v(" "),a("div",{staticStyle:{width:"760px"}},[t._l(t.reportData.BugTrendAttachments,function(t){return a("div",{staticStyle:{"padding-bottom":"10px"}},[a("img",{key:t.url,staticStyle:{width:"760px"},attrs:{src:t.url}})])}),t._v(" "),a("Upload",{ref:"upload",attrs:{multiple:"",type:"drag",paste:"",action:"/api/project/fortesting/upload_files","on-success":t.handleSuccess,"on-remove":t.handleRemove,format:["jpg","jpeg","png"],"max-size":10240,"default-file-list":t.reportData.BugTrendAttachments,"on-format-error":t.handleFormatError,"on-exceeded-size":t.handleMaxSize}},[a("div",{staticStyle:{padding:"20px 0"}},[a("Icon",{staticStyle:{color:"#3399ff"},attrs:{type:"ios-cloud-upload",size:"52"}}),t._v(" "),a("p",[t._v("点击，拖拽，粘贴上传图片")])],1)])],2)])])],1)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("tr",[e("th"),this._v(" "),e("th",[this._v("\n            功能点测试进度\n          ")])])}]};var m=a("VU/8")(g,D,!1,function(t){a("pIw3")},"data-v-37b808fd",null).exports,x={name:"FortestingBVTReport",props:["projectID","fortestingID","reportName"],data:function(){return{single:!1,TestingAdvice:"",value:"",editorToolBar:[["bold","italic","underline"],[{list:"ordered"},{list:"bullet"}],[{color:[]},{background:[]}]],cityList:[{value:"New York",label:"New York"},{value:"London",label:"London"},{value:"Sydney",label:"Sydney"},{value:"Ottawa",label:"Ottawa"},{value:"Paris",label:"Paris"},{value:"Canberra",label:"Canberra"}],model11:"",model12:[]}},computed:o()({},Object(n.c)(["appBodyHeight"]),{reportContainerHeight:function(){return this.appBodyHeight-33}}),components:{VueEditor:s.VueEditor,ICol:i.a,TestingComplete:m,ProgressReport:f,BvtReport:u}},y={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{style:"overflow:scroll;height:"+t.reportContainerHeight+"px"},["bvt"===t.reportName?a("bvt-report",{attrs:{projectID:t.projectID,fortestingID:t.fortestingID}}):t._e(),t._v(" "),"progress"===t.reportName?a("progress-report",{attrs:{projectID:t.projectID,fortestingID:t.fortestingID}}):t._e(),t._v(" "),"testcomplete"===t.reportName?a("testing-complete",{attrs:{projectID:t.projectID,fortestingID:t.fortestingID}}):t._e()],1)},staticRenderFns:[]};var _=a("VU/8")(x,y,!1,function(t){a("/E0Z")},"data-v-5447dbf4",null);e.default=_.exports}});
//# sourceMappingURL=17.ccc6867e8f99aa3655fa.js.map
webpackJsonp([15],{"72jS":function(t,e){},FQKX:function(t,e){},VIzs:function(t,e,s){"use strict";var a=s("bOdI"),o=s.n(a),i=s("9Xvl"),n={name:"iSwitch",mixins:[s("pEmh").a],props:{value:{type:[String,Number,Boolean],default:!1},trueValue:{type:[String,Number,Boolean],default:!0},falseValue:{type:[String,Number,Boolean],default:!1},disabled:{type:Boolean,default:!1},size:{validator:function(t){return Object(i.e)(t,["large","small","default"])},default:function(){return this.$IVIEW&&""!==this.$IVIEW.size?this.$IVIEW.size:"default"}},name:{type:String},loading:{type:Boolean,default:!1}},data:function(){return{currentValue:this.value}},computed:{wrapClasses:function(){var t;return["ivu-switch",(t={},o()(t,"ivu-switch-checked",this.currentValue===this.trueValue),o()(t,"ivu-switch-disabled",this.disabled),o()(t,"ivu-switch-"+this.size,!!this.size),o()(t,"ivu-switch-loading",this.loading),t)]},innerClasses:function(){return"ivu-switch-inner"}},methods:{toggle:function(t){if(t.preventDefault(),this.disabled||this.loading)return!1;var e=this.currentValue===this.trueValue?this.falseValue:this.trueValue;this.currentValue=e,this.$emit("input",e),this.$emit("on-change",e),this.dispatch("FormItem","on-form-change",e)}},watch:{value:function(t){if(t!==this.trueValue&&t!==this.falseValue)throw"Value should be trueValue or falseValue.";this.currentValue=t}}},r={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("span",{class:t.wrapClasses,attrs:{tabindex:"0"},on:{click:t.toggle,keydown:function(e){return"button"in e||!t._k(e.keyCode,"space",32,e.key," ")?t.toggle(e):null}}},[s("input",{attrs:{type:"hidden",name:t.name},domProps:{value:t.currentValue}}),t._v(" "),s("span",{class:t.innerClasses},[t.currentValue===t.trueValue?t._t("open"):t._e(),t._v(" "),t.currentValue===t.falseValue?t._t("close"):t._e()],2)])},staticRenderFns:[]},l=s("VU/8")(n,r,!1,null,null,null);e.a=l.exports},Wn1i:function(t,e){},ejD6:function(t,e){},gR3i:function(t,e){},gum7:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=s("Dd8w"),o=s.n(a),i=s("NYxO"),n=s("YRzF"),r=s("mvHQ"),l=s.n(r),c=s("DAYN"),p=s.n(c),u=s("SriR"),d=s("5MND"),g={name:"CITaskStage",props:["taskBasicInfo","taskID"],data:function(){return{projects:[],agents:[],stepPlugins:[],agentTags:[],caseTags:[],formItem:{},ruleCustom:o()({},u.a),stageList:[],currentStep:0,rowLength:4,tagLeft:"100px;",showParameterGroupConfig:"",newStage:{task_id:0,stage_title:"新建阶段",stage_order_index:1,is_on:!0,svn_steps:[],git_steps:[],command_steps:[],ios_build_steps:[],android_build_steps:[],gat_apitest_steps:[],gat_uitest_steps:[],ssh_steps:[]},stepDatas:{}}},computed:o()({},Object(i.c)(["appBodyHeight","userInfo"]),{containerHeight:function(){return this.appBodyHeight},taskConfigContainerHeight:function(){return this.appBodyHeight-200},stepIndex:function(){return this.stageList.length<3?10:2*this.stageList.length+10>=24?23:2*this.stageList.length+10}}),methods:o()({},Object(i.d)("citask",["setCITaskConfigChanged"]),{onFocus:function(){var t=this.showParameterGroupConfig.split(/\r?\n/).length;t>4&&(this.rowLength=t)},clickStep:function(t,e){this.currentStep=e,this.$refs.goodShow.$el.scrollTop=this.$refs[t][0].$el.offsetTop},getAgents:function(){var t=this;this.$axios.get("/api/common/agents").then(function(e){t.agents=e.data.result},function(t){})},changeAgentFilterType:function(t){1===t&&(this.formItem.AgentTags=[]),2===t&&(this.formItem.AgentID=0),console.log(this.formItem)},addStage:function(){var t=this,e=1,s=JSON.parse(l()(this.newStage));0!==this.stageList.length&&(e=this.stageList[this.stageList.length-1].stage_order_index+1),s.stage_order_index=e,s.task_id=this.taskID,this.$axios.post("/api/ci/task/"+this.taskID+"/stages",s).then(function(e){t.stageList.push(e.data.result)},function(t){}),this.currentStep=e},addStepPlugin:function(t){for(var e=this,s=t.split(":"),a=JSON.parse(l()(this.stepDatas[s[1]])),o=null,i=0;i<this.stageList.length;i++)this.stageList[i].id===s[0]&&(o=this.stageList[i]);a.step_order_index=this.getStepOrderIndex(o.steps),a.stage_id=s[0],this.$axios.post("/api/ci/task/task_stage/"+s[0]+"/steps",a).then(function(t){o.steps.push(t.data.result),e.setCITaskConfigChanged(!0)},function(t){e.$Message.error({content:"添加构建步骤失败",duration:10,closable:!0})})},removeStep:function(t,e){var s=this;this.$axios.delete("/api/ci/task/task_step/"+t).then(function(a){s.setCITaskConfigChanged(!0);for(var o=0;o<s.stageList.length;o++)if(s.stageList[o].id===e)for(var i=s.stageList[o],n=0;n<i.steps.length;n++){i.steps[n].id===t&&i.steps.splice(n,1)}},function(t){s.$Message.error({content:"删除构建步骤失败",duration:10,closable:!0})})},getStepOrderIndex:function(t){return 0===t.length?1:t[t.length-1].step_order_index+1},findPluginData:function(t,e){for(var s={},a=0;a<e.length;a++)if(e[a].id===t){s=e[a];break}return s},saveTaskConfig:function(t){this.saveTaskBasic(t),this.saveRunConfig()},getTaskConfig:function(){var t=this;this.$axios.get("/api/ci/task/"+this.taskID+"/config").then(function(e){t.stageList=e.data.result.config_stages},function(t){})},onEnd:function(t){for(var e=t.from.id,s=0;s<this.stageList.length;s++)if(e===this.stageList[s].id){for(var a=0;a<this.stageList[s].steps.length;a++)this.stageList[s].steps[a].step_order_index=a+1;break}},removeStage:function(t){var e=this;this.$Modal.confirm({title:"删除确认",content:"点击确定删除构建阶段。",onOk:function(){for(var s=0;s<e.stageList.length;s++)if(e.stageList[s].id===t){e.stageList.splice(s,1);break}e.$axios.delete("/api/ci/task/task_stage/"+t).then(function(t){e.setCITaskConfigChanged(!0),e.$Message.success({content:"阶段已经成功移除",duration:10,closable:!0})},function(t){e.$Message.error({content:"移除构建阶段失败",duration:10,closable:!0})})},onCancel:function(){}})},getStepTemplates:function(){var t=this;this.$axios.get("/api/ci/task/steps").then(function(e){t.stepDatas=e.data.result},function(t){})},saveTaskBasic:function(t){var e=this;this.$refs[t].validate(function(t){t&&e.$axios.patch("/api/ci/task/"+e.taskID+"/",e.formItem).then(function(t){e.$Message.success({content:"配置保存成功",duration:10})},function(t){e.$Message.error({content:"配置保存失败，请联系管理员或者重试",duration:10})})})},saveRunConfig:function(){var t={config_stages:this.stageList};this.$axios.post("/api/ci/task/"+this.taskID+"/config/",t).then(function(t){},function(t){})},updateStageTitle:function(t,e){var s=this,a={stage_title:t};""!==t.trim&&this.$axios.patch("/api/ci/task/task_stage/"+e+"/",a).then(function(a){for(var o=0;o<s.stageList.length;o++)if(s.stageList[o].id===e){s.stageList[o].stage_title=t;break}s.$Message.success({content:"阶段名称更新成功",duration:10,closable:!0})},function(t){s.$Message.error({content:"阶段名称更新失败",duration:10,closable:!0})})},loadMyProject:function(){var t=this;this.$axios.get("/api/project/list?extinfo=0&home=1").then(function(e){t.projects=e.data.result},function(t){})},getAgentTags:function(){var t=this;this.$axios.get("/api/project/tags").then(function(e){t.agentTags=e.data.result},function(t){})},getTaskPlugins:function(){var t=this;this.$axios.get("/api/ci/task/plugins").then(function(e){t.stepPlugins=e.data.result},function(t){})},getCaseTags:function(){var t=this;this.$axios.get("/api/ci/case_tags").then(function(e){t.caseTags=e.data.result},function(t){})}}),created:function(){this.loadMyProject(),this.formItem=this.taskBasicInfo,this.getAgents(),this.getAgentTags(),this.getTaskConfig(),this.getStepTemplates(),this.getTaskPlugins(),this.getTaskPlugins(),this.getCaseTags()},watch:{taskBasicInfo:function(t){this.formItem=t}},components:{draggable:p.a,labelEditorInput:d.a}},h={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticStyle:{padding:"10px"}},[s("Row",{staticStyle:{"margin-bottom":"20px"}},[s("i-col",{attrs:{span:t.stepIndex}},[s("Steps",{attrs:{current:t.currentStep}},[s("Step",{attrs:{title:"基本信息",icon:"ios-arrow-dropright-circle"}}),t._v(" "),t._l(t.stageList,function(e){return 0!==e.stage_order_index?s("Step",{key:e.id,staticClass:"cursor-hand",attrs:{title:e.stage_title,icon:"ios-arrow-dropright-circle"},nativeOn:{click:function(s){t.clickStep(e.id,e.stage_order_index)}}}):t._e()})],2)],1),t._v(" "),s("i-col",{attrs:{span:24-t.stepIndex}},[s("div",{staticStyle:{float:"left","margin-left":"15px",cursor:"pointer"},on:{click:t.addStage}},[s("Icon",{attrs:{size:30,type:"ios-add-circle-outline"}})],1)])],1),t._v(" "),s("Row",[s("i-col",{ref:"goodShow",staticClass:"goodShow",style:"height:"+t.taskConfigContainerHeight+"px; overflow-y:scroll;",attrs:{span:"24"}},[s("div",{staticStyle:{width:"90%","margin-left":"auto","margin-right":"auto"}},[s("Card",{staticStyle:{"margin-bottom":"16px"},attrs:{bordered:!1,"dis-hover":"",shadow:""}},[s("div",{attrs:{slot:"title"},slot:"title"},[t._v("\n            基本信息\n          ")]),t._v(" "),s("div",[s("Form",{ref:"ciTaskBasicCreate",attrs:{model:t.formItem,"label-width":120,rules:t.ruleCustom}},[s("FormItem",{attrs:{label:"任务名称",prop:"TaskName"}},[s("Input",{attrs:{placeholder:"任务名称50个字符以内！"},model:{value:t.formItem.TaskName,callback:function(e){t.$set(t.formItem,"TaskName",e)},expression:"formItem.TaskName"}})],1),t._v(" "),s("FormItem",{attrs:{label:"项目",prop:"Project"}},[s("Select",{attrs:{placeholder:"请选择项目"},model:{value:t.formItem.Project,callback:function(e){t.$set(t.formItem,"Project",e)},expression:"formItem.Project"}},t._l(t.projects,function(e){return s("Option",{key:e.id,attrs:{value:e.id,label:e.PBTitle}},[s("span",{staticStyle:{"margin-right":"10px"}},[s("Avatar",{attrs:{src:e.PBAvatar}})],1),t._v(" "),s("span",[t._v(t._s(e.PBTitle))])])}))],1),t._v(" "),s("FormItem",{attrs:{label:"构建记录保留个数",prop:"HistoryCleanStrategy"}},[s("Input",{attrs:{placeholder:"默认10个"},model:{value:t.formItem.HistoryCleanStrategy,callback:function(e){t.$set(t.formItem,"HistoryCleanStrategy",e)},expression:"formItem.HistoryCleanStrategy"}})],1),t._v(" "),s("FormItem",{attrs:{label:"任务描述",prop:"Description"}},[s("Input",{attrs:{placeholder:"为任务提供一段简短描述！"},model:{value:t.formItem.Description,callback:function(e){t.$set(t.formItem,"Description",e)},expression:"formItem.Description"}})],1),t._v(" "),s("FormItem",{attrs:{label:"Agent选择",prop:"AgentFilter"}},[s("RadioGroup",{attrs:{vertical:""},on:{"on-change":t.changeAgentFilterType},model:{value:t.formItem.AgentFilterType,callback:function(e){t.$set(t.formItem,"AgentFilterType",e)},expression:"formItem.AgentFilterType"}},[s("Radio",{staticStyle:{"margin-bottom":"0px"},attrs:{label:2}},[s("Icon",{attrs:{type:"social-apple"}}),t._v(" "),s("span",{staticStyle:{display:"inline-block"}},[t._v("Agent标签\n                    ")])],1),t._v(" "),s("Select",{staticStyle:{"margin-left":"25px","margin-bottom":"10px"},attrs:{multiple:"",placeholder:"Agent标签"},model:{value:t.formItem.AgentTags,callback:function(e){t.$set(t.formItem,"AgentTags",e)},expression:"formItem.AgentTags"}},t._l(t.agentTags,function(e){return s("Option",{key:e.id,attrs:{value:e.id}},[t._v(t._s(e.TagName))])})),t._v(" "),s("Radio",{attrs:{label:1}},[s("Icon",{attrs:{type:"social-android"}}),t._v(" "),s("span",[t._v("指定机器")])],1),t._v(" "),s("Select",{staticStyle:{"margin-left":"25px"},attrs:{placeholder:"指定执行机器"},model:{value:t.formItem.AgentID,callback:function(e){t.$set(t.formItem,"AgentID",e)},expression:"formItem.AgentID"}},t._l(t.agents,function(e){return s("Option",{key:e.id,attrs:{value:e.id}},[t._v(t._s(e.Name))])}))],1)],1),t._v(" "),s("FormItem",{attrs:{label:"定时触发",prop:"TaskTrigger"}},[s("Input",{attrs:{placeholder:"00:09:12/**:09:**"},model:{value:t.formItem.Schedule,callback:function(e){t.$set(t.formItem,"Schedule",e)},expression:"formItem.Schedule"}})],1),t._v(" "),s("FormItem",{attrs:{label:"执行策略",prop:"ExecuteStrategy"}},[s("Select",{attrs:{placeholder:"默认步骤失败，中断任务执行"},model:{value:t.formItem.ExecuteStrategy,callback:function(e){t.$set(t.formItem,"ExecuteStrategy",e)},expression:"formItem.ExecuteStrategy"}},[s("Option",{attrs:{value:1}},[t._v("步骤失败，结束任务执行")]),t._v(" "),s("Option",{attrs:{value:2}},[t._v("步骤失败，继续任务执行")])],1)],1)],1)],1)]),t._v(" "),t._l(t.stageList,function(e){return s("Card",{key:e.stage_order_index,ref:e.id,refInFor:!0,staticStyle:{"margin-bottom":"16px"},attrs:{bordered:!1,"dis-hover":"",shadow:""}},[s("div",{attrs:{slot:"title"},slot:"title"},[s("div",[s("label-editor-input",{attrs:{placeHolder:"阶段标题",id:e.id,displayWidth:200,displayText:e.stage_title},on:{updateValue:t.updateStageTitle}})],1)]),t._v(" "),s("div",{attrs:{slot:"extra"},slot:"extra"},[s("Dropdown",{staticStyle:{"margin-right":"10px"},attrs:{trigger:"click",transfer:""},on:{"on-click":t.addStepPlugin}},[s("Button",{attrs:{shape:"circle",size:"small"}},[s("Icon",{attrs:{type:"ios-add",size:"18"}}),t._v("步骤")],1),t._v(" "),s("DropdownMenu",{attrs:{slot:"list"},slot:"list"},t._l(t.stepPlugins,function(a){return s("DropdownItem",{key:a.id,attrs:{name:e.id+":"+a.id}},[s("Tag",{attrs:{color:a.PluginLabelColor}}),t._v(t._s(a.PluginName))],1)}))],1),t._v(" "),s("i-switch",{model:{value:e.is_on,callback:function(s){t.$set(e,"is_on",s)},expression:"stage.is_on"}},[s("span",{attrs:{slot:"open"},slot:"open"},[t._v("on")]),t._v(" "),s("span",{attrs:{slot:"close"},slot:"close"},[t._v("off")])]),t._v(" "),s("span",{staticClass:"cursor-hand",on:{click:function(s){t.removeStage(e.id)}}},[s("Icon",{attrs:{type:"ios-close",size:20}})],1)],1),t._v(" "),s("div",[s("draggable",{attrs:{options:{group:e.id},id:e.id},on:{end:t.onEnd},model:{value:e.steps,callback:function(s){t.$set(e,"steps",s)},expression:"stage.steps"}},[s("transition-group",{key:1,staticClass:"dragable-area",attrs:{id:e.id}},t._l(e.steps,function(a){return s("div",{key:a.id},[1===a.step_config.step_id?s("Card",{staticStyle:{"margin-bottom":"16px"},attrs:{"dis-hover":""}},[s("div",{attrs:{slot:"title"},slot:"title"},[s("span",[s("Icon",{attrs:{type:"ios-navigate-outline"}})],1),t._v(" "),s("span",[t._v("\n                        "+t._s(a.step_config.step_name)+"\n                      ")])]),t._v(" "),s("div",{attrs:{slot:"extra"},slot:"extra"},[s("i-switch",{model:{value:a.is_on,callback:function(e){t.$set(a,"is_on",e)},expression:"step.is_on"}},[s("span",{attrs:{slot:"open"},slot:"open"},[t._v("on")]),t._v(" "),s("span",{attrs:{slot:"close"},slot:"close"},[t._v("off")])]),t._v(" "),s("span",{staticClass:"cursor-hand",on:{click:function(s){t.removeStep(a.id,e.id)}}},[s("Icon",{attrs:{type:"ios-close",size:20}})],1)],1),t._v(" "),s("div",[s("Row",{staticStyle:{"margin-bottom":"16px"}},[s("i-col",{staticStyle:{"text-align":"right","padding-right":"16px"},attrs:{span:"3"}},[s("span",[t._v("用途")])]),t._v(" "),s("i-col",{attrs:{span:"21",offset:"-4"}},[s("Input",{attrs:{placeholder:"请输入步骤用途"},model:{value:a.purpose_name,callback:function(e){t.$set(a,"purpose_name",e)},expression:"step.purpose_name"}})],1)],1),t._v(" "),s("Row",{staticStyle:{"margin-bottom":"16px"}},[s("i-col",{staticStyle:{"text-align":"right","padding-right":"16px"},attrs:{span:"3"}},[t._v("仓库地址:")]),t._v(" "),s("i-col",{attrs:{span:"21",offset:"-4"}},[s("Input",{attrs:{type:"text",placeholder:"代码仓库"},model:{value:a.step_config.repository_url,callback:function(e){t.$set(a.step_config,"repository_url",e)},expression:"step.step_config.repository_url"}})],1)],1),t._v(" "),s("Row",{staticStyle:{"margin-bottom":"16px"}},[s("i-col",{staticStyle:{"text-align":"right","padding-right":"16px"},attrs:{span:"3"}},[t._v("本地地址:")]),t._v(" "),s("i-col",{attrs:{span:"21",offset:"-4"}},[s("Input",{attrs:{type:"text",placeholder:"本地目录"},model:{value:a.step_config.local_directory,callback:function(e){t.$set(a.step_config,"local_directory",e)},expression:"step.step_config.local_directory"}})],1)],1),t._v(" "),s("Row",{staticStyle:{"margin-bottom":"16px"}},[s("i-col",{staticStyle:{"text-align":"right","padding-right":"16px"},attrs:{span:"3"}},[t._v("Checkout策略:")]),t._v(" "),s("i-col",{attrs:{span:"21",offset:"-4"}},[s("Select",{attrs:{placeholder:"代码检出策略"},model:{value:a.step_config.checkout_stragegy,callback:function(e){t.$set(a.step_config,"checkout_stragegy",e)},expression:"step.step_config.checkout_stragegy"}},[s("Option",{attrs:{value:"1",label:"Always check out a fresh copy"}}),t._v(" "),s("Option",{attrs:{value:"2",label:"Use svn update as much as possible"}})],1)],1)],1),t._v(" "),s("Row",{staticStyle:{"margin-bottom":"16px"}},[s("i-col",{staticStyle:{"text-align":"right","padding-right":"16px"},attrs:{span:"3"}},[t._v("用户名:")]),t._v(" "),s("i-col",{attrs:{span:"21",offset:"-4"}},[s("Input",{attrs:{type:"text",placeholder:"代码库用户"},model:{value:a.step_config.user,callback:function(e){t.$set(a.step_config,"user",e)},expression:"step.step_config.user"}})],1)],1),t._v(" "),s("Row",{staticStyle:{"margin-bottom":"16px"}},[s("i-col",{staticStyle:{"text-align":"right","padding-right":"16px"},attrs:{span:"3"}},[t._v("密码:")]),t._v(" "),s("i-col",{attrs:{span:"21",offset:"-4"}},[s("Input",{attrs:{type:"password",placeholder:"代码仓库密码"},model:{value:a.step_config.password,callback:function(e){t.$set(a.step_config,"password",e)},expression:"step.step_config.password"}})],1)],1)],1)]):t._e(),t._v(" "),2===a.step_config.step_id?s("Card",{staticStyle:{"margin-bottom":"16px"},attrs:{"dis-hover":""}},[s("div",{attrs:{slot:"title"},slot:"title"},[s("span",[s("Icon",{attrs:{type:"ios-navigate-outline"}})],1),t._v(" "),s("span",[t._v("\n                        "+t._s(a.step_config.step_name)+"\n                      ")])]),t._v(" "),s("div",{attrs:{slot:"extra"},slot:"extra"},[s("i-switch",{model:{value:a.is_on,callback:function(e){t.$set(a,"is_on",e)},expression:"step.is_on"}},[s("span",{attrs:{slot:"open"},slot:"open"},[t._v("on")]),t._v(" "),s("span",{attrs:{slot:"close"},slot:"close"},[t._v("off")])]),t._v(" "),s("span",{staticClass:"cursor-hand",on:{click:function(s){t.removeStep(a.id,e.id)}}},[s("Icon",{attrs:{type:"ios-close",size:20}})],1)],1),t._v(" "),s("div",[s("Row",{staticStyle:{"margin-bottom":"16px"}},[s("i-col",{staticStyle:{"text-align":"right","padding-right":"16px"},attrs:{span:"3"}},[s("span",[t._v("用途")])]),t._v(" "),s("i-col",{attrs:{span:"21",offset:"-4"}},[s("Input",{attrs:{placeholder:"请输入步骤用途"},model:{value:a.purpose_name,callback:function(e){t.$set(a,"purpose_name",e)},expression:"step.purpose_name"}})],1)],1),t._v(" "),s("Row",{staticStyle:{"margin-bottom":"16px"}},[s("i-col",{staticStyle:{"text-align":"right","padding-right":"16px"},attrs:{span:"3"}},[t._v("仓库地址:")]),t._v(" "),s("i-col",{attrs:{span:"21",offset:"-4"}},[s("Input",{attrs:{type:"text",placeholder:"代码仓库"},model:{value:a.step_config.repository_url,callback:function(e){t.$set(a.step_config,"repository_url",e)},expression:"step.step_config.repository_url"}})],1)],1),t._v(" "),s("Row",{staticStyle:{"margin-bottom":"16px"}},[s("i-col",{staticStyle:{"text-align":"right","padding-right":"16px"},attrs:{span:"3"}},[t._v("分支/Tag:")]),t._v(" "),s("i-col",{attrs:{span:"21",offset:"-4"}},[s("Input",{attrs:{type:"text",placeholder:"留空默认master;分支origin/branch;非空且不包含'/'表示tag"},model:{value:a.step_config.branch,callback:function(e){t.$set(a.step_config,"branch",e)},expression:"step.step_config.branch"}})],1)],1),t._v(" "),s("Row",{staticStyle:{"margin-bottom":"16px"}},[s("i-col",{staticStyle:{"text-align":"right","padding-right":"16px"},attrs:{span:"3"}},[t._v("Checkout策略:")]),t._v(" "),s("i-col",{attrs:{span:"21",offset:"-4"}},[s("Select",{attrs:{placeholder:"代码检出策略"},model:{value:a.step_config.checkout_stragegy,callback:function(e){t.$set(a.step_config,"checkout_stragegy",e)},expression:"step.step_config.checkout_stragegy"}},[s("Option",{attrs:{value:"1",label:"Wipe out & shallow clone (无变更日志,耗时短)"}}),t._v(" "),s("Option",{attrs:{value:"2",label:"Wipe out & full clone (有变更日志,耗时长)"}})],1)],1)],1),t._v(" "),s("Row",{staticStyle:{"margin-bottom":"16px"}},[s("i-col",{staticStyle:{"text-align":"right","padding-right":"16px"},attrs:{span:"3"}},[t._v("本地地址:")]),t._v(" "),s("i-col",{attrs:{span:"21",offset:"-4"}},[s("Input",{attrs:{type:"text",placeholder:"本地目录"},model:{value:a.step_config.local_directory,callback:function(e){t.$set(a.step_config,"local_directory",e)},expression:"step.step_config.local_directory"}})],1)],1),t._v(" "),s("Row",{staticStyle:{"margin-bottom":"16px"}},[s("i-col",{staticStyle:{"text-align":"right","padding-right":"16px"},attrs:{span:"3"}},[t._v("用户名:")]),t._v(" "),s("i-col",{attrs:{span:"21",offset:"-4"}},[s("Input",{attrs:{type:"text",placeholder:"代码库用户"},model:{value:a.step_config.user,callback:function(e){t.$set(a.step_config,"user",e)},expression:"step.step_config.user"}})],1)],1),t._v(" "),s("Row",{staticStyle:{"margin-bottom":"16px"}},[s("i-col",{staticStyle:{"text-align":"right","padding-right":"16px"},attrs:{span:"3"}},[t._v("密码:")]),t._v(" "),s("i-col",{attrs:{span:"21",offset:"-4"}},[s("Input",{attrs:{type:"password",placeholder:"代码仓库密码"},model:{value:a.step_config.password,callback:function(e){t.$set(a.step_config,"password",e)},expression:"step.step_config.password"}})],1)],1)],1)]):t._e(),t._v(" "),3===a.step_config.step_id?s("Card",{staticStyle:{"margin-bottom":"16px"},attrs:{"dis-hover":""}},[s("div",{attrs:{slot:"title"},slot:"title"},[s("span",[s("Icon",{attrs:{type:"ios-navigate-outline"}})],1),t._v(" "),s("span",[t._v("\n                        "+t._s(a.step_config.step_name)+"\n                      ")])]),t._v(" "),s("div",{attrs:{slot:"extra"},slot:"extra"},[s("i-switch",{model:{value:a.is_on,callback:function(e){t.$set(a,"is_on",e)},expression:"step.is_on"}},[s("span",{attrs:{slot:"open"},slot:"open"},[t._v("on")]),t._v(" "),s("span",{attrs:{slot:"close"},slot:"close"},[t._v("off")])]),t._v(" "),s("span",{staticClass:"cursor-hand",on:{click:function(s){t.removeStep(a.id,e.id)}}},[s("Icon",{attrs:{type:"ios-close",size:20}})],1)],1),t._v(" "),s("div",[s("Row",{staticStyle:{"margin-bottom":"16px"}},[s("i-col",{staticStyle:{"text-align":"right","padding-right":"16px"},attrs:{span:"3"}},[s("span",[t._v("用途")])]),t._v(" "),s("i-col",{attrs:{span:"21",offset:"-4"}},[s("Input",{attrs:{placeholder:"步骤用途"},model:{value:a.purpose_name,callback:function(e){t.$set(a,"purpose_name",e)},expression:"step.purpose_name"}})],1)],1),t._v(" "),s("Row",{staticStyle:{"margin-bottom":"16px"}},[s("i-col",{staticStyle:{"text-align":"right","padding-right":"16px"},attrs:{span:"3"}},[t._v("命令行")]),t._v(" "),s("i-col",{attrs:{span:"21",offset:"-4"}},[s("Input",{attrs:{type:"textarea",rows:t.rowLength,placeholder:"脚本内容"},on:{"on-focus":t.onFocus},model:{value:a.step_config.command_line,callback:function(e){t.$set(a.step_config,"command_line",e)},expression:"step.step_config.command_line"}})],1)],1),t._v(" "),s("Row",{staticStyle:{"margin-bottom":"16px"}},[s("i-col",{staticStyle:{"text-align":"right","padding-right":"16px"},attrs:{span:"3"}},[t._v("上传文件")]),t._v(" "),s("i-col",{attrs:{span:"21",offset:"-4"}},[s("Input",{attrs:{type:"text",placeholder:"上传文件路径，多个文件以逗号隔开。支持通配符上传。"},model:{value:a.step_config.upload_file_path,callback:function(e){t.$set(a.step_config,"upload_file_path",e)},expression:"step.step_config.upload_file_path"}})],1)],1)],1)]):t._e(),t._v(" "),4===a.step_config.step_id?s("Card",{staticStyle:{"margin-bottom":"16px"},attrs:{"dis-hover":""}},[s("div",{attrs:{slot:"title"},slot:"title"},[s("span",[s("Icon",{attrs:{type:"ios-navigate-outline"}})],1),t._v(" "),s("span",[t._v("\n                        "+t._s(a.step_config.step_name)+"\n                      ")])]),t._v(" "),s("div",{attrs:{slot:"extra"},slot:"extra"},[s("i-switch",{model:{value:a.is_on,callback:function(e){t.$set(a,"is_on",e)},expression:"step.is_on"}},[s("span",{attrs:{slot:"open"},slot:"open"},[t._v("on")]),t._v(" "),s("span",{attrs:{slot:"close"},slot:"close"},[t._v("off")])]),t._v(" "),s("span",{staticClass:"cursor-hand",on:{click:function(s){t.removeStep(a.id,e.id)}}},[s("Icon",{attrs:{type:"ios-close",size:20}})],1)],1),t._v(" "),s("div",[s("Row",{staticStyle:{"margin-bottom":"16px"}},[s("i-col",{staticStyle:{"text-align":"right","padding-right":"16px"},attrs:{span:"3"}},[s("span",[t._v("用途")])]),t._v(" "),s("i-col",{attrs:{span:"21",offset:"-4"}},[s("Input",{attrs:{placeholder:"步骤用途"},model:{value:a.purpose_name,callback:function(e){t.$set(a,"purpose_name",e)},expression:"step.purpose_name"}})],1)],1),t._v(" "),s("Row",{staticStyle:{"margin-bottom":"16px"}},[s("i-col",{staticStyle:{"text-align":"right","padding-right":"16px"},attrs:{span:"3"}},[t._v("AppName "),s("span",{staticStyle:{color:"red"}},[t._v("*")])]),t._v(" "),s("i-col",{attrs:{span:"21",offset:"-4"}},[s("Input",{attrs:{type:"text",rows:t.rowLength,placeholder:"IOS app name(扫码安装必填)"},model:{value:a.step_config.app_name,callback:function(e){t.$set(a.step_config,"app_name",e)},expression:"step.step_config.app_name"}})],1)],1),t._v(" "),s("Row",{staticStyle:{"margin-bottom":"16px"}},[s("i-col",{staticStyle:{"text-align":"right","padding-right":"16px"},attrs:{span:"3"}},[t._v("AppID\n                          "),s("span",{staticStyle:{color:"red"}},[t._v("*")])]),t._v(" "),s("i-col",{attrs:{span:"21",offset:"-4"}},[s("Input",{attrs:{type:"text",rows:t.rowLength,placeholder:"IOS app id(扫码安装必填)"},model:{value:a.step_config.app_id,callback:function(e){t.$set(a.step_config,"app_id",e)},expression:"step.step_config.app_id"}})],1)],1),t._v(" "),s("Row",{staticStyle:{"margin-bottom":"16px"}},[s("i-col",{staticStyle:{"text-align":"right","padding-right":"16px"},attrs:{span:"3"}},[t._v("Bundle-Version "),s("span",{staticStyle:{color:"red"}},[t._v("*")])]),t._v(" "),s("i-col",{attrs:{span:"21",offset:"-4"}},[s("Input",{attrs:{type:"text",rows:t.rowLength,placeholder:"IOS bundle version(扫码安装必填)"},model:{value:a.step_config.bundle_version,callback:function(e){t.$set(a.step_config,"bundle_version",e)},expression:"step.step_config.bundle_version"}})],1)],1),t._v(" "),s("Row",{staticStyle:{"margin-bottom":"16px"}},[s("i-col",{staticStyle:{"text-align":"right","padding-right":"16px"},attrs:{span:"3"}},[t._v("构建命令")]),t._v(" "),s("i-col",{attrs:{span:"21",offset:"-4"}},[s("Input",{attrs:{type:"textarea",rows:t.rowLength,placeholder:"构建命令行"},on:{"on-focus":t.onFocus},model:{value:a.step_config.command_line,callback:function(e){t.$set(a.step_config,"command_line",e)},expression:"step.step_config.command_line"}})],1)],1),t._v(" "),s("Row",{staticStyle:{"margin-bottom":"16px"}},[s("i-col",{staticStyle:{"text-align":"right","padding-right":"16px"},attrs:{span:"3"}},[t._v("输出目录")]),t._v(" "),s("i-col",{attrs:{span:"21",offset:"-4"}},[s("Input",{attrs:{type:"text",placeholder:"构建产物输出路径，多个文件以逗号隔开。支持通配符上传。"},model:{value:a.step_config.upload_file_path,callback:function(e){t.$set(a.step_config,"upload_file_path",e)},expression:"step.step_config.upload_file_path"}})],1)],1)],1)]):t._e(),t._v(" "),5===a.step_config.step_id?s("Card",{staticStyle:{"margin-bottom":"16px"},attrs:{"dis-hover":""}},[s("div",{attrs:{slot:"title"},slot:"title"},[s("span",[s("Icon",{attrs:{type:"ios-navigate-outline"}})],1),t._v(" "),s("span",[t._v("\n                        "+t._s(a.step_config.step_name)+"\n                      ")])]),t._v(" "),s("div",{attrs:{slot:"extra"},slot:"extra"},[s("i-switch",{model:{value:a.is_on,callback:function(e){t.$set(a,"is_on",e)},expression:"step.is_on"}},[s("span",{attrs:{slot:"open"},slot:"open"},[t._v("on")]),t._v(" "),s("span",{attrs:{slot:"close"},slot:"close"},[t._v("off")])]),t._v(" "),s("span",{staticClass:"cursor-hand",on:{click:function(s){t.removeStep(a.id,e.id)}}},[s("Icon",{attrs:{type:"ios-close",size:20}})],1)],1),t._v(" "),s("div",[s("Row",{staticStyle:{"margin-bottom":"16px"}},[s("i-col",{staticStyle:{"text-align":"right","padding-right":"16px"},attrs:{span:"3"}},[s("span",[t._v("用途")])]),t._v(" "),s("i-col",{attrs:{span:"21",offset:"-4"}},[s("Input",{attrs:{placeholder:"步骤用途"},model:{value:a.purpose_name,callback:function(e){t.$set(a,"purpose_name",e)},expression:"step.purpose_name"}})],1)],1),t._v(" "),s("Row",{staticStyle:{"margin-bottom":"16px"}},[s("i-col",{staticStyle:{"text-align":"right","padding-right":"16px"},attrs:{span:"3"}},[t._v("构建命令行")]),t._v(" "),s("i-col",{attrs:{span:"21",offset:"-4"}},[s("Input",{attrs:{type:"textarea",rows:t.rowLength,placeholder:"脚本内容"},on:{"on-focus":t.onFocus},model:{value:a.step_config.command_line,callback:function(e){t.$set(a.step_config,"command_line",e)},expression:"step.step_config.command_line"}})],1)],1),t._v(" "),s("Row",{staticStyle:{"margin-bottom":"16px"}},[s("i-col",{staticStyle:{"text-align":"right","padding-right":"16px"},attrs:{span:"3"}},[t._v("输出目录")]),t._v(" "),s("i-col",{attrs:{span:"21",offset:"-4"}},[s("Input",{attrs:{type:"text",placeholder:"上传文件路径，多个文件以逗号隔开。支持通配符上传。"},model:{value:a.step_config.upload_file_path,callback:function(e){t.$set(a.step_config,"upload_file_path",e)},expression:"step.step_config.upload_file_path"}})],1)],1)],1)]):t._e(),t._v(" "),6===a.step_config.step_id?s("Card",{staticStyle:{"margin-bottom":"16px"},attrs:{"dis-hover":""}},[s("div",{attrs:{slot:"title"},slot:"title"},[s("span",[s("Icon",{attrs:{type:"ios-navigate-outline"}})],1),t._v(" "),s("span",[t._v("\n                        "+t._s(a.step_config.step_name)+"\n                      ")])]),t._v(" "),s("div",{attrs:{slot:"extra"},slot:"extra"},[s("i-switch",{model:{value:a.is_on,callback:function(e){t.$set(a,"is_on",e)},expression:"step.is_on"}},[s("span",{attrs:{slot:"open"},slot:"open"},[t._v("on")]),t._v(" "),s("span",{attrs:{slot:"close"},slot:"close"},[t._v("off")])]),t._v(" "),s("span",{staticClass:"cursor-hand",on:{click:function(s){t.removeStep(a.id,e.id)}}},[s("Icon",{attrs:{type:"ios-close",size:20}})],1)],1),t._v(" "),s("div",[s("Row",{staticStyle:{"margin-bottom":"16px"}},[s("i-col",{staticStyle:{"text-align":"right","padding-right":"16px"},attrs:{span:"3"}},[s("span",[t._v("用途")])]),t._v(" "),s("i-col",{attrs:{span:"21",offset:"-4"}},[s("Input",{attrs:{placeholder:"步骤用途"},model:{value:a.purpose_name,callback:function(e){t.$set(a,"purpose_name",e)},expression:"step.purpose_name"}})],1)],1),t._v(" "),s("Row",{staticStyle:{"margin-bottom":"16px"}},[s("i-col",{staticStyle:{"text-align":"right","padding-right":"16px"},attrs:{span:"3"}},[t._v("用例")]),t._v(" "),s("i-col",{attrs:{span:"21",offset:"-4"}},[s("Select",{attrs:{multiple:"",placeholder:"选择用例集合"},model:{value:a.step_config.autocase_filter,callback:function(e){t.$set(a.step_config,"autocase_filter",e)},expression:"step.step_config.autocase_filter"}},t._l(t.caseTags,function(e){return s("Option",{key:e.id,attrs:{value:e.id}},[t._v(t._s(e.TagName)+"("+t._s(e.TagDesc)+")")])}))],1)],1),t._v(" "),s("Row",{staticStyle:{"margin-bottom":"16px"}},[s("i-col",{staticStyle:{"text-align":"right","padding-right":"16px"},attrs:{span:"3"}},[t._v("项目目录:")]),t._v(" "),s("i-col",{attrs:{span:"21",offset:"-4"}},[s("Input",{attrs:{type:"text",placeholder:"本地目录"},model:{value:a.step_config.project_root_dir,callback:function(e){t.$set(a.step_config,"project_root_dir",e)},expression:"step.step_config.project_root_dir"}})],1)],1),t._v(" "),s("Row",{staticStyle:{"margin-bottom":"16px"}},[s("i-col",{staticStyle:{"text-align":"right","padding-right":"16px"},attrs:{span:"3"}},[t._v("上传文件")]),t._v(" "),s("i-col",{attrs:{span:"21",offset:"-4"}},[s("Input",{attrs:{type:"text",placeholder:"上传文件路径，多个文件以逗号隔开。支持通配符上传。"},model:{value:a.step_config.upload_file_path,callback:function(e){t.$set(a.step_config,"upload_file_path",e)},expression:"step.step_config.upload_file_path"}})],1)],1)],1)]):t._e(),t._v(" "),7===a.step_config.step_id?s("Card",{staticStyle:{"margin-bottom":"16px"},attrs:{"dis-hover":""}},[s("div",{attrs:{slot:"title"},slot:"title"},[s("span",[s("Icon",{attrs:{type:"ios-navigate-outline"}})],1),t._v(" "),s("span",[t._v("\n                        "+t._s(a.step_config.step_name)+"\n                      ")])]),t._v(" "),s("div",{attrs:{slot:"extra"},slot:"extra"},[s("i-switch",{model:{value:a.is_on,callback:function(e){t.$set(a,"is_on",e)},expression:"step.is_on"}},[s("span",{attrs:{slot:"open"},slot:"open"},[t._v("on")]),t._v(" "),s("span",{attrs:{slot:"close"},slot:"close"},[t._v("off")])]),t._v(" "),s("span",{staticClass:"cursor-hand",on:{click:function(s){t.removeStep(a.id,e.id)}}},[s("Icon",{attrs:{type:"ios-close",size:20}})],1)],1),t._v(" "),s("div",[s("Row",{staticStyle:{"margin-bottom":"16px"}},[s("i-col",{staticStyle:{"text-align":"right","padding-right":"16px"},attrs:{span:"3"}},[s("span",[t._v("用途")])]),t._v(" "),s("i-col",{attrs:{span:"21",offset:"-4"}},[s("Input",{attrs:{placeholder:"步骤用途"},model:{value:a.purpose_name,callback:function(e){t.$set(a,"purpose_name",e)},expression:"step.purpose_name"}})],1)],1),t._v(" "),s("Row",{staticStyle:{"margin-bottom":"16px"}},[s("i-col",{staticStyle:{"text-align":"right","padding-right":"16px"},attrs:{span:"3"}},[t._v("用例")]),t._v(" "),s("i-col",{attrs:{span:"21",offset:"-4"}},[s("Select",{attrs:{multiple:"",placeholder:"选择用例集合"},model:{value:a.step_config.autocase_filter,callback:function(e){t.$set(a.step_config,"autocase_filter",e)},expression:"step.step_config.autocase_filter"}},t._l(t.caseTags,function(e){return s("Option",{key:e.id,attrs:{value:e.id}},[t._v(t._s(e.TagName)+"("+t._s(e.TagDesc)+")")])}))],1)],1),t._v(" "),s("Row",{staticStyle:{"margin-bottom":"16px"}},[s("i-col",{staticStyle:{"text-align":"right","padding-right":"16px"},attrs:{span:"3"}},[t._v("项目目录:")]),t._v(" "),s("i-col",{attrs:{span:"21",offset:"-4"}},[s("Input",{attrs:{type:"text",placeholder:"本地目录"},model:{value:a.step_config.project_root_dir,callback:function(e){t.$set(a.step_config,"project_root_dir",e)},expression:"step.step_config.project_root_dir"}})],1)],1),t._v(" "),s("Row",{staticStyle:{"margin-bottom":"16px"}},[s("i-col",{staticStyle:{"text-align":"right","padding-right":"16px"},attrs:{span:"3"}},[t._v("上传文件")]),t._v(" "),s("i-col",{attrs:{span:"21",offset:"-4"}},[s("Input",{attrs:{type:"text",placeholder:"上传文件路径，多个文件以逗号隔开。支持通配符上传。"},model:{value:a.step_config.upload_file_path,callback:function(e){t.$set(a.step_config,"upload_file_path",e)},expression:"step.step_config.upload_file_path"}})],1)],1)],1)]):t._e(),t._v(" "),8===a.step_config.step_id?s("Card",{staticStyle:{"margin-bottom":"16px"},attrs:{"dis-hover":""}},[s("div",{attrs:{slot:"title"},slot:"title"},[s("span",[s("Icon",{attrs:{type:"ios-navigate-outline"}})],1),t._v(" "),s("span",[t._v("\n                        "+t._s(a.step_config.step_name)+"\n                      ")])]),t._v(" "),s("div",{attrs:{slot:"extra"},slot:"extra"},[s("i-switch",{model:{value:a.is_on,callback:function(e){t.$set(a,"is_on",e)},expression:"step.is_on"}},[s("span",{attrs:{slot:"open"},slot:"open"},[t._v("on")]),t._v(" "),s("span",{attrs:{slot:"close"},slot:"close"},[t._v("off")])]),t._v(" "),s("span",{staticClass:"cursor-hand",on:{click:function(s){t.removeStep(a.id,e.id)}}},[s("Icon",{attrs:{type:"ios-close",size:20}})],1)],1),t._v(" "),s("div",[s("Row",{staticStyle:{"margin-bottom":"16px"}},[s("i-col",{staticStyle:{"text-align":"right","padding-right":"16px"},attrs:{span:"3"}},[s("span",[t._v("用途")])]),t._v(" "),s("i-col",{attrs:{span:"21",offset:"-4"}},[s("Input",{attrs:{placeholder:"步骤用途"},model:{value:a.purpose_name,callback:function(e){t.$set(a,"purpose_name",e)},expression:"step.purpose_name"}})],1)],1),t._v(" "),s("Row",{staticStyle:{"margin-bottom":"16px"}},[s("i-col",{staticStyle:{"text-align":"right","padding-right":"16px"},attrs:{span:"3"}},[t._v("服务器IP:")]),t._v(" "),s("i-col",{attrs:{span:"21",offset:"-4"}},[s("Input",{attrs:{type:"text",placeholder:"*.*.*.*"},model:{value:a.step_config.target_server,callback:function(e){t.$set(a.step_config,"target_server",e)},expression:"step.step_config.target_server"}})],1)],1),t._v(" "),s("Row",{staticStyle:{"margin-bottom":"16px"}},[s("i-col",{staticStyle:{"text-align":"right","padding-right":"16px"},attrs:{span:"3"}},[t._v("SSH 端口:")]),t._v(" "),s("i-col",{attrs:{span:"21",offset:"-4"}},[s("Input",{attrs:{type:"text",placeholder:"默认22"},model:{value:a.step_config.ssh_port,callback:function(e){t.$set(a.step_config,"ssh_port",e)},expression:"step.step_config.ssh_port"}})],1)],1),t._v(" "),s("Row",{staticStyle:{"margin-bottom":"16px"}},[s("i-col",{staticStyle:{"text-align":"right","padding-right":"16px"},attrs:{span:"3"}},[t._v("User:")]),t._v(" "),s("i-col",{attrs:{span:"21",offset:"-4"}},[s("Input",{attrs:{type:"text",placeholder:"远程登录用户"},model:{value:a.step_config.user,callback:function(e){t.$set(a.step_config,"user",e)},expression:"step.step_config.user"}})],1)],1),t._v(" "),s("Row",{staticStyle:{"margin-bottom":"16px"}},[s("i-col",{staticStyle:{"text-align":"right","padding-right":"16px"},attrs:{span:"3"}},[t._v("Password:")]),t._v(" "),s("i-col",{attrs:{span:"21",offset:"-4"}},[s("Input",{attrs:{type:"password",placeholder:"远程用户密码"},model:{value:a.step_config.password,callback:function(e){t.$set(a.step_config,"password",e)},expression:"step.step_config.password"}})],1)],1),t._v(" "),s("Row",{staticStyle:{"margin-bottom":"16px"}},[s("i-col",{staticStyle:{"text-align":"right","padding-right":"16px"},attrs:{span:"3"}},[t._v("SSHKey:")]),t._v(" "),s("i-col",{attrs:{span:"21",offset:"-4"}},[s("Input",{attrs:{type:"textarea",placeholder:"待推送文件本地相对路径"},model:{value:a.step_config.ssh_key,callback:function(e){t.$set(a.step_config,"ssh_key",e)},expression:"step.step_config.ssh_key"}})],1)],1),t._v(" "),s("Row",{staticStyle:{"margin-bottom":"16px"}},[s("i-col",{staticStyle:{"text-align":"right","padding-right":"16px"},attrs:{span:"3"}},[t._v("远程服务器目录:")]),t._v(" "),s("i-col",{attrs:{span:"21",offset:"-4"}},[s("Input",{attrs:{type:"text",placeholder:"文件远程目录"},model:{value:a.step_config.target_dir,callback:function(e){t.$set(a.step_config,"target_dir",e)},expression:"step.step_config.target_dir"}})],1)],1),t._v(" "),s("Row",{staticStyle:{"margin-bottom":"16px"}},[s("i-col",{staticStyle:{"text-align":"right","padding-right":"16px"},attrs:{span:"3"}},[t._v("命令行")]),t._v(" "),s("i-col",{attrs:{span:"21",offset:"-4"}},[s("Input",{attrs:{type:"textarea",rows:t.rowLength,placeholder:"脚本内容"},on:{"on-focus":t.onFocus},model:{value:a.step_config.command_line,callback:function(e){t.$set(a.step_config,"command_line",e)},expression:"step.step_config.command_line"}})],1)],1)],1)]):t._e()],1)}))],1)],1)])})],2)])],1),t._v(" "),s("div",{staticStyle:{position:"fixed",bottom:"10px",left:"60%"}},[s("span",{on:{click:function(e){t.saveTaskConfig("ciTaskBasicCreate")}}},[s("Icon",{staticClass:"cursor-hand",attrs:{type:"ios-checkmark-circle",color:"#32be77",size:"50"}})],1)])],1)},staticRenderFns:[]};var _=s("VU/8")(g,h,!1,function(t){s("gR3i")},"data-v-12a53fd3",null).exports,f=s("K/ko"),m={components:{ICol:n.a},name:"CITaskHistoryList",props:["taskID"],data:function(){return{tagLeft:"100px;",show:!1,historyList:[],nextHistoryListUrl:null,selectStageHistory:null,showLoading:!0,qrCodeShow:!1,selectTaskQueueID:0,selectTaskUUID:0}},computed:o()({},Object(i.c)(["appBodyHeight","userInfo"]),Object(i.c)("citask",["ciTaskStart"]),{containerHeight:function(){return this.appBodyHeight-60}}),methods:o()({},Object(i.d)("citask",["setCITaskStart"]),{closeRunDetail:function(t,e){for(var s=0;s<this.historyList.length;s++)if(this.historyList[s].id===t)for(var a=0;a<this.historyList[s].StageHistory.length;a++)this.historyList[s].StageHistory[a].id===e&&(this.historyList[s].StageHistory[a].ViewFormat.Show=!1)},showRunDetail:function(t,e,s){for(var a=document.getElementById("stepContainer_"+e.id).offsetWidth,o=0;o<this.historyList.length;o++)if(this.historyList[o].id===t.id)for(var i=0;i<this.historyList[o].StageHistory.length;i++)this.historyList[o].StageHistory[i].ViewFormat.Show=!1,this.historyList[o].StageHistory[i].id===e.id&&(this.historyList[o].StageHistory[i].ViewFormat.Show=!0),this.historyList[o].StageHistory[i].ViewFormat.TagLeft=s*a+40+"px"},showLog:function(t){this.$emit("showLogDetail",t)},showTestResult:function(t,e,s){this.$emit("showTestResult",t,e,s)},getHistoryList:function(t){var e=this;this.showLoading=!0,this.$axios.get("/api/ci/task/"+this.taskID+"/task_histories/?page_size=100").then(function(t){e.showLoading=!1,e.historyList=t.data.result.all_histories.results,e.nextHistoryListUrl=t.data.result.all_histories.next,e.initHistoryList(e.historyList)},function(t){})},initHistoryList:function(t){for(var e=0;e<this.historyList.length;e++){this.historyList[e].show=!1;for(var s=0;s<t[e].StageHistory.length;s++);}},handleReachBottom:function(){var t=this;null!==this.nextHistoryListUrl?this.$axios.get(this.nextHistoryListUrl).then(function(e){t.historyList.push(e.data.result.all_histories.results),t.nextHistoryListUrl=e.data.result.all_histories.next},function(t){}):this.$Message.warning({content:"没有更多历史记录了",duration:10,closable:!0})},downloadPackage:function(t,e){var s="/api/ci/task/output/"+t+"/download";this.$axios({url:s,method:"get",responseType:"arraybuffer"}).then(function(t){var s=window.URL.createObjectURL(new Blob([t.data],{type:"application/octet-stream"})),a=document.createElement("a");a.style.display="none",a.href=s,a.setAttribute("download",e),document.body.appendChild(a),a.click(),a.remove()},function(t){})}}),created:function(){this.getHistoryList(this.taskID)},watch:{taskID:function(t){this.getHistoryList(t)},ciTaskStart:function(t){t&&(this.getHistoryList(this.taskID),this.setCITaskStart(!1))}},componets:{CILogShowDialog:f.a}},v={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[t.showLoading?s("Spin",{attrs:{fix:"",size:"large"}}):t._e(),t._v(" "),s("Scroll",{attrs:{"on-reach-bottom":t.handleReachBottom,height:t.containerHeight}},t._l(t.historyList,function(e){return s("div",[s("Card",{staticClass:"history-card",attrs:{bordered:!1,"dis-hover":"",shadow:""}},[s("Row",[s("i-col",{staticStyle:{width:"80px","margin-right":"5px"},attrs:{span:"2"}},[4===e.Status?s("Icon",{staticStyle:{color:"darkred"},attrs:{type:"ios-close-circle",size:20}}):t._e(),t._v(" "),1===e.Status?s("span",[s("Spin",{staticStyle:{display:"inline-block","margin-right":"0px"}})],1):t._e(),t._v(" "),2===e.Status?s("Icon",{staticStyle:{color:"#388e83"},attrs:{type:"ios-checkmark-circle",size:20}}):t._e(),t._v(" "),3===e.Status?s("Icon",{staticStyle:{color:"olive"},attrs:{type:"ios-remove-circle",size:20}}):t._e(),t._v(" "),0===e.Status?s("Icon",{staticStyle:{color:"darkblue"},attrs:{type:"ios-time",size:20}}):t._e(),t._v("\n            #"+t._s(e.BuildVersion)+"\n          ")],1),t._v(" "),s("i-col",{attrs:{span:"22"}},[s("Steps",{attrs:{current:e.ViewFormat.CurrentStageIndex,status:"process",size:"small"}},t._l(e.StageHistory,function(a,o){return s("Step",{key:a.id,staticClass:"cursor-hand",attrs:{id:"stepContainer_"+a.id,title:a.ViewFormat.StageName,status:a.ViewFormat.Status,content:""},nativeOn:{click:function(s){t.showRunDetail(e,a,o)}}})})),t._v(" "),s("Row",[s("i-col",{staticStyle:{"padding-left":"30px","padding-bottom":"0px","padding-top":"5px",color:"#c5c8ce","font-size":"12px"}},[s("span",[t._v("由 "+t._s(e.ViewFormat.StartBy)+" 触发")]),t._v(" "),s("span",[t._v(t._s(e.ViewFormat.StartTime)+"开始")]),t._v(" "),s("span",[t._v("在Agent "+t._s(e.ViewFormat.AgentName)+"上执行")]),t._v(" "),s("span",[t._v("持续"+t._s(e.ViewFormat.Duration))])])],1),t._v(" "),t._l(e.StageHistory,function(a){return a.ViewFormat.Show?s("div",{staticClass:"tag"},[s("em",{staticClass:"tag-em",style:"left:"+a.ViewFormat.TagLeft}),t._v(" "),s("span",{staticClass:"tag-span",style:"left:"+a.ViewFormat.TagLeft}),t._v(" "),s("div",[s("Row",[s("i-col",{staticStyle:{"padding-left":"10px","padding-bottom":"10px"}},[s("span",{staticClass:"cursor-hand",staticStyle:{color:"#515a6e","text-decoration":"underline"},on:{click:function(s){t.closeRunDetail(e.id,a.id)}}},[t._v("收起 "),s("Icon",{attrs:{type:"ios-close"}})],1),t._v(" "),s("span",[t._v("本阶段持续时间："+t._s(a.ViewFormat.Duration))]),t._v(" "),s("span",{staticStyle:{"text-decoration":"underline",cursor:"pointer","padding-left":"20px"},on:{click:function(e){t.showLog(a.id)}}},[t._v("阶段日志")]),t._v(" "),t._l(a.ViewFormat.StageOutputCodeVersion,function(e){return s("span",{key:e.version,staticStyle:{"text-decoration":"underline",cursor:"pointer","padding-left":"20px"}},[s("span",[t._v(t._s(e.repo))]),t._v(" "),s("span",[t._v(t._s(e.version))])])})],2)],1),t._v(" "),s("div",[t._l(a.ViewFormat.TestResults,function(e){return s("Row",{key:e.id},[s("i-col",{staticStyle:{padding:"10px"},attrs:{span:"24"}},[s("span",{staticStyle:{"padding-right":"10px"}},[t._v("["+t._s(e.purpose_name)+"] 测试结果:")]),t._v(" "),s("span",[s("Tooltip",{attrs:{content:"成功"}},[s("Tag",{staticStyle:{"text-decoration":"underline"},attrs:{color:"success"},nativeOn:{click:function(s){t.showTestResult(a.id,e.result_id,e.purpose_name)}}},[t._v(t._s(e.pass))])],1),t._v(" "),s("Tooltip",{attrs:{content:"失败"}},[s("Tag",{staticStyle:{"text-decoration":"underline"},attrs:{color:"error"},nativeOn:{click:function(s){t.showTestResult(a.id,e.result_id,e.purpose_name)}}},[t._v(t._s(e.fail))])],1),t._v(" "),s("Tooltip",{attrs:{content:"未执行"}},[s("Tag",{staticStyle:{"text-decoration":"underline"},attrs:{color:"warning"},nativeOn:{click:function(s){t.showTestResult(a.id,e.result_id,e.purpose_name)}}},[t._v(t._s(e.aborted))])],1)],1)])],1)}),t._v(" "),s("Row",t._l(a.ViewFormat.StageOutputPackage,function(e){return s("i-col",{key:e.id,attrs:{span:"3"}},[s("span",{staticClass:"product-container"},[s("span",{staticStyle:{display:"block"}},[s("div",[t._v(t._s(e.product_name))]),t._v(" "),s("div",{staticStyle:{width:"80px","margin-right":"auto","margin-left":"auto"}},[s("img",{staticStyle:{height:"80px",width:"80px","border-radius":"10px"},attrs:{src:"/api/ci/task/output/"+e.id+"/qrcode"}})])]),t._v(" "),s("span",{staticStyle:{display:"block",width:"30px","margin-right":"auto","margin-left":"auto"}},[s("span",{staticStyle:{"text-decoration":"underline",cursor:"pointer"},on:{click:function(s){t.downloadPackage(e.id,e.product_name)}}},[t._v("下载")])])])])}))],2),t._v(" "),s("Row",[s("i-col",{staticStyle:{"padding-left":"10px","padding-top":"5px"}},t._l(a.ViewFormat.StageOutputCodeVersion,function(e){return s("span",{key:e.id},t._l(e.commit_info,function(e){return s("div",{staticStyle:{color:"#999999"}},[s("span",{staticStyle:{"margin-right":"20px"}},[t._v(t._s(e.code_repo))]),t._v(" "),s("span",{staticStyle:{"margin-right":"20px"}},[t._v(t._s(e.version))])])}))}))],1)],1)]):t._e()})],2)],1)],1)],1)})),t._v(" "),s("c-i-log-show-dialog",{attrs:{taskID:t.taskID,taskUUID:t.selectTaskUUID,tqID:t.selectTaskQueueID}})],1)},staticRenderFns:[]};var y=s("VU/8")(m,v,!1,function(t){s("Wn1i")},"data-v-3c58b8bc",null).exports,x={components:{ICol:n.a},name:"CITaskStageLog",props:["stageHistoryID"],data:function(){return{steplogs:[],showLoading:!1}},computed:o()({},Object(i.c)(["appBodyHeight","userInfo"]),{containerHeight:function(){return this.appBodyHeight-163}}),methods:{getStepLogs:function(t){var e=this;this.$axios.get("/api/ci/task/stage_history/"+t+"/logs").then(function(t){e.steplogs=t.data.result},function(t){})},loadStepLog:function(t){for(var e=this,s=0;s<this.steplogs.length;s++)if(this.steplogs[s].id===t){this.showLoading=!0,this.steplogs[s].log_content="";break}this.$axios.get("/api/ci/task/output/"+t+"/log").then(function(s){for(var a=0;a<e.steplogs.length;a++)if(e.steplogs[a].id===t){e.steplogs[a].log_content=s.data.result.log_content,e.steplogs[a].show_content=!1,e.showLoading=!1;break}},function(t){})}},created:function(){this.steplogs=[],this.showLoading=!1,this.getStepLogs(this.stageHistoryID)},watch:{stageHistoryID:function(t){this.steplogs=[],this.showLoading=!1,this.getStepLogs(t)}}},k={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("Row",{attrs:{gutter:16}},[s("i-col",{attrs:{span:"6"}},[s("Card",{attrs:{shadow:!1,"dis-hover":!0}},[s("div",{attrs:{slot:"title"},slot:"title"},[t._v("本阶段步骤")]),t._v(" "),s("div",{style:"max-height:"+t.containerHeight+"px;overflow-y:auto"},[s("Anchor",{staticStyle:{"margin-left":"5px"},attrs:{"show-ink":"",bounds:15,container:".stageLogContainer"}},t._l(t.steplogs,function(t){return s("AnchorLink",{key:t.id,staticStyle:{height:"80px"},attrs:{href:"#log_container"+t.id,title:t.step_name}})}))],1)])],1),t._v(" "),s("i-col",{attrs:{span:"18"}},[s("Card",{attrs:{shadow:!1,"dis-hover":!0}},[s("div",{attrs:{slot:"title"},slot:"title"},[t._v("阶段日志")]),t._v(" "),s("div",{staticClass:"stageLogContainer",style:"word-break: normal;white-space: normal;height:"+t.containerHeight+"px;overflow-y:scroll"},t._l(t.steplogs,function(e){return s("div",{key:e.id,staticStyle:{"min-height":"400px"},attrs:{id:"log_container"+e.id}},[s("Divider",{attrs:{orientation:"left"}},[t._v(t._s(e.step_name)+"\n            "),e.show_content?t._e():s("span",{staticStyle:{"margin-left":"20px"}},[s("Button",{attrs:{type:"primary",ghost:"",shape:"circle",size:"small",loading:t.showLoading},on:{click:function(s){t.loadStepLog(e.id)}}},[t.showLoading?s("span",[t._v("加载中....")]):s("span",{staticStyle:{"text-decoration":"underline"}},[t._v("加载日志")])])],1)]),t._v(" "),s("div",{staticStyle:{"background-color":"black",color:"limegreen"},domProps:{innerHTML:t._s(e.log_content)}})],1)}))])],1)],1)},staticRenderFns:[]};var w=s("VU/8")(x,k,!1,function(t){s("x9jo")},"data-v-b859c874",null).exports,b={name:"CITaskParameterGroup",props:["parameterGroups","taskID"],data:function(){return{parameterGroupList:[],formData:{task_id:0,group_name:"",is_default:!1,parameters:[],step_plugin_settings:[],description:""}}},computed:o()({},Object(i.c)(["appBodyHeight","userInfo"]),Object(i.c)("projectglobal",["createDocumentType"]),Object(i.c)("document",["breadNav"]),{containerHeight:function(){return this.appBodyHeight}}),methods:o()({},Object(i.d)("projectglobal",["setCreateDocumentType","setCreateDialogShow"]),{createGroup:function(){var t=this;this.formData.task_id=this.taskID,""!==this.formData.group_name.trim()&&this.$axios.post("/api/ci/task/"+this.taskID+"/parameter_groups/",this.formData).then(function(e){t.parameterGroupList.push(e.data.result),t.$Message.success({content:"参数组添加成功",duration:10,closable:!0}),t.formData.group_name=""},function(e){t.$Message.error({content:"参数组添加失败",duration:10,closable:!0})})},processGroupOperation:function(t){var e=t.split(":");"delete"===e[2]&&this.deleteGroup(e[0],e[1]),"copy"===e[2]&&this.copyGroup(e[0])},copyGroup:function(t){var e=this;this.$axios.post("/api/ci/task/parameter_group/"+t+"/copy").then(function(t){e.parameterGroupList.push(t.data.result),e.$Message.success({content:"参数组复制成功",duration:10,closable:!0}),e.formData.group_name=""},function(t){e.$Message.error({content:"参数组复制失败",duration:10,closable:!0})})},deleteGroup:function(t,e){var s=this;this.$Modal.confirm({title:"删除确认",content:"您即将删除参数组["+e+"]",onOk:function(){s.$axios.delete("/api/ci/task/parameter_group/"+t+"/").then(function(e){for(var a=0;a<s.parameterGroupList.length;a++)if(s.parameterGroupList[a].id===t){s.parameterGroupList.splice(a,1);break}s.$Message.success({content:"参数组删除成功",duration:10,closable:!0})},function(t){s.$Message.error({content:"参数组删除失败",duration:10,closable:!0})})},onCancel:function(){}})},showGroupDetail:function(t){this.$emit("showGroup",t)}}),created:function(){this.parameterGroupList=this.parameterGroups},mounted:function(){},watch:{parameterGroups:function(){this.parameterGroupList=this.parameterGroups},taskID:function(t){console.log(t)}},components:{labelEditorInput:d.a}},S={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticStyle:{"padding-top":"16px"}},[s("div",{staticStyle:{width:"60%","margin-left":"auto","margin-right":"auto","margin-bottom":"16px"}},[s("Input",{staticStyle:{width:"100%"},attrs:{search:"","enter-button":"添加",icon:"ios-clock-outline",maxlength:50,placeholder:"输入参数组名称，回车创建参数组"},on:{"on-search":t.createGroup},model:{value:t.formData.group_name,callback:function(e){t.$set(t.formData,"group_name",e)},expression:"formData.group_name"}})],1),t._v(" "),t._l(t.parameterGroupList,function(e){return s("Card",{key:e.id,staticClass:"member-card cursor-hand",attrs:{padding:10,bordered:!1,"dis-hover":""}},[s("Row",[s("i-col",{attrs:{xl:20,lg:20,md:18,sm:18}},[s("span",{staticStyle:{"font-weight":"bold","text-decoration":"underline"},on:{click:function(s){t.showGroupDetail(e.id)}}},[t._v("\n          "+t._s(e.group_name)+"\n        ")]),t._v(" "),e.is_default?s("span",{staticStyle:{"padding-left":"10px"}},[s("Tag",{staticClass:"member-tag",attrs:{color:"#202d40"}},[t._v("默认")])],1):t._e()]),t._v(" "),s("i-col",{attrs:{xl:4,lg:4,md:6,sm:6}},[s("span",[s("Dropdown",{attrs:{transfer:""},on:{"on-click":t.processGroupOperation}},[s("a",{staticStyle:{color:"inherit"},attrs:{href:"javascript:void(0)"}},[s("span",[s("Icon",{attrs:{size:24,type:"ios-more"}})],1)]),t._v(" "),s("DropdownMenu",{attrs:{slot:"list"},slot:"list"},[s("DropdownItem",{attrs:{name:e.id+":"+e.group_name+":delete"}},[s("Icon",{attrs:{type:"ios-trash-outline"}}),t._v(" "),s("span",[t._v("删除")])],1),t._v(" "),s("DropdownItem",{attrs:{name:e.id+":"+e.group_name+":copy"}},[s("Icon",{attrs:{type:"ios-copy"}}),t._v(" "),s("span",[t._v("复制")])],1)],1)],1)],1)])],1)],1)})],2)},staticRenderFns:[]};var I=s("VU/8")(b,S,!1,function(t){s("rCsG")},"data-v-06b06702",null).exports,C=s("VIzs"),$={name:"ParameterGroupDetail",props:["parameterGroup"],data:function(){return{pGroup:{}}},computed:o()({},Object(i.c)(["appBodyHeight","userInfo"]),Object(i.c)("citask",["ciTaskConfigChanged"]),{containerHeight:function(){return this.appBodyHeight}}),methods:o()({},Object(i.d)("projectglobal",["setCreateDocumentType","setCreateDialogShow"]),Object(i.d)("citask",["setCITaskConfigChanged"]),{saveParameterGroup:function(){var t=this;""!==this.pGroup.group_name.trim()&&this.$axios.patch("/api/ci/task/parameter_group/"+this.pGroup.id+"/",this.pGroup).then(function(e){t.$emit("saveGroup",t.pGroup),t.$Message.success({content:"参数组保存成功",duration:10,closable:!0})},function(e){t.$Message.error({content:"参数组保存失败",duration:10,closable:!0})})},addNewParameter:function(t){this.pGroup.parameters.push({key:"",value:"",description:""})},removeParameter:function(t){this.pGroup.parameters.splice(t,1)},getParameterGroup:function(t){var e=this;this.$axios.get("/api/ci/task/parameter_group/"+t).then(function(t){e.pGroup=t.data.result},function(t){})}}),created:function(){this.pGroup=this.parameterGroup},mounted:function(){},watch:{parameterGroup:function(t){this.getParameterGroup(t.id)},ciTaskConfigChanged:function(t){t&&(this.getParameterGroup(this.parameterGroup.id),this.setCITaskConfigChanged(!1))}},components:{ISwitch:C.a,ICol:n.a,labelEditorInput:d.a}},T={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{style:"height:"+t.containerHeight+"px; overflow-y:scroll;"},[s("Card",{staticClass:"member-card cursor-hand",attrs:{bordered:!1,"dis-hover":""}},[s("Form",{ref:"editGroup",attrs:{model:t.pGroup,"label-width":80}},[s("Card",{attrs:{bordered:!1,"dis-hover":""}},[s("div",{attrs:{slot:"title"},slot:"title"},[t._v(" 基本信息")]),t._v(" "),s("FormItem",{attrs:{label:"ID"}},[s("span",[t._v(t._s(t.pGroup.id))])]),t._v(" "),s("FormItem",{attrs:{label:"标题",prop:"Title"}},[s("Input",{attrs:{placeholder:"任务标题"},model:{value:t.pGroup.group_name,callback:function(e){t.$set(t.pGroup,"group_name",e)},expression:"pGroup.group_name"}})],1),t._v(" "),s("FormItem",{attrs:{label:"设置为默认"}},[s("i-switch",{model:{value:t.pGroup.is_default,callback:function(e){t.$set(t.pGroup,"is_default",e)},expression:"pGroup.is_default"}})],1),t._v(" "),s("FormItem",{attrs:{label:"描述:"}},[s("Input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:5},placeholder:"Enter something..."},model:{value:t.pGroup.description,callback:function(e){t.$set(t.pGroup,"description",e)},expression:"pGroup.description"}})],1)],1),t._v(" "),s("Card",{attrs:{bordered:!1,"dis-hover":""}},[s("div",{attrs:{slot:"title"},slot:"title"},[t._v("参数管理")]),t._v(" "),s("span",{attrs:{slot:"extra"},on:{click:t.addNewParameter},slot:"extra"},[s("Icon",{attrs:{size:24,color:"#202d40",type:"ios-add-circle"}})],1),t._v(" "),t._l(t.pGroup.parameters,function(e,a){return s("div",{staticStyle:{border:"1px solid #e8eaec",padding:"5px 16px 16px 16px",width:"100%","margin-left":"auto","margin-bottom":"16px","margin-right":"auto","border-radius":"10px"}},[s("div",{staticStyle:{height:"30px","margin-bottom":"10px"}},[s("span",[t._v(t._s(a+1))]),t._v(" "),s("span",{staticStyle:{float:"right"},on:{click:function(e){t.removeParameter(a)}}},[s("Icon",{attrs:{type:"ios-close",size:20}})],1)]),t._v(" "),s("FormItem",{attrs:{label:"Key:"}},[s("Input",{attrs:{type:"text",placeholder:"Enter something..."},model:{value:e.key,callback:function(s){t.$set(e,"key",s)},expression:"item.key"}})],1),t._v(" "),s("FormItem",{attrs:{label:"Value:"}},[s("Input",{attrs:{type:"text",placeholder:"Enter something..."},model:{value:e.value,callback:function(s){t.$set(e,"value",s)},expression:"item.value"}})],1),t._v(" "),s("FormItem",{attrs:{label:"描述:"}},[s("Input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:5},placeholder:"Enter something..."},model:{value:e.description,callback:function(s){t.$set(e,"description",s)},expression:"item.description"}})],1)],1)})],2),t._v(" "),s("Card",{attrs:{bordered:!1,"dis-hover":""}},[s("div",{attrs:{slot:"title"},slot:"title"},[t._v("插件设置")]),t._v(" "),t._l(t.pGroup.step_settings,function(e){return s("Row",{key:e.id,staticStyle:{padding:"16px"}},[s("i-col",{attrs:{span:"12"}},[s("Icon",{attrs:{type:"ios-navigate-outline"}}),t._v(" "),s("span",{staticStyle:{"min-width":"100px",display:"inline-block"}},[t._v(t._s(e.stage_title)+" ")]),t._v(" "),s("span",[t._v(t._s(e.step_name))])],1),t._v(" "),s("i-col",{attrs:{span:"8"}},[s("span",{staticStyle:{"min-width":"200px",display:"inline-block"}},[t._v("\n              "+t._s(e.desc)+"\n            ")])]),t._v(" "),s("i-col",{staticStyle:{"text-align":"right","padding-right":"20px"},attrs:{span:"4"}},[s("i-switch",{model:{value:e.is_on,callback:function(s){t.$set(e,"is_on",s)},expression:"step_setting.is_on"}})],1)],1)})],2)],1)],1),t._v(" "),s("div",{staticStyle:{position:"fixed",bottom:"30px",left:"75%"}},[s("span",{on:{click:t.saveParameterGroup}},[s("Icon",{staticClass:"cursor-hand",attrs:{type:"ios-checkmark-circle",color:"#32be77",size:"50"}})],1)])],1)},staticRenderFns:[]};var R=s("VU/8")($,T,!1,function(t){s("72jS")},"data-v-9487e278",null).exports,D=(s("504h"),{name:"TestResultDetail",props:["testResultID"],data:function(){return{testResult:{},caseResults:[],exporting:!1,columns1:[{title:"ID",key:"id",width:100,sortable:!0},{title:"描述",key:"CaseDesc"},{title:"名称",key:"TestCaseName"},{title:"结果",key:"ResultFormat",width:150,sortable:!0,render:function(t,e){var s=e.row;return t("Tag",{props:{type:"dot",color:2===s.Result?"error":3===s.Result?"success":"error",size:"small"}},s.ResultFormat)}},{title:"异常信息",key:"Exception"}],id:"testRunSummary",loadingCaseResult:!1}},computed:o()({},Object(i.c)(["appBodyHeight","userInfo"]),{containerHeight:function(){return this.appBodyHeight}}),methods:{getTestResult:function(t){var e=this;this.$axios.get("/api/ci/auto_testing_result/"+t+"/").then(function(t){e.testResult=t.data.result},function(t){})},getCaseResults:function(t,e){var s=this,a="";0!==e&&(a="&Result="+e),this.loadingCaseResult=!0,this.$axios.get("/api/ci/auto_case_results?TaskResultID="+t+a).then(function(t){s.caseResults=t.data.result,s.loadingCaseResult=!1},function(t){})},changePage:function(t){var e=this;this.$axios.get("/api/ci/auto_case_results?TaskResultID="+this.testResultID+"&page="+t).then(function(t){e.caseResults=t.data.result},function(t){})},filterCaseResult:function(t){this.getCaseResults(this.testResultID,t)},exportTestResult:function(){var t=this,e="/api/ci/task/testresult/export_case_result/"+this.testResultID;this.exporting=!0,this.$axios({url:e,method:"get",responseType:"arraybuffer"}).then(function(e){t.exporting=!1;var s=window.URL.createObjectURL(new Blob([e.data],{type:"application/vnd.ms-excel"})),a=document.createElement("a");a.style.display="none",a.href=s,a.setAttribute("download",t.testResultID+".xls"),document.body.appendChild(a),a.click(),a.remove()},function(t){})}},created:function(){this.caseResults=[],this.getTestResult(this.testResultID),this.getCaseResults(this.testResultID,0)},mounted:function(){},watch:{testResultID:function(t){this.caseResults=[],this.getTestResult(t),this.getCaseResults(t,0)}},components:{ISwitch:C.a,ICol:n.a,labelEditorInput:d.a}}),L={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{style:"height:"+t.containerHeight+"px; overflow-y:scroll;"},[s("Card",{staticClass:"member-card cursor-hand",attrs:{bordered:!1,"dis-hover":""}},[s("div",{staticStyle:{"font-weight":"500"},attrs:{slot:"title"},slot:"title"},[s("Button",{attrs:{shape:"circle",icon:"md-log-out",size:"small",loading:t.exporting},on:{click:t.exportTestResult}},[t._v("导出结果")])],1),t._v(" "),s("Row",{attrs:{type:"flex",justify:"space-between"}},[s("Col",{staticStyle:{padding:"20px",color:"#00b0ff"},attrs:{span:"6"}},[s("Card",{staticStyle:{height:"100px"},attrs:{padding:20,"dis-hover":""}},[s("div",{staticClass:"summary-number-title"},[t._v("Total:")]),t._v(" "),s("div",{staticClass:"summary-number-content"},[s("span",{staticStyle:{color:"inherit"},on:{click:function(e){t.filterCaseResult(0)}}},[t._v("\n            "+t._s(t.testResult.Total)+"\n          ")])])])],1),t._v(" "),s("Col",{staticStyle:{padding:"20px",color:"forestgreen"},attrs:{span:"6"}},[s("Card",{staticStyle:{height:"100px"},attrs:{padding:20,"dis-hover":""}},[s("div",{staticClass:"summary-number-title"},[t._v("Pass:")]),t._v(" "),s("div",{staticClass:"summary-number-content"},[s("span",{staticStyle:{color:"inherit"},on:{click:function(e){t.filterCaseResult(3)}}},[t._v("\n            "+t._s(t.testResult.Pass)+"\n          ")])])])],1),t._v(" "),s("Col",{staticStyle:{padding:"20px",color:"darkred"},attrs:{span:"6"}},[s("Card",{staticStyle:{height:"100px"},attrs:{padding:20,"dis-hover":""}},[s("div",{staticClass:"summary-number-title"},[t._v("Fail:")]),t._v(" "),s("div",{staticClass:"summary-number-content"},[s("span",{staticStyle:{color:"inherit"},on:{click:function(e){t.filterCaseResult(2)}}},[t._v("\n            "+t._s(t.testResult.Fail)+"\n          ")])])])],1),t._v(" "),s("Col",{staticStyle:{padding:"20px",color:"orange"},attrs:{span:"6"}},[s("Card",{staticStyle:{height:"100px"},attrs:{padding:20,"dis-hover":""}},[s("div",{staticClass:"summary-number-title"},[t._v("Aborted:")]),t._v(" "),s("div",{staticClass:"summary-number-content"},[s("span",{staticStyle:{color:"inherit"},on:{click:function(e){t.filterCaseResult(1)}}},[t._v("\n            "+t._s(t.testResult.Aborted)+"\n          ")])])])],1)],1)],1),t._v(" "),s("Table",{attrs:{border:"",columns:t.columns1,data:t.caseResults.results,stripe:"",loading:t.loadingCaseResult}}),t._v(" "),s("div",{staticStyle:{margin:"10px",overflow:"hidden"}},[s("div",{staticStyle:{float:"right"}},[s("Page",{attrs:{total:t.caseResults.count,current:1},on:{"on-change":t.changePage}})],1)])],1)},staticRenderFns:[]};var G=s("VU/8")(D,L,!1,function(t){s("ejD6")},"data-v-8076a4cc",null).exports,P={name:"ciTaskHistory",props:["taskID"],data:function(){return{styles:{background:"#f5f7f9"},showTaskConfig:!1,showParameterGroup:!1,showParameterGroupConfig:!1,showParameterDialog:!1,showBuildLog:!1,showTestResult:!1,taskParameterGroups:[],selectedTestResult:{resultID:0,pusposeName:""},selectedGroup:{},formItem:{},taskBasicInfo:{},selectedParameterGroup:{},taskConfigInfo:{},stageHistoryID:0,stageHistory:{ViewFormat:{StageName:""}}}},computed:o()({},Object(i.c)(["appBodyHeight","userInfo"]),{containerHeight:function(){return this.appBodyHeight-30}}),methods:o()({},Object(i.d)("citask",["setCITaskStart"]),{showParameterGroupDialog:function(t){this.showParameterDialog=!0,this.selectedParameterGroup=this.getParameterGroup(t)},getParameterGroup:function(t){for(var e={},s=0;s<this.taskBasicInfo.ParameterGroups.length;s++)if(this.taskBasicInfo.ParameterGroups[s].id===t){e=this.taskBasicInfo.ParameterGroups[s];break}return e},closeParameterDialog:function(){this.showParameterDialog=!1},startBuildWithParameter:function(t){for(var e=this,s={parameters:[]},a=0;a<this.$refs.parameterGroupDialog.$el.length;a++){var o={};o.key=this.$refs.parameterGroupDialog.$el[a].name,o.value=this.$refs.parameterGroupDialog.$el[a].value,o.description=this.$refs.parameterGroupDialog.$el[a].desc,s.parameters.push(o)}this.$axios.patch("/api/ci/task/parameter_group/"+t+"/",s).then(function(s){e.$axios.get("/api/ci/task/"+e.taskBasicInfo.id+"/start/?BuildParameter="+t).then(function(t){e.$Message.success({content:t.data.result.message,duration:10}),e.setCITaskStart(!0)},function(t){e.$Message.error({content:t.data.result.message,duration:10})})},function(t){e.$Message.error({content:t.data.result.message,duration:10})}),this.showParameterDialog=!1},configTask:function(){this.showTaskConfig=!0},parameterGroup:function(){this.showParameterGroup=!0},showLogDeail:function(t){this.showBuildLog=!0,this.stageHistoryID=t,this.getStageHistory(t)},showTestresultDeail:function(t,e,s){this.showTestResult=!0,this.stageHistoryID=t,this.selectedTestResult.resultID=e,this.selectedTestResult.pusposeName=s,this.getStageHistory(t)},switchStageLog:function(t){this.stageHistoryID=t,this.getStageHistory(t)},getTaskParameterGroups:function(){var t=this;this.$axios.get("/api/ci/task/"+this.taskID+"/parameter_groups/").then(function(e){t.taskParameterGroups=e.data.result},function(t){})},startBuildTask:function(){var t=this;this.$axios.get("/api/ci/task/"+this.taskID+"/start/").then(function(e){t.setCITaskStart(!0),t.$Message.success({content:e.data.result.message,duration:10})},function(e){t.$Message.error({content:e.data.result.message,duration:10})})},getTaskBasicInfo:function(){var t=this;this.$axios.get("/api/ci/task/"+this.taskID).then(function(e){t.taskBasicInfo=e.data.result},function(t){})},removeTask:function(t){var e=this;this.$Modal.confirm({title:"删除确认",content:"您即将删除参数组["+t+"]",onOk:function(){e.$axios.delete("/api/ci/task/"+e.taskID).then(function(t){e.$Message.success({content:"任务删除成功",duration:10,closable:!0}),e.$router.push("/ci/task")},function(t){e.$Message.error({content:"任务删除失败",duration:10,closable:!0})})},onCancel:function(){}})},saveParameterGroup:function(t){for(var e=0;e<this.taskParameterGroups.length;e++)this.taskParameterGroups[e].is_default=!1,this.taskParameterGroups[e].id===t.id&&this.taskParameterGroups.splice(e,1,t)},groupListDrawerClose:function(t){this.showParameterGroupConfig=!1},showGroup:function(t){this.showParameterGroupConfig=!0;for(var e=0;e<this.taskParameterGroups.length;e++)if(this.taskParameterGroups[e].id===t){this.selectedGroup=this.taskParameterGroups[e];break}},getStageHistory:function(t){var e=this;this.$axios.get("/api/ci/task/stage_history/"+t+"/").then(function(t){e.stageHistory=t.data.result},function(t){})}}),created:function(){this.getTaskParameterGroups(),this.getTaskBasicInfo()},wathc:{stageHistoryID:function(t){0!==t&&this.getStageHistory(t)}},components:{ICol:n.a,CiTaskStage:_,CiTaskHistoryList:y,CiTaskStageLog:w,CITaskParameterGroup:I,ParameterGroupDetail:R,CITaskTestResultDetail:G}},H={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("Card",{staticClass:"citask-card",attrs:{bordered:!1,"dis-hover":!0}},[s("span",{staticStyle:{"font-size":"16px","margin-left":"10px"}},[s("span",{staticStyle:{"padding-right":"50px","font-size":"18px","font-weight":"400"}},[t._v("任务名称："+t._s(t.taskBasicInfo.TaskName))]),t._v(" "),0===t.taskParameterGroups.length?s("Button",{staticStyle:{color:"black","margin-right":"10px"},attrs:{size:"default",shape:"circle"},on:{click:t.startBuildTask}},[t._v("立即构建")]):t._e(),t._v(" "),t.taskParameterGroups.length>0?s("Dropdown",{staticStyle:{"margin-left":"20px",color:"black","margin-right":"10px"},on:{"on-click":t.showParameterGroupDialog}},[s("Button",{attrs:{shape:"circle"}},[t._v("\n          立即构建\n          "),s("Icon",{attrs:{type:"ios-arrow-down"}})],1),t._v(" "),s("DropdownMenu",{attrs:{slot:"list"},slot:"list"},t._l(t.taskParameterGroups,function(e){return s("DropdownItem",{key:e.id,attrs:{name:e.id}},[t._v(t._s(e.group_name))])}))],1):t._e(),t._v(" "),s("Divider",{attrs:{type:"vertical"}}),t._v(" "),s("ButtonGroup",{attrs:{shape:"circle",size:"default",type:"dashed"}},[s("Button",{attrs:{icon:"ios-color-wand-outline"},on:{click:t.configTask}},[t._v("配置")]),t._v(" "),s("Button",{attrs:{icon:"ios-sunny-outline"},on:{click:t.parameterGroup}},[t._v("参数组")]),t._v(" "),t.taskBasicInfo.Creator===t.userInfo.id?s("Button",{staticStyle:{color:"red"},attrs:{icon:"ios-crop"},on:{click:function(e){t.removeTask(t.taskBasicInfo.TaskName)}}},[t._v("删除")]):t._e()],1)],1)]),t._v(" "),s("ci-task-history-list",{attrs:{taskID:t.taskID},on:{showLogDetail:t.showLogDeail,showTestResult:t.showTestresultDeail}}),t._v(" "),s("div",[s("Drawer",{attrs:{title:"CITask任务配置",width:"80",inner:!0,styles:t.styles,transfer:!1,mask:!0,closable:!0},model:{value:t.showTaskConfig,callback:function(e){t.showTaskConfig=e},expression:"showTaskConfig"}},[s("div",{attrs:{slot:"header"},slot:"header"},[s("span",{staticStyle:{"margin-right":"10px","font-size":"16px","font-weight":"bold"}},[t._v(t._s(t.taskBasicInfo.TaskName)+" 任务配置")])]),t._v(" "),s("ci-task-stage",{attrs:{taskBasicInfo:t.taskBasicInfo,taskID:t.taskID}})],1),t._v(" "),s("Drawer",{attrs:{title:"CITask参数组",width:"80",inner:!0,styles:t.styles,transfer:!1,mask:!0,closable:!0},on:{"on-close":t.groupListDrawerClose},model:{value:t.showParameterGroup,callback:function(e){t.showParameterGroup=e},expression:"showParameterGroup"}},[s("div",{attrs:{slot:"header"},slot:"header"},[s("span",{staticStyle:{"margin-right":"10px","font-size":"16px","font-weight":"bold"}},[t._v(t._s(t.taskBasicInfo.TaskName)+"参数组")])]),t._v(" "),s("c-i-task-parameter-group",{attrs:{parameterGroups:t.taskParameterGroups,taskID:t.taskID},on:{showGroup:t.showGroup}})],1),t._v(" "),s("Drawer",{attrs:{width:"60",inner:!0,styles:t.styles,transfer:!1,mask:!1,closable:!0},model:{value:t.showParameterGroupConfig,callback:function(e){t.showParameterGroupConfig=e},expression:"showParameterGroupConfig"}},[s("div",{attrs:{slot:"header"},slot:"header"},[s("span",{staticStyle:{"margin-right":"10px","font-size":"16px","font-weight":"bold"}},[t._v(t._s(t.selectedGroup.group_name))])]),t._v(" "),s("parameter-group-detail",{attrs:{parameterGroup:t.selectedGroup},on:{saveGroup:t.saveParameterGroup}})],1),t._v(" "),s("Drawer",{attrs:{title:"日志",width:"60",inner:!0,styles:t.styles,transfer:!1,mask:!0,closable:!0},model:{value:t.showBuildLog,callback:function(e){t.showBuildLog=e},expression:"showBuildLog"}},[s("div",{attrs:{slot:"header"},slot:"header"},[s("span",{staticStyle:{"margin-right":"10px","font-size":"16px","font-weight":"bold"}},[t._v("#"+t._s(t.stageHistory.ViewFormat.BuildVersion)+"  "+t._s(t.stageHistory.ViewFormat.StageName))]),t._v(" "),s("ButtonGroup",{attrs:{shape:"circle",size:"small"}},[null!==t.stageHistory.ViewFormat.PreviousStageHisory?s("Button",{attrs:{type:"default"},on:{click:function(e){t.switchStageLog(t.stageHistory.ViewFormat.PreviousStageHisory)}}},[s("Icon",{attrs:{type:"ios-arrow-back"}}),t._v("\n            上一阶段\n          ")],1):t._e(),t._v(" "),null!==t.stageHistory.ViewFormat.NextStageHistory?s("Button",{attrs:{type:"default"},on:{click:function(e){t.switchStageLog(t.stageHistory.ViewFormat.NextStageHistory)}}},[t._v("\n            下一阶段\n            "),s("Icon",{attrs:{type:"ios-arrow-forward"}})],1):t._e()],1)],1),t._v(" "),s("ci-task-stage-log",{attrs:{stageHistoryID:t.stageHistoryID}})],1),t._v(" "),s("Drawer",{attrs:{width:"70",inner:!0,styles:t.styles,transfer:!1,mask:!0,closable:!0},model:{value:t.showTestResult,callback:function(e){t.showTestResult=e},expression:"showTestResult"}},[s("div",{attrs:{slot:"header"},slot:"header"},[s("span",{staticStyle:{"margin-right":"10px","font-size":"16px","font-weight":"bold"}},[t._v("#"+t._s(t.stageHistory.ViewFormat.BuildVersion)+"  "+t._s(t.stageHistory.ViewFormat.StageName)+" "+t._s(t.selectedTestResult.pusposeName))])]),t._v(" "),s("c-i-task-test-result-detail",{attrs:{testResultID:t.selectedTestResult.resultID}})],1)],1),t._v(" "),s("Modal",{attrs:{title:"构建参数","mask-closable":!1},on:{"on-ok":function(e){t.startBuildWithParameter(t.selectedParameterGroup.id)},"on-cancel":t.closeParameterDialog},model:{value:t.showParameterDialog,callback:function(e){t.showParameterDialog=e},expression:"showParameterDialog"}},[s("Form",{ref:"parameterGroupDialog",attrs:{model:t.formItem,"label-width":80}},t._l(t.selectedParameterGroup.parameters,function(t){return s("FormItem",{key:t.key,attrs:{label:t.key,prop:"ResloveResult"}},[s("Input",{attrs:{name:t.key,value:t.value,desc:t.description,placeholder:"任务流名称50个字符以内！"}})],1)}))],1)],1)},staticRenderFns:[]};var B=s("VU/8")(P,H,!1,function(t){s("FQKX")},"data-v-c42ac7a6",null);e.default=B.exports},rCsG:function(t,e){},x9jo:function(t,e){}});
//# sourceMappingURL=15.6a4614177379457adc3a.js.map